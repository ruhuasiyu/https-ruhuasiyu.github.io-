<!doctype html>
<html lang="zh-cn">

<head>
	<meta charset="UTF-8">
</head>

<body>
	<canvas id="canvas" width="512" height="341"></canvas>
	<form>
		<input type="radio" id="original" name="color" value="original" checked="">
		<label for="original">原图</label>

		<input type="radio" id="brighter" name="color" value="brighter">
		<label for="brighter">变亮</label>

		<input type="radio" id="inverted" name="color" value="inverted">
		<label for="inverted">反色</label>
	</form>
	<script>
		var img = new Image();
		img.crossOrigin = "anonymous";
		img.src = "matrix1.jpg";
		var canvas = document.getElementById("canvas");
		var ctx = canvas.getContext('2d');
		img.onload = function () {
			ctx.drawImage(img, 0, 0);
		};
		var original = function () {
			ctx.drawImage(img, 0, 0);
		};

		var brighter = function () {
			ctx.drawImage(img, 0, 0);
			const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
			const data = imageData.data;
			for (var i = 0; i < data.length; i += 4) {
				data[i] = (255 + data[i]) / 2; // red
				data[i + 1] = (255 + data[i + 1]) / 2; // green
				data[i + 2] = (255 + data[i + 2]) / 2; // blue
			}
			ctx.putImageData(imageData, 0, 0);
		};

		var invert = function () {
			ctx.drawImage(img, 0, 0);
			const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
			const data = imageData.data;
			for (var i = 0; i < data.length; i += 4) {
				data[i] = 255 - data[i]; // red
				data[i + 1] = 255 - data[i + 1]; // green
				data[i + 2] = 255 - data[i + 2]; // blue
			}
			ctx.putImageData(imageData, 0, 0);
		};
		const inputs = document.querySelectorAll("[name=color]");
		for (const input of inputs) {
			input.addEventListener("change", function (evt) {
				switch (evt.target.value) {
					case "inverted":
						return invert();
					case "brighter":
						return brighter();
					default:
						return original();
				}
			});
		}

	</script>
</body>

</html>