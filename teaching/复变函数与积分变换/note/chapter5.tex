
\chapter{留数}
\section{孤立奇点}

\subsection{孤立奇点的类型}

我们先根据奇点附近洛朗展开的形式来对其进行分类, 以便于分类计算留数.

\begin{example}
		考虑函数 $f(z)=\dfrac1{\sin(1/z)}$, 显然 $0,z_k=\dfrac1{k\pi}$ 是奇点, $k$ 是非零整数.
	{因为 $\lim\limits_{k\to+\infty} z_k=0$, 所以 $0$ 的任何一个去心邻域内都有奇点.此时无法选取一个圆环域 $0<|z|<\delta$ 作 $f(z)$ 的洛朗展开, 因此我们不考虑这类奇点.
	}
	{
	\begin{center}
		\begin{tikzpicture}[framed]
			\draw[cstcurve,third] (0,0) circle (1.3);
			\fill[cstdot] (0,0) circle;
			\fill[cstdot,second] (2,0) circle;
			\fill[cstdot,main] (1,0) circle;
			\fill[cstdot,second] (0.6667,0) circle;
			\fill[cstdot,main] (0.5,0) circle;
			\fill[cstdot,second] (0.4,0) circle;
			\draw
				(-0.3,0) node {$0$}
				(2,-0.3) node[second] {$z_1$}
				(1,0.3) node[main] {$z_2$}
				(0.6667,-0.3) node[second] {$z_3$}
				(0.5,0.3) node[main] {$z_4$}
				(0.4,-0.3) node[second] {$z_k$};
		\end{tikzpicture}
	\end{center}}
\end{example}

\begin{definition}
	如果 $z_0$ 是 $f(z)$ 的一个奇点, 且 $z_0$ 的某个邻域内没有其它奇点, 则称 $z_0$ 是 $f(z)$ 的一个\emph{孤立奇点}.
\end{definition}

\begin{example}
	\begin{itemize}
		\item $z=0$ 是 $e^{\frac1z},\dfrac{\sin z}z$ 的孤立奇点.
		\item $z=-1$ 是 $\dfrac1{z(z+1)}$ 的孤立奇点.
		\item $z=0$ 不是 $\dfrac1{\sin(1/z)}$ 的孤立奇点.
	\end{itemize}
\end{example}

若 $f(z)$ 只有有限多个奇点, 则这些奇点都是孤立奇点.

如果 $f(z)$ 在孤立奇点 $z_0$ 的去心邻域 $0<|z-z_0|<\delta$ 内解析, 则可以作 $f(z)$ 的洛朗展开.
根据该洛朗级数主要部分的项数, 我们可以将孤立奇点分为三种:
% \begin{center}
% 	\defaultrowcolors
% 	\Newcommand\arraystretch{1.4}
% 	\begin{tabular}{|c|c|c|}\hline
% 		孤立奇点类型&洛朗级数特点&$\lim\limits_{z\to z_0}f(z)$\\\hline
% 		可去奇点&没有主要部分&存在且有限\\\hline
% 		&主要部分只有有限项非零&\\
% 		\multirow{-2}*{$m$ 阶极点}&最低次为 $-m$ 次&\multirow{-2}*{$\infty$}\\\hline
% 		本性奇点&主要部分有无限项非零&不存在且不为 $\infty$\\\hline
% 	\end{tabular}
% \end{center}

\begin{definition}
	若 $f(z)$ 在孤立奇点 $z_0$ 的去心邻域的洛朗级数没有主要部分, 即
	\[f(z)=c_0+c_1(z-z_0)+c_2(z-z_0)^2+\cdots,\quad 0<|z-z_0|<\delta,\]
	是幂级数, 则称 $z_0$ 是 $f(z)$ 的\emph{可去奇点}.
\end{definition}

设 $g(z)$ 为右侧幂级数的和函数, 则 $g(z)$ 在 $|z-z_0|<\delta$ 上解析,
且除 $z_0$ 外 $f(z)=g(z)$.
通过补充或修改定义 $f(z_0)=g(z_0)=c_0$, 可使得 $f(z)$ 也在 $z_0$ 解析.
这就是``可去''的含义.

\begin{theorem}
	\begin{tabular}{rl}
		$z_0$ 是 $f(z)$ 的可去奇点
		&$\iff\lim\limits_{z\to z_0}f(z)$ 存在且有限\\
		&$\iff\lim\limits_{z\to z_0}(z-z_0)f(z)=0$.
	\end{tabular}
\end{theorem}

\begin{example}
		\[f(z)=\frac{\sin z}z=1-\dfrac{z^2}{3!}+\dfrac{z^4}{5!}+\cdots\]
		没有负幂次项, 因此 $0$ 是可去奇点.

	{也可以从 $\lim\limits_{z\to0}zf(z)=\sin 0=0$ 看出.
	}
\end{example}

\begin{example}
		\[f(z)=\frac{e^z-1}z=1+\dfrac z{2!}+\dfrac{z^2}{3!}+\cdots\]
		没有负幂次项, 因此 $0$ 是可去奇点.

	{也可以从 $\lim\limits_{z\to0}zf(z)=e^0-1=0$ 看出.
	}
\end{example}

\begin{definition}
	若 $f(z)$ 在孤立奇点 $z_0$ 的去心邻域的洛朗级数主要部分有无限多项非零, 则称 $z_0$ 是 $f(z)$ 的\emph{本性奇点}.
\end{definition}

\begin{example}
	由于 $\displaystyle e^{\frac1z}=1+\frac1z+\frac1{2z^2}+\cdots$, 因此 $0$ 是本性奇点.
\end{example}

\begin{theorem}
	$z_0$ 是 $f(z)$ 的本性奇点 $\iff\lim\limits_{z\to z_0}f(z)$ 不存在也不是 $\infty$.
\end{theorem}

事实上我们有\emph{皮卡大定理}: 对于本性奇点 $z_0$ 的任何一个去心邻域, $f(z)$ 的像取遍所有复数, 至多有一个取不到.

可去奇点的性质比较简单, 而本性奇点的性质又较为复杂, 因此我们主要关心的是极点的情形.

\begin{definition}
	如果 $f(z)$ 在孤立奇点 $z_0$ 的去心邻域的洛朗级数主要部分只有有限多项非零, 即
	\[f(z)=\frac{c_{-m}}{(z-z_0)^m}+\cdots+c_0+c_1(z-z_0)+\cdots,\ 0<|z-z_0|<\delta,\]
	其中 $c_{-m}\neq 0,m\ge 1$, 则称 $z_0$ 是 $f(z)$ 的 \emph{$m$ 阶极点}或 \emph{$m$ 级极点}.
\end{definition}

令
\[g(z)=c_{-m}+c_{-m+1}(z-z_0)+c_{-m+2}(z-z_0)^2+\cdots,\]
则 $g(z)$ 在 $z_0$ 解析且非零,
且
\[f(z)=\dfrac{g(z)}{(z-z_0)^m},0<|z-z_0|<\delta.\]

\begin{theorem}
	\begin{enumerate}
		\item $z_0$ 是 $f(z)$ 的 $m$ 阶极点 $\iff\lim\limits_{z\to z_0}(z-z_0)^mf(z)$ 存在且非零.
		\item $z_0$ 是 $f(z)$ 的极点 $\iff\lim\limits_{z\to z_0}f(z)=\infty$.
	\end{enumerate}
\end{theorem}

\begin{example}
		$f(z)=\dfrac{3z+2}{z^2(z+2)}$,
	{由于 $\lim\limits_{z\to 0}z^2f(z)=1$, 因此 $0$ 是二阶极点.同理 $-2$ 是一阶极点.
	}
\end{example}

\begin{exercise}
	求 $f(z)=\dfrac1{z^3-z^2-z+1}$ 的奇点, 并指出极点的阶.
\end{exercise}

\begin{answer}
	$-1$ 是一阶极点, $1$ 是二阶极点.
\end{answer}

\subsection{零点与极点}

我们来研究极点与零点的联系, 并给出极点的阶的计算方法.
\begin{definition}
	如果 $f(z)$ 在解析点 $z_0$ 处的泰勒级数最低次项幂次是 $m\ge1$, 即
	\[f(z)=c_m(z-z_0)^m+c_{m+1}(z-z_0)^{m+1}+\cdots,\ 0<|z-z_0|<\delta,\]
	其中 $c_m\neq 0$, 则称 $z_0$ 是 $f(z)$ 的 \emph{$m$ 阶零点}.
\end{definition}

此时 $f(z)=(z-z_0)^mg(z)$, $g(z)$ 在 $z_0$ 解析且 $g(z_0)\neq 0$.

\begin{theorem}
	设 $f(z)$ 在 $z_0$ 解析.
	$z_0$ 是 $m$ 阶零点当且仅当
	\[f(z_0)=f'(z_0)=\cdots=f^{(m-1)}(z_0)=0,\quad
	f^{(m)}(z_0)\neq 0.\]
\end{theorem}

\begin{example}
		$f(z)=z(z-1)^3$
	{有一阶零点 $0$ 和三阶零点 $1$.
	}
\end{example}

\begin{example}
		$f(z)=\sin z-z$.
	{由于
		\[f(z)=\frac{z^3}{3!}-\frac{z^5}{5!}+\cdots\]
		因此 $0$ 是三阶零点.
	}
\end{example}

\begin{theorem}
非零的解析函数的零点总是孤立的.
\end{theorem}

\begin{proof}
	设 $f(z)$ 是区域 $D$ 上的非零解析函数, $z_0\in D$ 是 $f(z)$ 的一个零点.
{%
	由于 $f(z)$ 不恒为零, 因此存在 $m\ge 1$ 使得在 $z_0$ 的一个邻域内 $f(z)=(z-z_0)^m g(z)$, $g(z)$ 在 $z_0$ 处解析且非零.
}

{
	对于 $\varepsilon=\dfrac12|g(z_0)|$, 存在 $\delta>0$ 使得当 $z\in \Uc(z_0,\delta)\subseteq D$ 时, $|g(z)-g(z_0)|<\varepsilon$.
}%
{%
	从而 $g(z)\neq0$, $f(z)\neq 0$.\qedhere
}
\end{proof}

由此可知, 一旦我们知道了解析函数在一串有极限的数列上的值, 这个解析函数本身就被唯一决定了.

为了统一地研究零点和极点, 我们引入下述记号.
设 $z_0$ 是 $f(z)$ 的可去奇点、极点或解析点.
记 $\ord(f,z_0)$ 为 $f(z)$ 在 $z_0$ 的洛朗展开的最低次项幂次.

不难看出,
\begin{enumerate}
	\item 如果 $\ord(f,z_0)\ge0$, 则 $z_0$ 是可去奇点或解析点.
	\item 如果 $\ord(f,z_0)=m>0$, 则 $z_0$ 是可去奇点或 $m$ 阶零点.
	\item 如果 $\ord(f,z_0)=-m<0$, 则 $z_0$ 是 $m$ 阶极点.
\end{enumerate}

\begin{alertblock}{可去奇点和极点判定方法}
	如果 $\ord(f,z_0)=m,\ord(g,z_0)=n$, 那么
	\[\ord\left(\frac fg,z_0\right)=m-n,\quad\ord(fg,z_0)=m+n.\]
\end{alertblock}

\begin{proof}
		设 $f_0(z)$ 为幂级数 $(z-z_0)^{-m}f(z)$ 的和函数, $g_0(z)$ 为幂级数 $(z-z_0)^{-n}g(z)$ 的和函数,
	{则 $f_0(z),g_0(z)$ 在 $z_0$ 解析且非零.
	}%

	{因此 $\dfrac{f_0(z)}{g_0(z)},f_0(z)g_0(z)$ 在 $z_0$ 解析且非零.由
		\[\frac{f(z)}{g(z)}=(z-z_0)^{m-n}\frac{f_0(z)}{g_0(z)},\quad
		f(z)g(z)=(z-z_0)^{m+n}f_0(z)g_0(z)\]
		可知命题成立.\qedhere
	}
\end{proof}

\begin{corollary}
	设 $z_0$ 是 $f(z)$ 的 $m$ 阶零点, 是 $g(z)$ 的 $n$ 阶零点.
	\begin{enumerate}
		\item 若 $m\ge n$, 则 $z_0$ 是 $\dfrac{f(z)}{g(z)}$ 的可去奇点.
		\item 若 $m<n$ 时, 则 $z_0$ 是 $\dfrac{f(z)}{g(z)}$ 的 $n-m$ 阶极点.
	\end{enumerate}
\end{corollary}

\begin{example}
	单选题: (2021年B卷) $z=0$ 是函数 $f(z)=\dfrac{e^z-1}{z^2}$ 的\fillbrace{{A}} 阶极点.
	\xx{$1$}{$2$}{$3$}{$4$}
\end{example}

\begin{solution}
		由于 $e^z-1=z+\dfrac{z^2}{2!}+\cdots$, 所以 $0$ 是 $e^z-1$ 的一阶零点.

	{因此 $\ord(f,0)=1-2=-1$, $0$ 是一阶极点.
	}
\end{solution}

\begin{example}
	$z=0$ 是 $f(z)=\dfrac{(e^z-1)^3z^2}{\sin z^7}$ 的几阶极点?
\end{example}

\begin{solution}
		由于 $(\sin z)'(0)=\cos 0=1$, 所以 $0$ 是 $\sin z$ 的一阶零点.

	{因此 $\ord(f,0)=3+2-7=-2$, $0$ 是二阶极点.
	}
\end{solution}

\begin{exercise}
	求 $f(z)=\dfrac{(z-5)\sin z}{(z-1)^2z^2(z+1)^3}$ 的奇点.
\end{exercise}

\begin{answer}
	$1$ 是二阶极点, $0$ 是一阶极点, $-1$ 是三阶极点.
\end{answer}

\subsection{函数在 \texorpdfstring{$\infty$}{∞} 的性态}

当我们把复平面扩充成闭复平面后, 从几何上看它变成了一个球面.
这样的一个球面是一种封闭的曲面, 它具有某些整体性质.

当我们需要计算一个闭路上函数的积分的时候,
我们需要研究闭路内部每一个奇点处的洛朗展开,
从而得到相应的小闭路上的积分.
如果在这个闭路内部的奇点比较多, 而外部的奇点比较少时, 这样计算就不太方便.
此时如果通过变量替换 $z=\dfrac1t$, 转而研究闭路外部奇点处的洛朗展开,
便可减少所需考虑的奇点个数, 从而降低所需的计算量.
因此我们需要研究函数在 $\infty$ 的性态.

\begin{definition}
	如果函数 $f(z)$ 在 $\infty$ 的去心邻域 $R<|z|<+\infty$ 内没有奇点, 则称 $\infty$ 是 $f(z)$ 的\emph{孤立奇点}.
\end{definition}

设 $g(t)=f\left(\dfrac1t\right)$, 则研究 $f(z)$ 在 $\infty$ 的性质可以转为研究 $g(t)$ 在 $0$ 的性质.
$g(t)$ 在圆环域 $0<|t|<\dfrac1R$ 上解析, $0$ 是它的孤立奇点.

\begin{definition}
	如果 $0$ 是 $g(t)$ 的可去奇点 ($m$ 阶极点、本性奇点), 则称 $\infty$ 是 $f(z)$ 的\emph{可去奇点 ($m$ 阶极点、本性奇点).}
\end{definition}

设 $f(z)$ 在圆环域 $R<|z|<+\infty$ 的洛朗展开为
\[f(z)=\cdots+\frac{c_{-2}}{z^2}+\frac{c_{-1}}{z}+c_0+c_1z+c_2z^2+\cdots\]
则 $g(t)$ 在圆环域 $0<|t|<\dfrac1R$ 的洛朗展开为
\[g(t)=\cdots+\frac{c_2}{t^2}+\frac{c_1}t+c_0+c_{-1}t+c_{-2}t^2+\cdots\]
% \begin{center}
% 	\defaultrowcolors
% 	\Newcommand\arraystretch{1.2}
% 	\begin{tabular}{|c|c|c|}\hline
% 		$\infty$ 类型&洛朗级数特点&$\lim\limits_{z\to\infty}f(z)$\\\hline
% 		可去奇点&没有正幂次部分&存在且有限\\\hline
% 		&正幂次部分只有有限项非零&\\
% 		\multirow{-2}*{$m$ 阶极点}&最高次为 $m$ 次&\multirow{-2}*{$\infty$}\\\hline
% 		本性奇点&正幂次部分有无限项非零&	不存在且不为 $\infty$\\\hline
% 	\end{tabular}
% \end{center}

\begin{example}
		$f(z)=\dfrac z{z+1}$.
	{由 $\lim\limits_{z\to\infty}f(z)=1$ 可知 $\infty$ 是可去奇点.事实上此时 $f(z)$ 在 $1<|z|<+\infty$ 内的洛朗展开为
		\[f(z)=\frac{1}{1+\dfrac1z}=1-\frac1z+\frac1{z^2}-\frac1{z^3}+\cdots\]
	}
\end{example}

\begin{example}
		函数 $f(z)=z^2+\dfrac1z$
	{含有正次幂项且最高次为 $2$, 因此 $\infty$ 是 $2$ 阶极点.
	}
\end{example}

\begin{example}
		设 $p(z)$ 是 $n\ge1$ 次多项式,
	{则 $\infty$ 是 $p(z)$ 的 $n$ 阶极点.
	}
\end{example}

\begin{example}
		函数 
		\[\sin z=z-\frac{z^3}{3!}+\frac{z^5}{5!}-\frac{z^7}{7!}+\cdots\]
	{含有无限多正次幂项, 因此 $\infty$ 是本性奇点.
	}

	{事实上, 如果函数 $f(z)$ 在复平面上处处解析, 且 $f(z)$ 不是多项式, 则 $\infty$ 是它的本性奇点.
	}
\end{example}

\begin{example}
	函数 $f(z)=\dfrac{(z^2-1)(z-2)^3}{(\sin{\pi z})^3}$ 在扩充复平面内有哪些什么类型的奇点, 并指出极点的阶.
\end{example}

\begin{solution}
	\begin{itemize}
		\item 整数 $z=k\neq \pm1,2$ 是 $\sin{\pi z}$ 的一阶零点, 因此是 $f(z)$ 的三阶极点.
		\item $z=\pm1$ 是 $z^2-1$ 的一阶零点, 因此是 $f(z)$ 的二阶极点.
		\item $z=2$ 是 $(z-2)^3$ 的三阶零点, 因此是 $f(z)$ 的可去奇点.
		\item 由于奇点 $1,2,3,\cdots\to \infty$, 因此 $\infty$ 不是孤立奇点.
	\end{itemize}
\end{solution}

\begin{exercise}
	函数 $f(z)=\dfrac{z^2+4\pi^2}{z^3(e^z-1)}$ 在扩充复平面内有哪些什么类型的奇点, 并指出极点的阶.
\end{exercise}

\begin{answer}
	\begin{itemize}
		\item $z=2k\pi i$ 是一阶极点, $k\neq 0,\pm1$.
		\item $z=0$ 是四阶极点.
		\item $z=\pm 2\pi i$ 是可去奇点.
		\item $z=\infty$ 不是孤立奇点.
	\end{itemize}
\end{answer}

\begin{example}
	证明非常数复系数多项式 $p(z)$ 总有复零点.
\end{example}

\begin{proof}
	假设多项式 $p(z)$ 没有复零点, 那么 $f(z)=\dfrac1{p(z)}$ 在复平面上处处解析, 
{%
	从而 $f(z)$ 在 $0$ 处可以展开为幂级数.
}

{%
	由于 $\infty$ 是 $p(z)$ 的极点, $\lim\limits_{z\to\infty}p(z)=\infty$.
}%
{%
	因此 $\lim\limits_{z\to\infty}f(z)=0$, $\infty$ 是 $f(z)$ 的可去奇点.
}%
{%
	这意味着 $f(z)$ 在 $0$ 处的洛朗展开没有正幂次项.
}%
{%
	二者结合可知 $f(z)$ 只能是常数, 矛盾!\qedhere
}
\end{proof}

设 $z_1$ 是 $n$ 次多项式 $p(z)$ 的零点, 则 $\dfrac{p(z)}{z-z_1}$ 是 $n-1$ 次多项式.
归纳可知, $p(z)$ 可以分解为 $p(z)=(z-z_1)\cdots(z-z_n)$.

\section{留数}

\subsection{留数定理}

\begin{definition}
	设 $z_0$ 为 $f(z)$ 的孤立奇点, $f(z)$ 在它的某个去心邻域内的洛朗展开为
		\[f(z)=\cdots+\frac{c_{-1}}{z-z_0}+c_0+c_1(z-z_0)+\cdots.\]
	称
		\[\Res[f(z),z_0]:=c_{-1}=\frac1{2\pi i}\oint_Cf(z)\diff z\]
	为函数 \emph{$f(z)$ 在 $z_0$ 的留数}, 其中 $C$ 为该去心邻域中绕 $z_0$ 的一条闭路.
\end{definition}

可以看出, 知道留数之后可以用来计算积分.

\begin{block}{留数定理}
	若 $f(z)$ 在闭路 $C$ 上解析, 在 $C$ 内部的奇点为 $z_1,z_2,\dots,z_n$, 则
	\[\oint_Cf(z)\diff z=2\pi i\sum_{k=1}^n\Res[f(z),z_k].\]
\end{block}

\begin{proof}
	\begin{center}
		\begin{tikzpicture}[scale=.8]
			\filldraw[cstcurve,rounded corners=0.4cm,main,cstfill2] (-3,-1) rectangle (3,1);
			\draw[cstcurve,main,cstwra] (3,-0.2)--(3,0.1);
			\filldraw[cstcurve,white,draw=second] (-2,0.2) circle (0.5);
			\draw[cstcurve,second,cstwra] (-2,0.7) arc(90:135:0.5);
			\fill[cstdot] (-2,0.2) circle;
			\filldraw[cstcurve,white,draw=second] (0.2,-0.2) circle (0.5);
			\draw[cstcurve,second,cstwra] (0.2,0.3)arc(90:135:0.5);
			\fill[cstdot] (0.2,-0.2) circle;
			\filldraw[cstcurve,white,draw=second] (2,0.2) circle (0.5);
			\draw[cstcurve,second,cstwra] (2,0.7)arc(90:135:0.5);
			\fill[cstdot] (2,0.2) circle;
			\draw
				(3.4,0) node[main] {$C$}
				(-1.3,-0.2) node[second] {$C_1$}
				(0.2,0.5) node[second] {$C_2$}
				(2.4,-0.5) node[second] {$C_3$}
				(-2,-0.1) node {$z_1$}
				(0.2,-0.5) node {$z_2$}
				(2,-0.1) node {$z_3$};
		\end{tikzpicture}
	\end{center}

	{由复闭路定理,
	\[\oint_Cf(z)\diff z=\sum_{k=1}^n\oint_{C_k}f(z)\diff z
	=2\pi i\sum_{k=1}^n\Res[f(z),z_k].\qedhere\]}
\end{proof}

\subsection{留数的计算方法}

若 $z_0$ 为 $f(z)$ 的可去奇点, 则显然 $\Res[f(z),z_0]=0$.

\begin{example}
		$f(z)=\dfrac{z^3(e^z-1)^2}{\sin z^4}$.
	{由于 $\ord(f,0)=3+2-4=1$, $z=0$ 是 $f(z)$ 的可去奇点,因此 \[\Res[f(z),0]=0.\]
	}
\end{example}

若 $z_0$ 为 $f(z)$ 的本性奇点, 一般只能从定义计算.

\begin{example}
	$f(z)=z^4\sin\dfrac1z$.
{%
	由于
	\[f(z)=z^4\sum_{n=0}^\infty(-1)^n\frac{z^{-2n-1}}{(2n+1)!}
	=z^3-\frac z{3!}+\frac1{5!z}+\cdots\]
}
{%
	因此 \[\Res[f(z),0]=\frac1{120}.\]
}
\end{example}

设 $z_0$ 为 $f(z)$ 的极点.

\begin{alertblock}{极点留数计算公式 I}
	如果 $z_0$ 是 $\le m$ 阶极点或可去奇点, 那么
	\[\Res[f(z),z_0]=\frac1{(m-1)!}\lim_{z\to z_0}\frac{\diff^{m-1}}{\diff z^{m-1}}[(z-z_0)^mf(z)].\]
\end{alertblock}

\begin{alertblock}{极点留数计算公式 II}
	如果 $z_0$ 是一阶极点或可去奇点, 那么
	\[\Res[f(z),z_0]=\lim\limits_{z\to z_0}(z-z_0)f(z).\]
\end{alertblock}

\begin{proof}
	设
	\begin{align*}
		f(z)&=c_{-m}(z-z_0)^{-m}+\cdots+c_{-1}(z-z_0)^{-1}+c_0+\cdots,\\
		g(z)&=c_{-m}+\cdots+c_{-1}(z-z_0)^{m-1}+c_0(z-z_0)^m+\cdots,
	\end{align*}
{%
	则 $g(z)=(z-z_0)^mf(z)$.
}%
{%
	由泰勒展开系数与函数导数的关系可知
	\[\Res[f(z),z_0]=c_{-1}=\dfrac1{(m-1)!}g^{(m-1)}(z_0).\qedhere\]
}
\end{proof}

\begin{example}
	求 $\Res\left[\dfrac{e^z}{z^n},0\right]$.
\end{example}

\begin{solution}
		显然 $0$ 是 $n$ 阶极点,
	{\begin{align*}
			\Res\left[\frac{e^z}{z^n},0\right]&=\frac1{(n-1)!}\lim_{z\to0}(e^z)^{(n-1)}\\
			&{=\frac1{(n-1)!}\lim_{z\to0}e^z=\frac1{(n-1)!}.}
		\end{align*}
	}
\end{solution}

\begin{example}
	求 $\Res\left[\dfrac{z-\sin z}{z^6},0\right]$.
\end{example}

\begin{solution}
		因为 $z=0$ 是 $z-\sin z$ 的三阶零点,
	{所以是 $\dfrac{z-\sin z}{z^6}$ 的三阶极点.如果用公式
		\[\Res\left[\frac{z-\sin z}{z^6},0\right]
		=\frac1{2!}\lim_{z\to0}\left(\frac{z-\sin z}{z^3}\right)''\]
		计算会很繁琐.
	}

	{
	\begin{align*}
		\Res\left[\frac{z-\sin z}{z^6},0\right]&=\frac1{5!}\lim_{z\to0}(z-\sin z)^{(5)}\\
		&{=\frac1{5!}\lim_{z\to0}(-\cos z)=-\frac1{120}.}
	\end{align*}}
\end{solution}

\begin{exercise}
		求 $\Res\left[\dfrac{e^z-1}{z^5},0\right]=$\fillblank[2cm][2mm]{{$\dfrac1{24}$}}.
\end{exercise}

\begin{alertblock}{极点留数计算公式 III}
	设 $P(z),Q(z)$ 在 $z_0$ 解析且 $z_0$ 是 $Q$ 的一阶零点, 则
	\[\Res\left[\frac{P(z)}{Q(z)},z_0\right]=\frac{P(z_0)}{Q'(z_0)}.\]
\end{alertblock}

\begin{proof}
		不难看出 $z_0$ 是 $f(z)=\dfrac{P(z)}{Q(z)}$ 的一阶极点或可去奇点.
	{因此
		\begin{align*}
			&\peq\Res[f(z),z_0]=\lim_{z\to z_0}(z-z_0)f(z)\\
			&{=\lim_{z\to z_0}\frac{P(z)}{\dfrac{Q(z)-Q(z_0)}{z-z_0}}}
			{=\frac{P(z_0)}{\lim\limits_{z\to z_0}\dfrac{Q(z)-Q(z_0)}{z-z_0}}=\frac{P(z_0)}{Q'(z_0)}.\qedhere}
		\end{align*}
	}
\end{proof}

\begin{example}
	求 $\Res\left[\dfrac{z}{z^8-1},\dfrac{1+i}{\sqrt2}\right]$.
\end{example}

\begin{solution}
		由于 $z=\dfrac{1+i}{\sqrt2}$ 是分母的 $1$ 阶零点,
	{因此
		\[\Res\left[\frac z{z^8-1},\frac{1+i}{\sqrt2}\right]
		=\frac z{(z^8-1)'}\Big|_{z=\frac{1+i}{\sqrt2}}
		=\frac z{8z^7}\Big|_{z=\frac{1+i}{\sqrt2}}
		=\frac i8.\]
	}
\end{solution}


\begin{example}
	计算积分 $\displaystyle\oint_{|z|=2}\frac{e^z}{z(z-1)^2}\diff z$.
\end{example}

\begin{solution}
		$f(z)=\dfrac{e^z}{z(z-1)^2}$ 在 $|z|<2$ 内有奇点 $z=0,1$.
	{\begin{align*}
		\Res[f(z),0]&=\lim_{z\to0}\frac{e^z}{(z-1)^2}=1,\\
		{\Res[f(z),1]}&{=\lim_{z\to1}\left(\frac{e^z}z\right)'=\lim_{z\to1}\frac{e^z(z-1)}{z^2}=0,}
	\end{align*}\[\oint_{|z|=2}\frac{e^z}{z(z-1)^2}\diff z
		=2\pi i\bigl[\Res[f(z),0]+\Res[f(z),1]\bigr]
		=2\pi i.\]
	}
\end{solution}

\subsection{在 \texorpdfstring{$\infty$}{∞} 的留数*}

\begin{definition}
	设 $\infty$ 为 $f(z)$ 的孤立奇点, $f(z)$ 在某个 $R<|z|<+\infty$ 内的洛朗展开为
	\[f(z)=\cdots+c_{-1}z^{-1}+c_0+c_1z+\cdots\]
	称
	\[\Res[f(z),\infty]:=-c_{-1}=\frac1{2\pi i}\oint_{C^-}f(z)\diff z\]
	为函数 \emph{$f(z)$ 在 $\infty$ 的留数}, 其中 $C$ 为该圆环域中绕 $0$ 的一条闭路.
\end{definition}

由于
\[f\left(\frac1z\right)\frac1{z^2}=\cdots+\frac{c_1}{z^3}+\frac{c_0}{z^2}+\frac{c_{-1}}z+c_{-2}+\cdots\]
因此 
	\[\Res[f(z),\infty]=-\Res\left[f\left(\frac1z\right)\frac1{z^2},0\right].\]

需要注意的是, 和普通复数不同, \emph{即便 $\infty$ 是可去奇点, 也不意味着 $\Res[f(z),\infty]=0$}.

\begin{theorem}
	如果 $f(z)$ 只有有限个奇点, 那么 $f(z)$ 在\emph{扩充复平面内各奇点处的留数之和为 $0$}.
\end{theorem}

\begin{proof}
	设闭路 $C$ 内部包含除 $\infty$ 外所有奇点 $z_1,\dots,z_n$.
	由留数定理
		\[-2\pi i\Res[f(z),\infty]=\oint_C f(z)\diff z=2\pi i\sum_{k=1}^n\Res[f(z),z_k].\]
	故 $\suml_{k=1}^n \Res[f(z),z_k]+\Res[f(z),\infty]=0$.
\end{proof}

\begin{example}
	求 $\displaystyle\oint_{|z|=2}f(z)\diff z$, 其中 $f(z)=\dfrac{\sin(1/z)}{(z+i)^{10}(z-1)(z-3)}$.
\end{example}

\begin{solution}
	$f(z)$ 在 $|z|>2$ 内只有奇点 $3,\infty$.
{
	\[\Res[f(z),3]=\lim_{z\to3}(z-3)f(z)=\frac1{2(3+i)^{10}}\sin\frac13.\]
}
	\begin{align*}
		\Res[f(z),\infty]&=-\Res\left[f\left(\frac1z\right)\frac1{z^2},0\right]\\
		&=-\Res\left[\frac{z^{10}\sin z}{(1+iz)^{10}(1-z)(1-3z)},0\right]=0.
	\end{align*}
{
	\begin{align*}
		\oint_{|z|=2}f(z)\diff z
		&=2\pi i\bigl[\Res[f(z),-i]+\Res[f(z),1]+\Res[f(z),0]\bigr]\\
		&{=-2\pi i\bigl[\Res[f(z),3]+\Res[f(z),\infty]\bigr]=-\frac{\pi i}{(3+i)^{10}}\sin\frac13.}
	\end{align*}
}
\end{solution}

\begin{center}
	\begin{tikzpicture}[node distance=25pt]
		\node at (4.55,0.3) [cstnode2]	(end1){求出 $f(z)$ 的原函数 $F(z)$ 得到 $\displaystyle\int_Cf(z)\diff z=F(b)-F(a)$};
		\node at (0,2.2) [cstnode]	(isanalytic){$f(z)$ 解析};
		\node at (4.5,2.2) [cstnode2,align=center]	(end2){设曲线方程为 $z(t)$, 则\\
		积分$\displaystyle=\int_a^bf(z)z'(t)\diff t$\\
		可能需要分段计算};
		\node at (9,2.2) [cstnode2,align=center]	(end4){用闭路外的孤立\\奇点的留数计算, \\最后取负号*};
		\node at (0,4.5) [cstnode]	(isclosed){是闭路};
		\node at (4.5,4.5) [cstnode]	(issingle){只有孤立奇点};
		\node at (9,4.5) [cstnode,align=center]	(ismany){闭路内部和外部\\孤立奇点数量};
		\node at (1.5,6.5) [cstnode1]  (integral){定积分 $\displaystyle\int_Cf(z)\diff z$ 的计算};
		\node at (9,6.5) [cstnode2,align=center]	(end3){用闭路内的孤立\\奇点的留数计算};

		\draw[cstnarrow,third] (integral.-160) -- (isclosed);
		\draw[cstnarrow,third] (isanalytic) -- node[left]{是} (end1.173);
		\draw[cstnarrow,third] (isclosed) -- node[above]{是} (issingle);
		\draw[cstnarrow,third] (issingle) -- node[above]{是} (ismany);
		\draw[cstnarrow,third] (isclosed) -- node[left]{否} (isanalytic);
		\draw[cstnarrow,third] (issingle) -- node[left]{否} (end2);
		\draw[cstnarrow,third] (isanalytic) -- node[above]{否} (end2);
		\draw[cstnarrow,third] (ismany) -- node[left]{闭路内的少} (end3);
		\draw[cstnarrow,third] (ismany) -- node[left]{闭路外的少} (end4);
	\end{tikzpicture}
\end{center}

在求有理函数的洛朗展开, 以及之后在求有理函数的拉普拉斯逆变换时, 我们需要将一个有理函数表达为分母只有一个零点的有理函数之和.
例如:
\[\frac{z-3}{(z+1)(z-1)^2}=\frac1{z-1}-\frac1{(z-1)^2}-\frac1{z+1}.\]
我们可以用待定系数法计算, 不过有时候使用留数会更为简便.

\begin{solution}
		设 $\displaystyle f(z)=\frac{z-3}{(z+1)(z-1)^2}=\frac a{z-1}+\frac b{(z-1)^2}+\frac c{z+1}$,
	{则
		\begin{align*}
			a&=\Res[f(z),1]=\left(\frac{z-3}{z+1}\right)'\Big|_{z=1}=\frac 4{(z+1)^2}\Big|_{z=1}=1,\\
			b&=\Res[(z-1)f(z),1]=\frac{z-3}{z+1}\Big|_{z=1}=-1,\\
			c&=\Res[f(z),-1]=\frac{z-3}{(z-1)^2}\Big|_{z=-1}=-1.
		\end{align*}故 $\displaystyle f(z)=\frac1{z-1}-\frac1{(z-1)^2}-\frac1{z+1}$.
	}
\end{solution}

\section{留数在定积分的应用*}

\subsection{正弦余弦的有理函数的积分}

本节中我们将对若干种在实变中难以计算的定积分和广义积分使用复变函数和留数的技巧进行计算.
本节内容不作考试要求.

考虑 $\displaystyle\int_0^{2\pi} R(\cos\theta,\sin\theta)\diff\theta$, 其中 $R$ 是一个有理函数.
令 $z=e^{i\theta}$, 则 $\diff z=iz\diff\theta$,
\[\cos\theta=\half\left(z+\frac1z\right)=\frac{z^2+1}{2z},\quad
\sin\theta=\frac1{2i}\left(z-\frac1z\right)=\frac{z^2-1}{2iz},\]
	\[\int_0^{2\pi} R(\cos\theta,\sin\theta)\diff\theta
	=\oint_{|z|=1} R\left(\frac{z^2+1}{2z},\frac{z^2-1}{2iz}\right)\frac1{iz}\diff z.\]
由于被积函数是一个有理函数, 它的积分可以由 $|z|<1$ 内奇点留数得到.

\begin{example}
	求 $\displaystyle\int_0^{2\pi}\frac{\sin^2\theta}{5-3\cos\theta}\diff\theta$.
\end{example}

\begin{solution}
	令 $z=e^{i\theta}$, 则 $\diff z=iz\diff\theta$,
	{
		\[\cos\theta=\half\left(z+\frac1z\right)=\frac{z^2+1}{2z},\qquad
		\sin\theta=\frac1{2i}\left(z-\frac1z\right)=\frac{z^2-1}{2iz},\]

		\begin{align*}
			\int_0^{2\pi}\frac{\sin^2\theta}{5-3\cos\theta}\diff\theta
			&=\oint_{|z|=1}\frac{(z^2-1)^2}{-4z^2}\cdot\frac1{5-3\frac{z^2+1}{2z}}\cdot\frac{\diff z}{iz}\\
			&=-\frac i6\oint_{|z|=1}\frac{(z^2-1)^2}{z^2(z-3)(z-\frac13)}\diff z.
		\end{align*}
	}
	设 $f(z)=\dfrac{(z^2-1)^2}{z^2(z-3)(z-\frac13)}$,
	{则
		\[\Res[f(z),0]=\frac{10}3,\quad\Res[f(z),\frac13]=-\frac83,\]
	}

	{
		\[
			\int_0^{2\pi}\frac{\sin^2\theta}{5-3\cos\theta}\diff\theta
			=-\frac i6\cdot 2\pi i\Bigl[\Res[f(z),0]+\Res[f(z),\frac13]\Bigr]
			=\frac{2\pi}9.
		\]
	}
\end{solution}

\subsection{有理函数的广义积分}

考虑 $\displaystyle\int_{-\infty}^{+\infty}R(x)\diff x$, 其中 $R(x)$ 是一个有理函数, 分母比分子至少高 $2$ 次, 且分母没有实根.
我们先考虑 $\displaystyle\int_{-r}^rR(x)\diff x$.
设 $f(z)=R(z),C=C_r+[-r,r]$ 如下图所示, 使得上半平面内 $f(z)$ 的奇点均在 $C$ 内,
则
\[2\pi i\sum_{\Im a>0}\Res[f(z),a]=\oint_Cf(z)\diff z=\int_{-r}^rR(x)\diff x+\int_{C_r}f(z)\diff z.\]

\begin{center}
	\begin{tikzpicture}[framed]
		\draw[cstaxis] (-2,0)--(2,0);
		\draw[cstaxis] (0,-0.2)--(0,2);
		\draw[cstcurve,main] (-1.5,0) arc(180:0:1.5);
		\draw[cstcurve,main,cstla] (-1.2,0.9) arc(135:130:1.5);
		\draw[cstcurve,second] (-1.5,0)--(1.5,0);
		\draw[cstcurve,second,cstra] (-1.5,0)--(-0.5,0);
		\draw
			(-1.5,-0.3) node[second] {$-r$}
			(1.5,-0.3) node[second] {$r$}
			(1.3,1.2) node[main] {$C_r$};
	\end{tikzpicture}
\end{center}

由于 $P(x)$ 分母次数比分子至少高 $2$ 次,
当 $r\to+\infty$ 时,
\[\abs{\int_{C_r}f(z)\diff z}\le \pi r\max_{|z|=r}|f(z)|
=\pi \max_{|z|=r}|zf(z)|\to 0.\]
故
	\[\int_{-\infty}^{+\infty}R(x)\diff x=2\pi i\sum_{\Im a>0}\Res[R(z),a].\]

\begin{example}
	求 $\displaystyle\int_{-\infty}^{+\infty}\frac{\diff x}{(x^2+a^2)^3},a>0$.
\end{example}

\begin{solution}
	$f(z)=\dfrac1{(z^2+a^2)^3}$ 在上半平面内的奇点为 $ai$.

	{
		\begin{align*}
		\Res[f(z),ai]&=\frac1{2!}\lim_{z\to ai}\left[\frac1{(z+ai)^3}\right]''\\
		&=\half\lim_{z\to ai}\frac{12}{(z+ai)^5}=\frac{3}{16a^5i},
		\end{align*}故
		\[\int_{-\infty}^{+\infty}\frac{\diff x}{(x^2+a^2)^3}
	=2\pi i\Res[f(z),ai]=\frac{3\pi}{8a^5}.\]
	}
\end{solution}

\subsection{有理函数与三角函数之积的广义积分}

考虑 $\displaystyle\int_{-\infty}^{+\infty}R(x)\cos{\lambda x}\diff x$, $\displaystyle\int_{-\infty}^{+\infty}R(x)\sin{\lambda x}\diff x$, 其中 $R(x)$ 是一个有理函数, 分母比分子至少高 $2$ 次, 且分母没有实根.
和前一种情形类似, 我们有
	\[\int_{-\infty}^{+\infty}R(x)e^{i\lambda x}\diff x
	=2\pi i\sum_{\Im a>0}\Res[R(z)e^{i\lambda z},a],\]
因此所求积分分别为它的实部和虚部.


\begin{example}
	求 $\displaystyle\int_{-\infty}^{+\infty}\frac{\cos x\diff x}{(x^2+a^2)^2}, a>0$.
\end{example}

\begin{solution}
	$f(z)=\dfrac{e^{iz}}{(z^2+a^2)^2}$ 在上半平面内的奇点为 $ai$,
	{
		\[\Res[f(z),ai]=\lim_{z\to ai}\left[\frac{e^{iz}}{(z+ai)^2}\right]'=-\frac{e^{-a}(a+1)i}{4a^3}.\]故
		$\displaystyle\qquad \int_{-\infty}^{+\infty}\frac{e^{ix}\diff x}{(x^2+a^2)^2}=2\pi i \Res[f(z),ai]=\frac{\pi e^{-a}(a+1)}{2a^3}$,
		\[\int_{-\infty}^{+\infty}\frac{\cos x\diff x}{(x^2+a^2)^2}=\frac{\pi e^{-a}(a+1)}{2a^3}.\]
	}
\end{solution}

\subsection{其它例子}

最后我们再来看一个例子.

\begin{example}
	求积分 $I=\displaystyle\int_0^{+\infty}\frac{x^p}{x(x+1)}\diff x,0<p<1$.
\end{example}

\begin{solution}
	\[I=\int_0^{+\infty}\frac{x^p}{x(x+1)}\diff x\xto{\text{令}\ x=e^t}\int_{-\infty}^{+\infty}\frac{e^{pt}}{e^t+1}\diff t.\]
	{考虑 $f(z)=\dfrac{e^{pz}}{e^z+1}$ 在如下闭路 $C$ 上的积分.
	\begin{center}
		\begin{tikzpicture}[framed,scale=.8]
			\draw[cstaxis] (-3,0)--(3,0);
			\draw[cstaxis] (0,0)--(0,1.7);
			\draw[cstcurve,second] (-1.5,0) rectangle (1.5,1.2);
			\draw[cstcurve,main] (-1.5,0)--(-1.5,1.2);
			\draw[cstcurve,main] (1.5,0)--(1.5,1.2);
			\draw[cstcurve,second,cstra] (-1.5,0)--(-0.5,0);
			\draw[cstcurve,second,cstra] (0,1.2)--(-0.5,1.2);
			\draw[cstcurve,main,cstra] (1.5,0)--(1.5,0.9);
			\draw[cstcurve,main,cstra] (-1.5,1.2)--(-1.5,0.3);
			\draw
				(1.8,0.3) node {$R$}
				(-2,0.3) node {$-R$}
				(0.4,0.8) node {$2\pi i$}
				(1.2,0.4) node[main] {$C_1$}
				(-1.1,0.5) node[main] {$C_2$}
				(-0.4,0.8) node[second] {$l$};
		\end{tikzpicture}
	\end{center}}

		由于 $l:z=t+2\pi i,-R\le t\le R$,
	{因此
		\[\int_l f(z)\diff z
		=\int_R^{-R}\frac{e^{2p\pi i}\cdot e^{pt}}{e^t+1}\diff t
		=-e^{2p\pi i}\int_{-R}^Rf(t)\diff t.\]由于 $C_1:z=R+it,0\le t\le 2\pi$,因此
		\[\abs{\int_{C_1}f(z)\diff z}\le \frac{e^{(p+1)R}}{e^R-1}\cdot 2\pi\to 0\quad(R\to+\infty).\]同理
		\[\abs{\int_{C_2}f(z)\diff z}\le \frac{e^{-(p+1)R}}{1-e^{-R}}\cdot 2\pi\to 0\quad(R\to+\infty).\]
	}

	由于
	\[\Res[f(z),\pi i]
	=\frac{e^{pz}}{(e^z+1)'}\bigg|_{z=\pi i}=-e^{p\pi i},\]
	{因此
		\begin{align*}
		&\left(\int_{-R}^R+\int_l+\int_{C_1}+\int_{C_2}\right)f(z)\diff z\\
		=&\oint_Cf(z)\diff z=2\pi i\Res[f(z),\pi i]=-2\pi ie^{p\pi i},
		\end{align*}令 $R\to+\infty$,则
		\begin{align*}
		&(1-e^{2p\pi i})I=-2\pi ie^{p\pi i},\quad
		{I=\frac{2\pi i}{e^{p\pi i}-e^{-p\pi i}}=\frac{\pi}{\sin p\pi}.}
		\end{align*}
	}
\end{solution}


