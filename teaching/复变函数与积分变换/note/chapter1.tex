
\chapter{复数与复变函数}
\label{chapter:1}

\begin{introduction}
  复数的产生源于对数学中代数方程求解的需求.
  复数的概念最初由意大利数学家卡尔达诺在求解三次方程时提出.
  复数的引入, 使得数学体系得以扩展, 解决了许多实数范围内无法解决的问题.
  
  复数不仅在数学领域如几何、分析、表示论、动力系统等发挥着重要作用, 还在物理、工程、信息学、电子学等领域有着广泛应用.
  它不仅丰富了数学的内容，也为科学和技术的发展提供了有力的数学工具.

  本章中我们将学习复数、复变函数的基本概念, 以及复数列和复变函数的极限.
  我们将从一元三次方程求解问题出发, 逐步展示引入复数的必要性. 然后介绍复数的运算规则, 并展示复数的三角形式和指数形式在运算中所起的关键作用. 最后, 我们引入复变函数、复数列以及极限的概念, 并将之与实数情形进行对比.
\end{introduction}


\section{复数及其代数运算}

\subsection{复数的产生}

复数起源于多项式方程的求根问题. 
考虑一元二次方程 $x^2+bx+c=0$, 配方可得
  \[\left(x+\frac b2\right)^2=\frac{b^2-4c}4.\]
于是得到求根公式
  \[x=\frac{-b\pm\sqrt\Delta}2,\quad \Delta=b^2-4c.\]
\begin{enumpar}
  \item 当 $\Delta>0$ 时, 有两个不同的实根;
  \item 当 $\Delta=0$ 时, 有一个二重%
    \footnote{%
      如果 $x_0$ 是多项式方程 $f(x)=0$ 的根, 则 $x-x_0$ 是 $f(x)$ 的因式, 即存在多项式 $g(x)$ 使得 $f(x)=(x-x_0)g(x)$.
      如果 $(x-x_0)^k$ 是 $f(x)$ 的因式, 但 $(x-x_0)^{k+1}$ 不是, 则称 $x_0$ 是 \nouns{$k$ 重根}{重根}.
    }%
    的实根;
  \item 当 $\Delta<0$ 时, 无实根.
\end{enumpar}

可以看出, 在一元二次方程中, 我们可以舍去包含\emph{负数开平方}的解. 然而在一元三次方程中, 即便只考虑实数根也会不可避免地引入负数开平方.

\begin{example}
  解方程 $x^3+6x-20=0$.
\end{example}

我们将使用由希皮奥内·德尔·费罗%
  \footnote{%
    Scipione del Ferro (1465--1526), 意大利数学家, 1496年至1526年任博洛尼亚大学 (Universit\`a di Bologna) 代数学和几何学教授. 费罗发现了该方法后, 并没有发表他的结果, 因为当时人们常把他们的发现保密, 而向对手们提出挑战\cite{Kline1990}.
  }%
最先发现, 并由吉罗拉莫·卡尔达诺%
  \footnote{%
    Girolamo Cardano (1501--1576), 意大利数学家、物理学家、天文学家、哲学家, 十六世纪人文主义代表人物, 是古典概率论的创始人\cite{Cardano1643,Cardano1663}.
  }%
最先公开的解法.

\begin{solution}
  设 $x=u+v$, 则
    \[u^3+v^3+3uv(u+v)+6(u+v)-20=0.\]
  我们希望
    \[u^3+v^3=20,\qquad uv=-2,\]
  则 $u^3,v^3$ 满足一元二次方程 $X^2-20X-8=0$.
  解得
    \[u^3=10\pm\sqrt{108}{=(1\pm\sqrt3)^3.}\]
  所以 $u=1\pm\sqrt3, v=1\mp\sqrt 3$, $x=u+v=2$.
\end{solution}

那么这个方程是不是真的只有 $x=2$ 这一个实数解呢?
由其导数 $3x^2+6>0$ 可知其单调递增, 因此确实只有一个实数解.

% \begin{figure}[hbpt]
%   \centering
%   \begin{minipage}{.48\textwidth}
%     \centering
%     \begin{tikzpicture}
%       \filldraw[cstcurve,main,domain=-1.2:3.1,smooth,fill=white] plot ({\x*.5},{(\x*\x*\x+6*\x-20)*.1});
%       \draw[cstaxis] (-3,0)--(3,0);
%       \draw[cstaxis] (0,-3)--(0,3);
%       \coordinate [label=above left:$-20$] (A) at (0,-2);
%       \coordinate [label=above left:$2$] (B) at (1,0);
%       \fill[cstdot,second] (A) circle;
%       \fill[cstdot,second] (B) circle;
%     \end{tikzpicture}
%     \caption{$y=x^3+6x-20$\footnotemark}
%   \end{minipage}
%   \begin{minipage}{.48\textwidth}
%     \centering
%     \begin{tikzpicture}
%       \filldraw[cstcurve,main,domain=-3.6:3.2,smooth,fill=white] plot ({\x*.6},{(\x*\x*\x-7*\x+6)*.15});
%       \draw[cstaxis] (-3,0)--(3,0);
%       \draw[cstaxis] (0,-3)--(0,3);
%       \coordinate [label=below left:$1$] (A) at (.6,0);
%       \coordinate [label=above left:$2$] (B) at (1.2,0);
%       \coordinate [label=above left:$-3$] (C) at (-1.8,0);
%       \fill[cstdot,second] (A) circle;
%       \fill[cstdot,second] (B) circle;
%       \fill[cstdot,second] (C) circle;
%     \end{tikzpicture}
%     \caption{$y=x^3-7x+6$\footnotemark[1]}
%   \end{minipage}
% \end{figure}
% \footnotetext{图像的横纵坐标比例有放缩}

\begin{example}
  解方程 $x^3-7x+6=0$.
\end{example}

\begin{solution}
  同样地我们有 $x=u+v$, 其中
    \[u^3+v^3=-6,\qquad uv=\frac73.\]
  于是 $u^3,v^3$ 满足一元二次方程
    \[X^2+6X+\dfrac{343}{27}=0.\]
  然而这个方程没有实数解.

  我们可以强行解得
    \[u^3=-3+\frac{10}9\sqrt{-3},\]
    \[u=\sqrt[3]{-3+\frac{10}9\sqrt{-3}}
      =\frac{3+2\sqrt{-3}}3,\frac{-9+\sqrt{-3}}6,\frac{3-5\sqrt{-3}}6,\]
  相应地,
    \[v=\frac{3-2\sqrt{-3}}3,\frac{-9-\sqrt{-3}}6,\frac{3+5\sqrt{-3}}6,\]
  从而 $x=u+v=2,-3,1$.
\end{solution}

对于一般的三次方程 $x^3+px+q=0$ 而言, 类似可得:%
  \footnote{%
    一般 $n$ 次多项式的判别式定义为
    \[\prod_{1\le i<j\le n}(x_i-x_j)^2,\]
    其中 $x_1,\dots,x_n$ 表示其所有(复数)根.
    三次多项式的判别式应当是 $-108\Delta$, 这里为了运算方便取作如此形式.
  }
  \[x=u-\frac p{3u},\quad u^3=-\frac q2+\sqrt{\Delta},\quad \Delta=\frac{q^2}4+\frac{p^3}{27}.\]
通过分析函数图像的极值点可以知道:\par
\begin{enumpar}
  \item 当 $\Delta>0$ 时, 有 $1$ 个实根.
  \item 当 $\Delta\le0$ 时, 有 $3$ 个实根(含重根情形).
\end{enumpar}

\begin{figure}[hbpt]
  \centering
  \begin{minipage}{.32\textwidth}
    \centering
    \begin{tikzpicture}
      \draw[cstaxis] (-2,0)--(2,0);
      \draw[cstaxis] (0,-2)--(0,2);
      \draw[cstcurve,main,domain=-2.6:3.3,smooth] plot ({(\x)*0.35},{(\x*\x*\x-3*\x-10)*0.1});
      \fill[cstdot,second] (.92,0) circle;
    \end{tikzpicture}
    \caption{$\Delta>0$}
  \end{minipage}
  \begin{minipage}{.32\textwidth}
    \centering
    \begin{tikzpicture}
      \draw[cstaxis] (-2,0)--(2,0);
      \draw[cstaxis] (0,-2)--(0,2);
      \draw[cstcurve,main,domain=-3.1:2.8,smooth] plot ({(\x)*0.35},{(\x*\x*\x-3*\x+2)*0.1});
      \fill[cstdot,second] (.37,0) circle;
      \fill[cstdot,second] (-.69,0) circle;
    \end{tikzpicture}
    \caption{$\Delta=0$}
  \end{minipage}
  \begin{minipage}{.32\textwidth}
    \centering
    \begin{tikzpicture}
      \draw[cstaxis] (-2,0)--(2,0);
      \draw[cstaxis] (0,-2)--(0,2);
      \draw[cstcurve,main,domain=-4:3.9,smooth] plot ({(\x)*0.3},{(\x*\x*\x-7*\x+1)*0.05});
      \fill[cstdot,second] (.76,0) circle;
      \fill[cstdot,second] (.05,0) circle;
      \fill[cstdot,second] (-.78,0) circle;
    \end{tikzpicture}
    \caption{$\Delta<0$}
  \end{minipage}
\end{figure}

所以我们想要使用一元三次方程求根公式的话, 就\emph{必须接受负数开方}.
那么为什么当 $\Delta<0$ 时, 从求根公式一定能得到 $3$ 个实根呢?
在学习了本章内容之后就可以回答这个问题了.

尽管在十六世纪, 人们已经得到了三次方程的求根公式, 然而对其中出现的虚数, 却是难以接受.
戈特弗里德·威廉·莱布尼茨%
  \footnote{%
    Gottfried Wilhelm Leibniz (1646-1716), 德国哲学家、数学家, 微积分的发现者之一. 他所发明的微积分系列记号也是现今使用最为广泛的记号.
  }%
对此有如下评论: \emph{圣灵在分析的奇观中找到了超凡的显示, 这就是那个理想世界的端兆, 那个介于存在与不存在之间的两栖物, 那个我们称之为虚的 $-1$ 的平方根.}



\subsection{复数的概念}

现在我们来正式介绍复数的概念.
由于方程 $x^2=-1$ 在复数范围内有两个不同的根, 为了避免记号 $\sqrt{-1}$ 带来的歧义, 我们引入抽象符号 $i$ 来表示其中一个根.

\begin{definition}
  固定一个记号 $i$, \noun{复数}就是形如 $z=x+yi$ 的元素, 其中 $x,y$ 均是实数, 且不同的 $(x,y)$ 对应不同的复数.

  分别称 $x,y$ 为 $z$ 的\noun{实部} 和\noun{虚部}, 并记作 \nouns{$\Re z$}{Re z@$\Re z$}${}=x$, \nouns{$\Im z$}{Im z@$\Im z$}${}=y$.
\end{definition}

本书中, 我们将不言自明地使用 $x,y,x_1,y_1,\dots$ 等记号表示实数.
复数 $x+yi$ 也可表达为形式 $x+iy$.

记号 $i$ 被称为\noun{虚数单位}, 它最先是由莱昂哈德·欧拉%
  \footnote{%
    Leonhard Euler (1707--1783), 瑞士数学家、自然科学家, 18世纪数学界最杰出的人物之一. 他是数学史上最多产的数学家, 研究涉及数学各个分支.
  }%
引入并使用.
将\emph{全体复数记作 $\BC$}, 全体实数记作 $\BR$\footnote{%
  全体复数、实数、有理数、整数、自然数构成的集合分别记作 $\BC,\BR,\BQ,\BZ,\BN$, 整数集合记号来自其德语 Zahlen, 其余来自它们的英文名称 complex number, real number, rational number, natural number.
  这些符号的叫做空心体, 手写时, 可在普通字母格式上添加一条竖线(对于 $\BZ$ 是斜线)来区分.
  有些文献使用黑粗体字母 $\mathbf{C,R,Q,Z,N}$ 来表示这些集合.
}.
由于实数 $x$ 可以自然地看成复数 $x+0i$, 在此观点下, 我们有 $\BR\subseteq \BC$.
我们简记 $x+0i=x,0+yi=yi$.

由定义可知, 每一个复数都可以唯一地表达成 $x+yi$ 这样的形式.
于是复数全体和平面上的点可以建立一一对应.
将建立起这种对应的平面称为\noun{复平面}, 将复平面的 $x$ 和 $y$ 轴分别称为\noun{实轴}和\noun{虚轴}.
当 $\Im z=0$ 时, $z=x$ 是实数, 它落在实轴上.
称不是实数的复数是\noun{虚数}.
当 $\Re z=0$ 且 $z\neq 0$ 时, 称 $z=yi\neq 0$ 是\noun{纯虚数}.


\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \begin{scope}
      \draw[cstaxis] (-.5,0)--(3,0);
      \draw[cstaxis] (0,-.5)--(0,2.5);
      \coordinate [label=below left:$0$] (O) at (0,0);
      \coordinate [label=above:{$z=x+yi$}] (A) at (2,1.5);
      \coordinate (B) at (2,0);
      \coordinate (C) at (0,1.5);
      \draw[cstdash] (B)--(A)--(C);
      \fill[cstdot,main] (A) circle;
      \draw[Latex-Latex,line width=.5mm] (2.8,1)--(4,1) node[midway,below,emph] {一一对应};
    \end{scope}
    \begin{scope}[xshift=5cm]
      \coordinate [label=below left:$O$] (O) at (0,0);
      \coordinate [label=above:{$Z(x,y)$}] (A) at (2,1.5);
      \coordinate (B) at (2,0);
      \coordinate (C) at (0,1.5);
      \draw[cstdash] (B)--(A)--(C);
      \fill[cstdot,main] (A) circle;
      \draw[decorate,decoration={brace,amplitude=5},cstfill] (O)--(B) node[midway,above=2mm] {$x$};
      \draw[decorate,decoration={brace,amplitude=5},cstfill] (C)--(O) node[midway,right=2mm] {$y$};
      \draw[Latex-Latex,line width=.5mm] (2.8,1)--(4,1) node[midway,below,emph] {一一对应};
      \draw[cstaxis] (-.5,0)--(3,0);
      \draw[cstaxis] (0,-.5)--(0,2.5);
    \end{scope}
    \begin{scope}[xshift=10cm]
      \draw[cstaxis] (-.5,0)--(3,0);
      \draw[cstaxis] (0,-.5)--(0,2.5);
      \coordinate [label=below left:$O$] (O) at (0,0);
      \coordinate [label=above:{$\overrightarrow{OZ}=(x,y)$}] (A) at (2,1.5);
      \draw[cstcurve,cstra,second] (O)--(A);
    \end{scope}
  \end{tikzpicture}
  \caption{复数、平面上的点、平面向量一一对应}
\end{figure}

\begin{figure}[hbpt]
  \centering
  \begin{minipage}{.48\textwidth}
    \centering
    \begin{tikzpicture}
      \coordinate [label=above:{实轴}] (R) at (3,0);
      \coordinate [label=right:{虚轴}] (I) at (0,2.5);
      \coordinate [label=below left:$0$] (O) at (0,0);
      \coordinate [label=above:{$z=x+yi$}] (A) at (2,1.5);
      \coordinate (B) at (2,0);
      \coordinate (C) at (0,1.5);
      \draw[cstdash] (B)--(A)--(C);
      \fill[cstdot] (A) circle;
      \draw[decorate,decoration={brace,amplitude=5},cstfill] (B)--(O) node[midway,below=1.5mm] {$\Re z$};
      \draw[decorate,decoration={brace,amplitude=5},cstfill] (C)--(O) node[midway,right=1.5mm] {$\Im z$};
      \draw[cstaxis] (-.5,0)--(R);
      \draw[cstaxis] (0,-.5)--(I);
      \draw[->,thick] (-2,.2)-|(.6,0);
      \draw[->,thick] (-2,1.3)--(0,1.3);
      \draw 
        (-2,.1) node[cstnode,emph] {实数}
        (-2,1.2) node[align=center,cstnode] {\textcolor{main}{\bfseries 纯虚数}\\不含原点};
    \end{tikzpicture}
  \end{minipage}
  \begin{minipage}{.48\textwidth}
    \centering
    \begin{tikzpicture}
      \filldraw[cstcurve,cstfill] (.8,0) circle (2.6 and 2);
      \coordinate (R) at (0,-.8);
      \filldraw[cstcurve,fill=white] (R) circle (1.2 and .7);
      \coordinate (I) at (0,.8);
      \draw (R) node[align=center] {\textcolor{main}{\bfseries 实数} \\$0,1,\sqrt2,\pi,e$};
      \draw (I) node[align=center] {\textcolor{main}{\bfseries 纯虚数} \\$i,-i,\pi i$};
      \draw[cstcurve] (I) circle (1.2 and .7);
      \draw 
        (3.7,0) node[align=center] {全\\体\\复\\数}
        (2,0) node[align=center] {虚数 \\$i,\pi i,\frac{-1+\sqrt 3 i}2$};
    \end{tikzpicture}
  \end{minipage}
  \caption{实数、纯虚数、复数和复平面的关系}
\end{figure}

\begin{example}
  实数 $x$ 取何值时, $z=(x^2-3x-4)+(x^2-5x-6)i$ 是:\par
  \begin{enuminline}[(i)]
    \item 实数;
    \item 纯虚数.
  \end{enuminline}
\end{example}
\begin{solution}
  \begin{enumnopar}[(i)]
    \item $\Im z=x^2-5x-6=0$, 即 $x=-1$ 或 $6$.
    \item $\Re z=x^2-3x-4=0$, 即 $x=-1$ 或 $4$.
      但同时要求 $\Im z=x^2-5x-6\neq 0$, 因此 $x\neq -1$.
      故 $x=4$.
  \end{enumnopar}
\end{solution}

\begin{exercise}
  若 $x^2(1+i)+x(5+4i)+4+3i$ 是纯虚数, 则实数 $x=$\fillblank{}.
\end{exercise}


\subsection{复数的代数运算}


\subsubsection{四则运算}
设 $z_1=x_1+y_1i,z_2=x_2+y_2i$.
由向量的加减法可自然定义出复数的加法和减法:
  \begin{align*}
    z_1+z_2&=(x_1+x_2)+(y_1+y_2)i,\\
    z_1-z_2&=(x_1-x_2)+(y_1-y_2)i.
  \end{align*}
显然, 复数的加法满足交换律和结合律.

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \draw[cstaxis] (-3,0)--(4,0);
    \draw[cstaxis] (0,-1)--(0,3);
    \coordinate (O) at (0,0);
    \coordinate [label=above:{$z_1$}] (Z1) at (1,2);
    \coordinate [label=left:{$z_2$}] (Z2) at (-2.5,.5);
    \coordinate [label=above left:{$z_1+z_2$}] (P) at ($(Z1)+(Z2)$);
    \coordinate [label=right:{$z_1-z_2$}] (M) at ($(Z1)-(Z2)$);
    \coordinate [label=below:{$-z_2$}] (neg) at ($(O)-(Z2)$);
    \draw[cstcurve,cstra] (O)--(Z1);
    \draw[cstcurve,cstra] (O)--(Z2);
    \draw[cstcurve,cstra,second] (O)--(P);
    \draw[cstcurve,cstra,main] (O)--(M);
    \draw[cstdash,cstra] (O)--(neg);
    \draw[cstdash] (Z2)--(P)--(M)--(neg);
  \end{tikzpicture}
  \caption{复数的加法和减法}
\end{figure}

\emph{规定 $i\cdot i=-1$}.
我们希望 $\BC$ 上的运算满足乘法分配律, 那么复数的乘法应当定义为
  \begin{align*}
    z_1\cdot z_2&=(x_1+y_1i)(x_2+y_2i)\\
    &=x_1\cdot x_2+x_1\cdot y_2i+y_1i\cdot x_2+y_1i\cdot y_2i\\
    &=(x_1x_2-y_1y_2)+(x_1y_2+x_2y_1)i.
  \end{align*}
容易证明, 复数的乘法满足交换律、结合律和分配律.

当 $z\neq0$ 时, 可以发现
  \[(x+yi)\cdot\frac{x-yi}{x^2+y^2}=1.\]
从而除法定义为
  \[\frac{z_1}{z_2}=(x_1+y_1i)\cdot\frac{x_2-y_2i}{x_2^2+y_2^2}=\frac{x_1x_2+y_1y_2}{x_2^2+y_2^2}+\frac{x_2y_1-x_1y_2}{x_2^2+y_2^2}i.\]

对于正整数 $n$, 定义 $z$ 的 \nouns{$n$ 次幂}{乘幂}为 $n$ 个 $z$ 相乘.
当 $z\neq 0$ 时, 还可以定义
\[z^0=1,\qquad z^{-n}=\frac1{z^n}.\]

\subsubsection{单位根}
\begin{example}
  \begin{enumnopar}[(i)]
    \item 容易知道 $i^2=-1,i^3=-i,i^4=1$.
    一般地, 对于整数 $n$, 
    \[i^{4n}=1,\quad i^{4n+1}=i,\quad i^{4n+2}=-1,\quad i^{4n+3}=-i.\]
    \item 令 $\omega=\frac12(-1+\sqrt 3i)$, 则
    \[\omega^2=\frac12(-1-\sqrt3i),\qquad\omega^3=1.\]
    \item 令 $z=1+i$, {则
    \[z^2=2i,\quad z^3=-2+2i,\quad z^4=-4,\quad z^8=16=2^4.\]}
  \end{enumnopar}

  对于正整数 $n$, 将满足 $z^n=1$ 的复数 $z$ 称为 \nouns{$n$ 次单位根}{单位根}.
  那么 $1,i,-1,-i$ 是 $4$ 次单位根, $1,\omega,\omega^2$ 是 $3$ 次单位根, $(1+i)/\sqrt2$ 是 $8$ 次单位根.
\end{example}

实数范围内的诸多代数恒等式在复数情形也是成立, 例如
\[1+q+q^2+\cdots+q^n=\begin{cases}
  \dfrac{1-q^{n+1}}{1-q},&\text{若}\ q\neq 1;\\
  n+1,&\text{若}\ q=1.
\end{cases}\]

\begin{example}
  化简 $1+i+i^2+i^3+i^4$.
\end{example}
\begin{solution}
  根据等比数列求和公式,
  \[1+i+i^2+i^3+i^4=\frac{i^5-1}{i-1}
  {=\frac{i-1}{i-1}=1.}\]
\end{solution}

\begin{exercise}
  化简 $\left(\dfrac{1-i}{1+i}\right)^{2020}$=\fillblank{}.
\end{exercise}

\subsubsection{复数域的性质\optional}

若集合 $F$ 带有元素 $0,1$ 以及四则运算\footnote{%
  即有运算 $+$ 和 $\times$, 且对任意 $a\in S$, 存在 $b\in S$ 使得 $a+b=b+a=0$; 对任意非零 $a\in F$, 存在 $c\in F$ 使得 $a\times c=c\times a=1$.%
}, 且
\begin{itemize}
  \item 满足加法交换、结合律, 乘法交换、结合、分配律\footnote{即对任意 $a,b,c\in F$, 有 $a+b=b+a$, $a+(b+c)=(a+b)+c$, $ab=ba$, $a(bc)=(ab)c$, $a(b+c)=ab+ac$.};
  \item 对任意 $a\in F$, $a+0=a\times 1=a$,
\end{itemize}
则称 $F$ 构成一个\noun{域}.
有理数全体 $\BQ$, 实数全体 $\BR$, 复数全体 $\BC$ 均构成域.

与有理数域和实数域有着本质不同的是, 复数域是\nouns{代数闭域}{域!代数闭域}:
对于任意 $n\ge 1$ 个复数 $c_0,c_1,\dots,c_{n-1}$, 复系数多项式
  \[p(z)=z^n+c_{n-1}z^{n-1}+\cdots+c_1z+c_0,\]
总存在复数 $z_0$ 使得 $p(z_0)=0$.
由此归纳可知, 复系数多项式可以因式分解成一次多项式的乘积.
我们会在第五章证明该结论.

在 $\BQ,\BR$ 上可以定义出一个``好的''大小关系, 换言之它们是\nouns{有序域}{域!有序域}, 即存在一个满足下述性质的 $>$:
\begin{itemize}
  \item 若 $a\neq b$, 则要么 $a>b$, 要么 $b>a$;
  \item 若 $a>b$, 则对于任意 $c$, $a+c>b+c$;
  \item 若 $a>b,c>0$, 则 $ac>bc$.
\end{itemize}
而 \emph{$\BC$ 却不是有序域}.
这是因为: 如果 $i>0$, 则
  \[-1=i\cdot i>0,\quad -i=-1\cdot i>0.\]
于是 $0>i$, 矛盾! 同理 $i<0$ 也不可能.


\subsection{共轭复数}

\begin{definition}
  称 $z$ 在复平面关于实轴的对称点为它的\nouns{共轭复数 $\ov z$}{共轭复数}\index{zbar@$\ov z$}.
换言之, $\ov{x+yi}=x-yi$.
\end{definition}

\begin{exercise}
  $z$ 关于虚轴的对称点是\fillblank{}.
\end{exercise}

从定义出发, 不难验证共轭复数满足如下性质:
\begin{enumpar}
  \item $z$ 是 $\ov z$ 的共轭复数, 即 $\ov{\ov z}=z$.
  \label{enum:conjugate-zbarbar}
  \item $\ov{z_1\pm z_2}=\ov{z_1}\pm\ov{z_2},\ 
  \ov{z_1\cdot z_2}=\ov{z_1}\cdot\ov{z_2},\ 
  \ov{\Bigl(\dfrac{z_1}{z_2}\Bigr)}=\dfrac{~\ov{z_1}~}{~\ov{z_2}~}$.
  \label{enum:conjugate-commutes}
  \item $z\ov{z}=(\Re z)^2+(\Im z)^2$.
  \item $z+\ov z=2\Re z,\ z-\ov z=2i\Im z$.
  \label{enum:conjugate-xy-zzbar}
  \item $z=\ov z$ 当且仅当 $z$ 是实数; $z=-\ov z$ 当且仅当 $z$ 是纯虚数或 $z=0$.
  \label{enum:conjugate-real-imag}
\end{enumpar}\par\noindent
\ref{enum:conjugate-commutes}表明共轭运算和四则运算交换.
\ref{enum:conjugate-xy-zzbar}表明了复数 $z$ 的实部 $x$ 和虚部 $y$ 可以用 $z,\ov z$ 表出.
这意味着使用共轭复数进行计算和证明，往往比直接使用 $x,y$ 表达的形式更简单.

\begin{example}
  证明 $z_1\cdot\ov{z_2}+\ov{z_1}\cdot z_2=2\Re{(z_1\cdot\ov{z_2})}$.
\end{example}

我们可以设 $z_1=x_1+y_1i,z_2=x_2+y_2i$, 然后代入等式两边化简并比较实部和虚部来证明.
但利用共轭复数可以更简单地证明它.

\begin{proof}
  根据共轭复数的性质\ref{enum:conjugate-zbarbar}和\ref{enum:conjugate-commutes},
  \[\ov{z_1\cdot\ov{z_2}}=\ov{z_1}\cdot\ov{\ov{z_2}}=\ov{z_1}\cdot z_2.\]
  于是由共轭复数的性质\ref{enum:conjugate-xy-zzbar}可得
    \[z_1\cdot\ov{z_2}+\ov{z_1}\cdot z_2
      =z_1\cdot\ov{z_2}+\ov{z_1\cdot\ov{z_2}}
      =2\Re{(z_1\cdot\ov{z_2})}.\]
\end{proof}

\begin{example}
  设 $z=x+yi$ 且 $y\neq 0,\pm1$. 证明: $x^2+y^2=1$ 当且仅当 $\dfrac z{1+z^2}$ 是实数.
\end{example}
\begin{proof}
  由于 $y\neq\pm1$, 因此 $z\neq \pm i, 1+z^2\neq 0$.
  由共轭复数的性质\ref{enum:conjugate-real-imag}可知, 
  $\dfrac z{1+z^2}$ 是实数当且仅当
    \[\frac z{1+z^2}=\ov{\left(\frac z{1+z^2}\right)}=\frac{\ov z}{1+{\ov z}^2},\]
  即 $z(1+{\ov z}^2)=\ov z(1+z^2)$.
  化简可知其等价于
    \[(z-\ov z)(z\ov z-1)=0.\]
  由 $y\neq0$ 可知 $z\neq \ov z$.
  故上述等式等价于 $z\ov z=1$, 即 $x^2+y^2=1$.
\end{proof}

\begin{exercise}
  将 $(x_1^2+y_1^2)(x_2^2+y_2^2)$ 表达为两个多项式的平方和.
\end{exercise}

由于 $z\ov z$ 是一个实数,
因此在做复数的除法运算时, 可以利用下式将其转化为乘法:
  \[\dfrac{z_1}{z_2}=\dfrac{z_1\ov{z_2}}{z_2\ov{z_2}}=\dfrac{z_1\ov{z_2}}{x_2^2+y_2^2}.\]
\begin{example}
  设 $z_1=10-5i,z_2=4+3i$, 求 $\ov{\left(\dfrac{z_1}{z_2}\right)}$.
\end{example}
\begin{solution}
  \begin{align*}
    \frac{z_1}{z_2}&=\frac{10-5i}{4+3i}
    =\frac{(10-5i)(4-3i)}{4^2+3^2}\\
    &=\frac{(40-15)+(-20-30)i}{25}=1-2i,
  \end{align*}
  因此 $\ov{\left(\dfrac{z_1}{z_2}\right)}=1+2i$.
\end{solution}

\begin{exercise}
  计算 $\dfrac{2-3i}{2-i}=$\fillblank[6em]{}.
\end{exercise}

\section{复数的三角与指数形式}

\subsection{复数的模和辐角}

由平面的极坐标表示, 我们可以得到复数的另一种表示方式.
以 $0$ 为极点, 正实轴为极轴, 逆时针为极角方向可以自然定义出复平面上的极坐标系.
设复数 $z=x+yi$ 对应点的极坐标为 $(r,\theta)$.
由极坐标和直角坐标的转化关系可知:
\[x=r\cos\theta,\qquad y=r\sin\theta,\]
\[r=\sqrt{x^2+y^2},\qquad \theta=\arctan\dfrac yx+k\pi,k\in\BZ.\]

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \coordinate [label=below left:$0$] (O) at (0,0);
    \coordinate [label=above:{$z=x+yi$}] (Z) at (3,2);
    \coordinate (X) at (3,0);
    \coordinate (Y) at (0,2);
    \draw[decorate,decoration={brace,amplitude=5},cstfill] (X)--(O) node[midway,below=2mm] {$x$};
    \draw[decorate,decoration={brace,amplitude=5},cstfill] (O)--(Y) node[midway,left=2mm] {$y$};
    \draw[main,thick,cstra] pic [cstfill1,draw=main, "$\theta$", angle eccentricity=1.3, angle radius=0.8cm] {angle=X--O--Z};
    \draw[cstaxis] (-.5,0)--(4,0);
    \draw[cstaxis] (0,-.5)--(0,3);
    \draw[cstcurve,main,cstra] (O)--(Z) node[midway,above,main] {$r$};
    \draw[cstdash] (X)--(Z)--(Y);
    \fill[cstdot,second] (Z) circle;
  \end{tikzpicture}
  \caption{复数的模和辐角}
\end{figure}

\begin{definition}
  \begin{itemize}
    \item 称 $r$ 为 $z$ 的\noun{模}, 记为 \nouns{$|z|$}{z@$|z|$}${}=r=\sqrt{x^2+y^2}$.
    \item 称 $\theta$ 为 $z$ 的\noun{辐角}, 记为 \nouns{$\Arg z$}{Arg z@$\Arg z$}${}=\theta$.
    约定 \alert{$0$ 的辐角没有意义}.
  \end{itemize}
\end{definition}

任意非零复数 $z$ 的辐角有无穷多个.
这是因为若 $\theta$ 是 $z$ 的辐角, 则 $\theta+2k\pi$ 也是 $z$ 的辐角, 其中 $k$ 是任意整数.
我们固定选择 $\Arg z$ 中位于 $(-\pi,\pi]$ 的那个, 并称之为\nouns{辐角主值}{辐角!辐角主值}%
  \footnote{%
    部分文献选择位于 $[0,2\pi)$ 的辐角作为辐角主值. 由于这会导致后续对数函数主值在正实轴上不解析, 因此本书选择位于 $(-\pi,\pi]$ 的辐角作为辐角主值.
  }%
, 记作 \nouns{$\arg z$}{arg z@$\arg z$}.
那么 $\Arg z=\arg z+2k\pi, k\in\BZ$.
根据 $z$ 所处的位置, 我们有
\begin{equation}\label{eq:arg}
  \arg z=\begin{cases}
    \arctan\dfrac yx,&x>0;\\
    \arctan\dfrac yx+\pi,&x<0,y\ge0;\\
    \arctan\dfrac yx-\pi,&x<0,y<0;\\
    \dfrac\pi2,&x=0,y>0;\\
    -\dfrac\pi2,&x=0,y<0.
  \end{cases}
\end{equation}

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \draw[cstaxis](-2.5,0)->(2.5,0); 
    \draw[cstaxis](0,-2)->(0,2);
    \draw[cstaxis,main,cstwla] (-1.5,0) arc(180:-180:1.5);
    \filldraw[cstdote,draw=main] (-1.5,-.07) circle;
    \coordinate [label=above:\textcolor{main}{$0$}] (A) at (1.7,0);
    \fill[cstdot,main] (A) circle;
    \coordinate [label=above right:{$\arctan\dfrac yx$}] (B) at (.9,.9);
    \fill[cstdot,main] (B) circle;
    \coordinate [label=right:{$\arctan\dfrac yx$}] (C) at (1.4,-.9);
    \fill[cstdot,main] (C) circle;
    \coordinate [label=above left:{$\arctan\dfrac yx+\pi$}] (D) at (-1.1,.8);
    \fill[cstdot,second] (D) circle;
    \coordinate [label=below:{$\pi$}] (E) at (-.9,0);
    \fill[cstdot,second] (E) circle;
    \coordinate [label=left:{$\arctan\dfrac yx-\pi$}] (F) at (-1.6,-.7);
    \fill[cstdot,main] (F) circle;
    \coordinate [label=left:{$\dfrac\pi2$}] (G) at (0,.5);
    \fill[cstdot,main] (G) circle;
    \coordinate [label=right:{$-\dfrac\pi2$}] (H) at (0,-.6);
    \fill[cstdot,main] (H) circle;
  \end{tikzpicture}
  \caption{辐角主值与复数位置的关系}
\end{figure}

\begin{exercise}
  $\arg \ov z=-\arg z$ 是否对于非零复数都成立?  
\end{exercise}

复数的模满足如下性质:
\begin{enumpar}
  \item $z\ov z=|z|^2=|\ov z|^2$;
  \label{enum:modulus-zzbar}
  \item $\abs{\Re z},\abs{\Im z}\le |z|\le\abs{\Re z}+\abs{\Im z}$;
  \label{enum:re-im-less}
  \item $\big||z_1|-|z_2|\big|\le|z_1\pm z_2|\le|z_1|+|z_2|$;
  \label{enum:modulus-triangle-inequality}
  \item $|z_1+z_2+\cdots+z_n|\le|z_1|+|z_2|+\cdots+|z_n|$.
  \label{enum:modulus-nangle-inequality}
\end{enumpar}
这些性质可通过\figref{fig:inequality_of_modulus}使用几何方式证明, 也可利用代数方法直接证明.

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \draw[cstaxis] (-4.4,0)--(4.3,0);
    \draw[cstaxis] (0,-3)--(0,3);
    \coordinate (O) at (0,0);
    \coordinate (Z) at (-2.5,1.5);
    \coordinate (R) at (-2.5,0);
    \draw[decorate,decoration={brace,amplitude=5},cstfill] (O)--(R) node[midway,below=2mm] {$\abs{\Re z}$};
    \draw[decorate,decoration={brace,amplitude=5},cstfill] (R)--(Z) node[midway,left=2mm] {$\abs{\Im z}$};
    \draw[cstcurve,second] (O)--(Z) node[midway,above,third] {$|z|$};
    \draw[cstcurve,main] (Z)--(R)--(O);
    \draw[thick] (R) ++(0,.3)--++(.3,0)--++(0,-.3);

    \coordinate [label=below right:{$z_1$}] (Z1) at (2.8,-.4);
    \coordinate (Z2) at (1.2,2);
    \coordinate (A) at (2.7,2.4);
    \coordinate [label=above right:{$z_1+z_2$}] (P) at ($(Z1)+(Z2)$);
    \coordinate [label=below:{$z_1-z_2$}] (M) at ($(Z1)-(Z2)$);
    \draw[decorate,decoration={brace,amplitude=5}] (Z1)--(O) node[midway,below,sloped] {$|z_1|$};
    \draw[decorate,decoration={brace,amplitude=5}] (P)--(Z1) node[midway,below,sloped] {$|z_2|$};
    \draw[decorate,decoration={brace,amplitude=5}] (O)--(P) node[midway,above,sloped] {$|z_1+z_2|$};
    \draw[decorate,decoration={brace,amplitude=5}] (Z1)--(M) node[midway,below,sloped] {$|z_2|$};
    \draw[decorate,decoration={brace,amplitude=5}] (M)--(O) node[midway,below,sloped] {$|z_1-z_2|$};
    \draw[decorate,decoration={brace,amplitude=5}] (A)--(P) node[midway,above,sloped] {$|z_3|$};
    \draw[decorate,decoration={brace,amplitude=5}] (O)--(A) node[midway,above=2mm,sloped] {$|z_1+z_2+z_3|$};
    \begin{scope}[cstcurve,cstra]
      \draw (O)--(Z1);
      \draw (Z1)--(P);
      \draw (P)--(A);
      \draw[main] (O)--(A);
      \draw[main] (O)--(P);
      \draw[main] (O)--(M);
      \draw (Z1)--(M);
    \end{scope}
  \end{tikzpicture}
  \caption{复数模的不等式关系}\label{fig:inequality_of_modulus}
\end{figure}

\begin{example}
  证明
  \begin{enumnopar}[(i)]
    \item $|z_1z_2|=|z_1\ov{z_2}|=|z_1|\cdot|z_2|$;
    \label{enum:modulus-z1z2-z1-z2}
    \item $|z_1+z_2|^2=|z_1|^2+|z_2|^2+2\Re(z_1\ov{z_2})$.
    \item $\bigl||z_1|-|z_2|\bigr|\le|z_1+z_2|$.
  \end{enumnopar}
\end{example}

\begin{proof}
  \begin{enumnopar}[(i)]
    \item 根据复数模的性质\ref{enum:modulus-zzbar},
    \[|z_1z_2|^2=z_1z_2\cdot\ov{z_1}\ov{z_2}
    =z_1z_2\ov{z_1}\ov{z_2}=|z_1|^2\cdot|z_2|^2.\]
    由于复数模总是非负实数, 因此 $|z_1z_2|=|z_1|\cdot|z_2|$.
    将 $z_2$ 换成 $\ov{z_2}$ 得到
    \[|z_1\ov{z_2}|=|z_1|\cdot|\ov{z_2}|=|z_1|\cdot|z_2|.\]
    \item 因为
    \begin{align*}
        |z_1+z_2|^2
       =(z_1+z_2)(\ov{z_1}+\ov{z_2})
      &=z_1\ov{z_1}+z_2\ov{z_2}+z_1\ov{z_2}+\ov{z_1}z_2,\\
        |z_1|^2+|z_2|^2+2\Re(z_1\ov{z_2})
      &=z_1\ov{z_1}+z_2\ov{z_2}+z_1\ov{z_2}+\ov{z_1\ov{z_2}},
    \end{align*}
    而 $\ov{z_1\ov{z_2}}=\ov{z_1}z_2$, 所以两式相等.
    \item 根据 \ref{enum:modulus-z1z2-z1-z2}, 我们有
      \[\bigl||z_1|-|z_2|\bigr|^2=|z_1|^2-2|z_1|\cdot|z_2|+|z_2|^2=|z_1|^2-2|z_1 \ov{z_2}|+|z_2|^2.\]
      由于
      \[|z_1\ov{z_2}|=|{-z_1\ov{z_2}}|\ge\Re(-z_1\ov z_2)=-\Re(z_1\ov z_2),\]
      因此
      \[\bigl||z_1|-|z_2|\bigr|^2\le |z_1|^2+2\Re(z_1 \ov{z_2})+|z_2|^2=|z_1+z_2|^2.\]
      而复数模总是非负实数, 所以 $\bigl||z_1|-|z_2|\bigr|\le|z_1+z_2|$.
  \end{enumnopar}
\end{proof}

\begin{exercise}
  什么时候 $|z_1+z_2+\cdots+z_n|=|z_1|+|z_2|+\cdots+|z_n|$ 成立?
\end{exercise}



\subsection{复数的三角形式和指数形式}

由 $x=r\cos\theta,y=r\sin\theta$ 可得
  \[z=r(\cos\theta+i\sin\theta).\]
我们把这种形式称为\nouns{复数的三角形式}{复数!三角形式}.
定义 \emph{$e^{i\theta}:=\cos\theta+i\sin\theta$}, 则上述形式可改写为\nouns{复数的指数形式}{复数!指数形式}%
  \footnote{%
    $e^{i\theta}:=\cos\theta+i\sin\theta$ 被称为\noun{欧拉恒等式}, 我们会在第二章说明为何如此定义.
  }%
  \[z=re^{i\theta}.\]
这两种形式是等价的, 指数形式可以认为是三角形式的一种缩写方式.
指数形式也可写作 $z=r\exp(i\theta)$.
求复数的三角和指数形式的\emph{关键在于计算模和辐角}.

\begin{example}
  将 $z=-2-\sqrt{12}i$ 化成三角形式和指数形式.
\end{example}

\begin{solution}
  显然 $|z|=\sqrt{4+12}=4$.
  由于 $z$ 在第三象限, 由\eqref{eq:arg}可知
    \[\arg z=\arctan\frac{-\sqrt{12}}{-2}-\pi=\frac\pi3-\pi=-\frac{2\pi}3.\]
  因此 $z$ 的三角形式和指数形式为
    \[z=4\Bigl(\cos\bigl(-\frac{2\pi}3\bigr)+i\sin\bigl(-
    \frac{2\pi}3\bigr)\Bigr)=4e^{-\frac{2\pi i}3}.\]
\end{solution}

\begin{example}
  设 $0<\theta<\dfrac\pi2$. 将 $z=\sin\theta-i\cos\theta$ 化成三角形式和指数形式.
\end{example}
\begin{solution}
  显然 $|z|=\sqrt{\sin^2\theta+\cos^2\theta}=1$. 由于 $z$ 在第四象限, 由\eqref{eq:arg}可知
  \[\arg z=\arctan\bigl(-\frac{\cos\theta}{\sin\theta}\bigr)=-\arctan\cot\theta=-(\frac\pi2-\theta)=\theta-\frac\pi2.\]
  因此 $z$ 的三角形式和指数形式为
  \[z=\displaystyle\cos(\theta-\frac\pi2)+i\sin(\theta-\frac\pi2)=e^{i(\theta-\frac\pi2)}.\]
\end{solution}
\begin{solution}[另解]
  利用三角函数间的等式关系得到
  \begin{align*}
    \sin\theta&=\cos(\frac\pi2-\theta)=\cos(\theta-\frac\pi2),\\
    -\cos\theta&=-\sin(\frac\pi2-\theta)=\sin(\theta-\frac\pi2).
  \end{align*}
  因此 $z$ 的三角形式和指数形式为
  \[z=\displaystyle\cos(\theta-\frac\pi2)+i\sin(\theta-\frac\pi2)=e^{i(\theta-\frac\pi2)}.\]
\end{solution}

求复数的三角或指数形式时, 只需要任取一个辐角就可以了, 不要求必须是辐角主值.

\begin{exercise}
  将 $z=\sqrt 3-3i$ 化成三角形式和指数形式.
\end{exercise}

\begin{example}
  设 $z=e^{i\theta}$, 其中 $-\pi<\theta<\pi$.
  求 $1+z$ 的三角形式和指数形式.
\end{example}
\begin{solution}
  我们有
  \[1+z=(1+\cos\theta)+i\sin\theta=2\cos^2\frac\theta2+2i\sin\frac\theta2\cos\frac\theta2
  =2\cos\frac\theta2(\cos\frac\theta2+i\sin\frac\theta2).\]
  由 $-\pi<\theta<\pi$ 可知 $\cos\dfrac\theta2>0$.
  因此 $1+z$ 的三角形式和指数形式为
  \[1+z=2\cos\frac\theta2(\cos\frac\theta2+i\sin\frac\theta2)=2\cos\frac\theta2e^{\frac{i\theta}2}.\]
\end{solution}

两个模相等的复数之和的三角和指数形式形式较为简单:
\[re^{i\theta}+re^{i\varphi}=2r\cos\frac{\theta-\varphi}2e^{\frac{\theta+\varphi}2i}.\]
从\figref{fig:sum_of_same_modulus}可以很容易得到该等式.
注意 $\cos\dfrac{\theta-\varphi}2<0$ 时, 这离指数形式还差一步变形.

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \coordinate [label=below left:0] (O) at (0,0);
    \coordinate [label=right:{$e^{i\varphi}$}] (Z1) at ({3*cos(18)},{3*sin(18)});
    \coordinate [label=left:{$e^{i\theta}$}] (Z2) at ({3*cos(130)},{3*sin(130)});
    \coordinate [label=above:{$e^{i\theta}+e^{i\varphi}$}] (P) at ($(Z1)+(Z2)$);
    \coordinate (M) at ($0.5*(P)$);
    \coordinate (X) at (2,0);
    \draw[thick] pic [cstfill, draw=third,"$\varphi$", angle eccentricity=1.4, angle radius=0.7cm] {angle=X--O--Z1};
    \draw[thick] pic [cstfill, draw=third, "$\frac{\theta-\varphi}2$", angle eccentricity=1.7] {angle=Z1--O--P};
    \draw[cstaxis] (-3,0)--(3,0);
    \draw[cstaxis] (0,-.4)--(0,3.5);
    \draw[cstcurve,cstra,main] (O)--(Z1);
    \draw[cstcurve,cstra,main] (O)--(Z2);
    \draw[cstcurve,cstra,second] (O)--(P);
    \draw[cstdash] (Z2)--(Z1)--(P)--(Z2);
    \draw[thick] (M)--++({.3*cos(16)},{-.3*sin(16)})--++({.3*sin(16)},{.3*cos(16)})--++({-.3*cos(16)},{.3*sin(16)});
  \end{tikzpicture}
  \caption{模相等的复数之和}\label{fig:sum_of_same_modulus}
\end{figure}

\section{复数的乘除、乘幂和方根}

三角形式和指数形式在进行复数的乘法、除法和幂次计算中非常方便.
\subsection{复数的乘除与三角形式和指数形式}

\begin{theorem}
  设复数 $z_1,z_2\neq0$ 的三角形式为
  \[z_1=r_1(\cos\theta_1+i\sin\theta_1),\qquad
    z_2=r_2(\cos\theta_2+i\sin\theta_2),\]
  则
  \begin{align*}
    z_1z_2&=r_1r_2[\cos(\theta_1+\theta_2)+i\sin(\theta_1+\theta_2)],\\
    \frac{z_1}{z_2}&=\frac{r_1}{r_2}[\cos(\theta_1-\theta_2)+i\sin(\theta_1-\theta_2)].
  \end{align*}
\end{theorem}

若表达为指数形式, 上述等式变为
  \[
  r_1e^{i\theta_1}\cdot r_2e^{i\theta_2}=r_1r_2e^{i(\theta_1+\theta_2)},\qquad
  \frac{r_1e^{i\theta_1}}{r_2e^{i\theta_2}}=\frac{r_1}{r_2}e^{i(\theta_1-\theta_2)}.
  \]

该定理表明:\footnote{多值函数相等是指两边所能取到的值构成的集合相等.
例如此处关于辐角的等式的含义是:
  \[\Arg(z_1z_2)=\{\theta_1+\theta_2\mid\theta_1\in\Arg z_1,\theta_2\in\Arg z_2\}.\]
  \[\Arg\Bigl(\frac{z_1}{z_2}\Bigr)=\{\theta_1-\theta_2\mid\theta_1\in\Arg z_1,\theta_2\in\Arg z_2\}.\]
},
  \[|z_1z_2|=|z_1|\cdot|z_2|,\quad\abs{\frac{z_1}{z_2}}=\frac{|z_1|}{|z_2|},\]
  \[\Arg(z_1z_2)=\Arg z_1+\Arg z_2,\quad
  \Arg\Bigl(\frac{z_1}{z_2}\Bigr)=\Arg z_1-\Arg z_2.\]
注意上述等式中 $\Arg$ 不能换成 $\arg$, 也就是说
  \[\arg(z_1z_2)=\arg z_1+\arg z_2,\quad
  \arg\Bigl(\frac{z_1}{z_2}\Bigr)=\arg z_1-\arg z_2\]
\emph{不一定成立}.
事实上, 当且仅当等式右侧落在区间 $(-\pi,\pi]$ 内时才成立, 否则等式两侧会相差 $\pm2\pi$.
例如 $z_1=z_2=e^{0.99\pi i}$, $z_1z_2=e^{1.98\pi i}$,
\[\arg z_1+\arg z_2=0.99\pi+0.99\pi=1.98\pi,\qquad
\arg(z_1z_2)=-.02\pi.\]

\begin{proof}
  根据和差的正弦、余弦公式可知
  \begin{align*}
    z_1z_2&=r_1(\cos\theta_1+i\sin\theta_1)\cdot
    r_2(\cos\theta_2+i\sin\theta_2)\\
    &{=r_1r_2\bigl[(\cos\theta_1\cos\theta_2-\sin\theta_1\sin\theta_2)
    +i(\cos\theta_1\sin\theta_2+\sin\theta_1\cos\theta_2)\bigr]}\\
    &{=r_1r_2\bigl[\cos(\theta_1+\theta_2)+i\sin(\theta_1+\theta_2)\bigr]}
  \end{align*}
  因此乘法情形得证.

  设 $\dfrac{z_1}{z_2}=re^{i\theta}$, 则由乘法情形可知 $rr_2=r_1$ 且 $\theta+\theta_2$ 是 $z_1$ 的辐角.
  因此 $r=\dfrac{r_1}{r_2}$, $\theta$ 可取 $\theta_1-\theta_2$.
\end{proof}


\subsection{复数乘法的几何意义}
从该定理可以看出, 乘以复数 $z=re^{i\theta}$ 可以理解为\emph{模放大为 $r$ 倍, 并沿逆时针旋转角度 $\theta$}.

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \coordinate [label=below:\textcolor{main}{$1$}] (X) at (1.6,0);
    \coordinate (O) at (0,0);
    \coordinate [label=right:\textcolor{main}{$z=re^{i\theta}$}] (Z) at ({2*cos(50)},{2*sin(50)});
    \coordinate [label=right:\textcolor{second}{$z_1$}] (Z1) at ({2.4*cos(80)},{2.4*sin(80)});
    \coordinate [label=right:\textcolor{second}{$zz_1$}] (ZZ1) at ({3*cos(130)},{3*sin(130)});
    \draw[cstcurve,main] pic [cstfill1,draw=main, "$\theta$", angle eccentricity=1.4] {angle=X--O--Z};
    \draw[cstcurve,second] pic [cstfill2,draw=second, "$\theta$", angle eccentricity=1.4] {angle=Z1--O--ZZ1};
    \draw[cstaxis] (-3,0)--(3,0);
    \draw[cstaxis] (0,-.5)--(0,3);
    \draw[cstcurve,main,cstra] (O)--(X);
    \draw[cstcurve,main,cstra] (O)--(Z);
    \draw[cstcurve,second,cstra] (O)--(Z1);
    \draw[cstcurve,second,cstra] (O)--(ZZ1);
  \end{tikzpicture}
  \caption{复数乘法的几何意义}
\end{figure}

\begin{example}
  已知正三角形的两个顶点为 $z_1=1$ 和 $z_2=2+i$, 求它的另一个顶点.
\end{example}

\begin{center}
  \begin{tikzpicture}
    \coordinate [label=below:\textcolor{third}{$z_1$}] (Z1) at (1.5,0);
    \coordinate [label=right:\textcolor{third}{$z_2$}] (Z2) at (3,1.5);
    \coordinate [label=left:\textcolor{main}{$z_3$}] (Z3) at ({1.5*(1.5-sqrt(3)/2)},{1.5*(.5+sqrt(3)/2)});
    \coordinate [label=right:\textcolor{second}{$z'_3$}] (Z3p) at ({1.5*(1.5+sqrt(3)/2)},{1.5*(.5-sqrt(3)/2)});
    \draw[cstcurve,main] pic [cstfill1,draw=main, "$\pi/3$", angle eccentricity=1.7,angle radius=4mm] {angle=Z2--Z1--Z3};
    \draw[cstcurve,second] pic [cstfill2,draw=second, "$\pi/3$", angle eccentricity=1.8] {angle=Z3p--Z1--Z2};
    \draw[cstaxis] (-.5,0)--(4,0);
    \draw[cstaxis] (0,-.5)--(0,2.5);
    \draw[cstcurve,third] (Z1)--(Z2);
    \draw[cstcurve,main] (Z2)--(Z3)--(Z1);
    \draw[cstdash,second] (Z1)--(Z3p)--(Z2);
  \end{tikzpicture}
\end{center}

\begin{solution}
  由于 $\overrightarrow{Z_1Z_3}$ 为 $\overrightarrow{Z_1Z_2}$ 顺时针或逆时针旋转 $\dfrac\pi3$, 因此
  \begin{align*}
    z_3-z_1&=(z_2-z_1)\exp\left(\pm\frac{\pi i}3\right)
    =(1+i)\left(\half\pm\frac{\sqrt3}2i\right)\\
    &=\frac{1-\sqrt3}2+\frac{1+\sqrt3}2i\ \text{或}\ \frac{1+\sqrt3}2+\frac{1-\sqrt3}2i,\\
    z_3&=\frac{3-\sqrt3}2+\frac{1+\sqrt3}2i\ \text{或}\ \frac{3+\sqrt3}2+\frac{1-\sqrt3}2i.
  \end{align*}
\end{solution}

\begin{example}
  设 $AD$ 是 $\triangle ABC$ 的角平分线, 证明 $\dfrac{AB}{AC}=\dfrac{DB}{DC}$.
\end{example}

\begin{center}
  \begin{tikzpicture}
    \coordinate [label=below left:\textcolor{main}{$A$}] (A) at (0,0);
    \coordinate [label=right:\textcolor{main}{$B=z$}] (B) at ({3*cos(60)},{3*sin(60)});
    \coordinate [label=below:\textcolor{main}{$C=1$}] (C) at (2,0);
    \coordinate [label=right:\textcolor{second}{$D=w$}] (D) at ($0.4*(B)+0.6*(C)$);
    \draw[cstcurve] pic [cstfill2,draw=second] {angle=C--A--D};
    \draw[cstcurve] pic [cstfill3,draw=third,angle radius=4mm] {angle=D--A--B};
    \draw[cstaxis] (-.3,0)--(3,0);
    \draw[cstaxis] (0,-.4)--(0,2);
    \draw[cstcurve,main] (B)--(A)--(C)--cycle;
    \draw[cstcurve,second] (A)--(D);
  \end{tikzpicture}
\end{center}

\begin{proof}
  不妨设 $A=0,B=z,C=1,D=w$, 设
  \[\lambda=\dfrac{DC}{BC}=\dfrac{w-1}{z-1}\in(0,1).\]
  那么
  \[w=1+\lambda(z-1)=\lambda z+(1-\lambda).\]
  由于 $\angle BAD=\angle DAC$, 根据复数乘法的几何意义,
  $\dfrac{z-0}{w-0}$ 是 $\dfrac{w-0}{1-0}$ 的正实数倍, 即
  \[\frac{w^2}z=\lambda^2 z+2\lambda(1-\lambda)+\frac{(1-\lambda)^2}z\in\BR,\]
  于是
    \[\lambda^2z+\dfrac{(1-\lambda)^2}z=\lambda^2\ov z+\dfrac{(1-\lambda)^2}{\ov z},\qquad
    \bigl(\lambda^2|z|^2-(1-\lambda)^2\bigr)(z-\ov z)=0.\]
  显然 $z\neq \ov z$. 又因为 $0<\lambda<1$, 故
    \[\frac{AB}{AC}=|z|=\frac{1-\lambda}{\lambda}
    =\frac{BC-DC}{DC}=\frac{DB}{DC}.\]
\end{proof}


\subsection{复数的乘幂}

设 $z=r(\cos\theta+i\sin\theta)=re^{i\theta}\neq0$.
根据复数三角和指数形式的乘法和除法运算法则, 我们有
\begin{theorem}
  \[z^n=r^n(\cos{n\theta}+i\sin{n\theta})=r^ne^{in\theta},\quad\forall n\in\BZ.\]
\end{theorem}
特别地, 当 $r=1$ 时, 我们得到\emph{棣莫弗公式}
\[(\cos\theta+i\sin\theta)^n=\cos{n\theta}+i\sin{n\theta}.\]
对棣莫弗公式左侧进行二项式展开可以得到
\begin{align*}
  \cos(2\theta)&=\hphantom{1}2\cos^2\theta-\hphantom{1}1,\\
  \cos(3\theta)&=\hphantom{1}4\cos^3\theta-\hphantom{1}3\cos\theta,\\
  \cos(4\theta)&=\hphantom{1}8\cos^4\theta-\hphantom{1}8\cos^2\theta+1,\\
  \cos(5\theta)&=16\cos^5\theta-20\cos^3\theta+5\cos\theta.
\end{align*}
一般地, 可以证明 $\cos{n\theta}$ 是 $\cos\theta$ 的 $n$ 次多项式,
这个多项式
\[g_n(T)=2^{n-1}T^n-n2^{n-3}T^{n-2}+\cdots\]
叫做\emph{切比雪夫多项式}.
它在计算数学的逼近理论中有着重要作用.

\begin{example}
  求 $(1+i)^n+(1-i)^n$.
\end{example}

\begin{solution}
  由于
  \[
    1+i=\sqrt2\left(\cos\frac\pi4+i\sin\frac\pi4\right),\quad
    1-i=\sqrt2\left(\cos\frac\pi4-i\sin\frac\pi4\right),
  \]
  因此
    \[
       (1+i)^n+(1-i)^n
      =2^{\frac n2}\left(\cos\frac{n\pi}4+i\sin\frac{n\pi}4 
       +\cos\frac{n\pi}4-i\sin\frac{n\pi}4\right)
      =2^{\frac n2+1}\cos\frac{n\pi}4.
    \]
\end{solution}

\begin{exercise}
  化简 $(\sqrt3+i)^{2022}=$\fillblank[6em]{}.
\end{exercise}


\subsection{复数的方根}

我们利用复数乘幂公式来计算复数 $z$ 的 \emph{$n$ 次方根 $\sqrt[n]z$}.
设
  \[w^n=z=re^{i\theta}\neq0,\quad w=\rho e^{i\varphi},\]
则
  \[
    w^n=\rho^n(\cos{n\varphi}+i\sin{n\varphi})
       =r(\cos\theta+i\sin\theta).
  \]
比较两边的模可知 $\rho^n=r,\rho=\sqrt[n]r$.
为了避免记号冲突, 当 $r$ 是正实数时, $\sqrt[n]r$ 默认表示 $r$ 的唯一的 $n$ 次正实根, 称之为\emph{算术根}.

由于 $n\varphi$ 和 $\theta$ 的正弦和余弦均相等, 因此存在整数 $k$ 使得
  \[n\varphi=\theta+2k\pi,\quad \varphi=\frac{\theta+2k\pi}n.\]
故 $w=w_k=\sqrt[n]r\exp\Bigl(\dfrac{\theta+2k\pi}ni\Bigr)$.
不难看出, $w_k=w_{k+n}$, 而 $w_0,w_1,\dots,w_{n-1}$ 两两不同.
因此只需取 $k=0,1,\dots,n-1$.
\begin{theorem}
  任意一个非零复数 $z$ 的 $n$ 次方根有 $n$ 个值:
  \[
    \sqrt[n]z=\sqrt[n]r\exp\Bigl(\dfrac{\theta+2k\pi}ni\Bigr)\\
      =\sqrt[n]r\Bigl(\cos\frac{\theta+2k\pi}n+i\sin\frac{\theta+2k\pi}n\Bigr),\quad k=0,1,\dots,n-1.
  \]
\end{theorem}
这些根的模都相等, 且 $w_k$ 和 $w_{k+1}$ 辐角相差 $\dfrac{2\pi}n$.
因此\emph{它们是以原点为中心, $\sqrt[n]r$ 为半径的圆的内接正 $n$ 边形的顶点}.

\begin{example}
  求 $\sqrt[4]{1+i}$.
\end{example}

\begin{solution}
  由于
    \[1+i=\sqrt2\exp\left(\dfrac{\pi i}4\right),\]
  因此
    \[\sqrt[4]{1+i}=\sqrt[8]2\exp\frac{(\frac\pi4+2k\pi)i}4,\quad k=0,1,2,3.\]
  于是该方根全部值为
    \[w_0=\sqrt[8]2e^{\frac{\pi i}{16}},\quad
    w_1=\sqrt[8]2e^{\frac{9\pi i}{16}},\quad
    w_2=\sqrt[8]2e^{\frac{17\pi i}{16}},\quad
    w_3=\sqrt[8]2e^{\frac{25\pi i}{16}}.\]
\end{solution}
显然 $w_{k+1}=iw_k$,
所以 $w_0,w_1,w_2,w_3$ 形成了一个正方形.

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \draw[cstaxis] (-2.3,0)--(2.3,0);
    \draw[cstaxis] (0,-2.3)--(0,2.3);
    \coordinate [label=below left:$0$] (O) at (0,0);
    \draw[cstcurve,thick,third,cstra] (0,0) circle (1.6);
    \coordinate (W0) at ({1.6*cos(11.25)},{1.6*sin(11.25)});
    \coordinate (W1) at ({1.6*cos(101.25)},{1.6*sin(101.25)});
    \coordinate (W2) at ({1.6*cos(191.25)},{1.6*sin(191.25)});
    \coordinate (W3) at ({1.6*cos(281.25)},{1.6*sin(281.25)});
    \draw[cstcurve,thick,second,cstra] (O)--(W0)
      node[right] {$w_0$};
    \draw[cstcurve,thick,second,cstra] (O)--(W1)
      node[above] {$w_1$};
    \draw[cstcurve,thick,second,cstra] (O)--(W2)
      node[left] {$w_2$};
    \draw[cstcurve,thick,second,cstra] (O)--(W3)
      node[below] {$w_3$};
    \draw[cstcurve,main] (W0)--(W1)--(W2)--(W3)--cycle;
  \end{tikzpicture}
  \caption{$\sqrt[4]{1+i}$ 的所有值}
\end{figure}

\begin{exercise}
  计算 $\sqrt[6]{-1}=$\fillblank[12em]{}.
\end{exercise}

注意当 $|n|\ge 2$ 时, \emph{$\Arg(z^n)=n\Arg z$ 不成立}.
这是因为
  \begin{align*}
    \Arg(z^n)&=n\arg z+2k\pi,\quad k\in\BZ,\\
    n\Arg z&=n\arg z+2nk\pi,\quad k\in\BZ.
  \end{align*}
不过我们总有
  \[\Arg \sqrt[n]z=\dfrac1n\Arg z=\dfrac{\arg z+2k\pi}n,\quad k\in\BZ,\]
其中左边表示 $z$ 的所有 $n$ 次方根的所有辐角\footnote{此即多值函数复合的含义.}.


\subsection{应用: 实系数三次方程根的情况}
现在我们来看三次方程 $x^3+px+q=0$ 的根, $p\neq 0$.
回顾求根公式:
  \[x=u+v,\quad u^3=-\frac q2+\sqrt{\Delta},\quad uv=-\frac p3,\quad \Delta=\frac{q^2}4+\frac{p^3}{27}.\]
\begin{enumerate}
  \item 如果 $\Delta>0$, 设 $\omega=e^{2\pi i/3}$, 设实数 $\alpha$ 满足
    \[\alpha^3=-\frac q2+\sqrt{\Delta},\]
  则
    \[
      u=\alpha,\alpha\omega,\alpha\omega^2,\qquad
      x=\alpha-\frac p{3\alpha},\ 
        \alpha\omega-\frac p{3\alpha} \omega^2,\ 
        \alpha\omega^2-\frac p{3\alpha} \omega.
    \]
    容易证明后两个根都是虚数.
  \item 如果 $\Delta\le 0$, 则 $p<0$, $|u|^2=-\dfrac p3>0$. 从而 $v=\ov u$.
    设
      \[\sqrt[3]{-\frac q2+\sqrt{\Delta}}=u_1,u_2,u_3,\]
    则我们得到 $3$ 个实根
      \[x=u_1+\ov{u_1},\ u_2+\ov{u_2},\ u_3+\ov{u_3}.\]
    不难验证, 若有重根则 $\Delta=0$.
\end{enumerate}


\section{曲线和区域}

\subsection{复数表平面曲线}

很多的平面图形能用复数形式的方程来表示, 这种表示方程有些时候会显得更加直观和易于理解.

\begin{example}
  \begin{enumerate}
    \item $|z+i|=2$. 该方程表示与 $-i$ 的距离为 $2$ 的点全体, 即圆心为 $-i$ 半径为 $2$ 的圆.
    一般的圆方程为 $|z-z_0|=R$, 其中 $z_0$ 是圆心, $R$ 是半径.
    
\begin{figure}[hbpt]
  \begin{minipage}{.48\textwidth}
    \centering
    \begin{tikzpicture}
      \draw[cstaxis] (-1.5,0)--(1.5,0);
      \draw[cstaxis] (0,-2)--(0,1);
      \coordinate (A) at (0,-.6);
      \fill[cstdot,second] (A) circle
        node[left] {$-i$};
      \draw[cstcurve,main] (A) circle(1.2);
    \end{tikzpicture}
  \end{minipage}
  \begin{minipage}{.48\textwidth}
    \centering
    \begin{tikzpicture}
      \draw[cstaxis] (-1.5,0)--(1.5,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
      \coordinate (A) at (-1,0);
      \fill[cstdot,second] (A) circle node[above] {$-2$};
      \coordinate (B) at (0,1);
      \fill[cstdot,second] (B) circle node[left] {$2i$};
      \draw[cstcurve,main] (-1.2,1.2)--(1.2,-1.2);
    \end{tikzpicture}
  \end{minipage}
\end{figure}
    \item $|z-2i|=|z+2|$. 该方程表示与 $2i$ 和 $-2$ 的距离相等的点, 即二者连线的垂直平分线.两边同时平方化简可得 $x+y=0$.
    \item $\Im(i+\ov z)=4$. 设 $z=x+yi$, 则 $\Im(i+\ov z)=1-y=4$, 因此 $y=-3$.
    \item $|z-z_1|+|z-z_2|=2a$.
    \begin{itemize}
      \item 当 $2a>|z_1-z_2|$ 时, 该方程表示以 $z_1,z_2$ 为焦点, $a$ 为长半轴的椭圆;
      \item 当 $2a=|z_1-z_2|$ 时, 该方程表示连接 $z_1,z_2$ 的线段;
      \item 当 $2a<|z_1-z_2|$ 时, 该方程表示空集.
    \end{itemize}
    \item $|z-z_1|-|z-z_2|=2a$.
    \begin{itemize}
      \item 当 $2a<|z_1-z_2|$ 时, 该方程表示以 $z_1,z_2$ 为焦点, $a$ 为实半轴的双曲线的一支;
      \item 当 $2a=|z_1-z_2|$ 时, 该方程表示以 $z_2$ 为起点, 与 $z_2,z_1$ 连线反向的射线;
      \item 当 $2a>|z_1-z_2|$ 时, 该方程表示空集.
    \end{itemize}
  \end{enumerate}
\end{example}

\begin{exercise}
  $z^2+\ov z^2=1$ 和 $z^2-\ov z^2=i$ 分别表示什么图形?
\end{exercise}


\subsection{区域和闭区域}

为了引入极限的概念, 我们需要考虑点的邻域.
类比于高等数学中的邻域和去心邻域, 我们在复变函数中, 称开圆盘
  \[U(z_0,\delta)=\{z:|z-z_0|<\delta\}\]
为 $z_0$ 的一个 \emph{$\delta$ 邻域}, 称去心开圆盘
  \[\Uc(z_0,\delta)=\{z:0<|z-z_0|<\delta\}\]
为 $z_0$ 的一个\emph{去心 $\delta$ 邻域}.

\begin{figure}[hbpt]
  \centering
  \begin{minipage}{.48\textwidth}
    \centering
    \begin{tikzpicture}
      \coordinate (A);
      \filldraw[cstcurve,main,cstfill1] (A) circle (1.5);
      \draw[cstcurve,cstra,second] (A)--(1.2,.9)
        node[midway,above left] {$\delta$};
      \fill[cstdot,second] (A) circle
        node[left] {$z_0$};
    \end{tikzpicture}
  \end{minipage}
  \begin{minipage}{.48\textwidth}
    \centering
    \begin{tikzpicture}
      \coordinate (A);
      \filldraw[cstcurve,main,cstfill1] (A) circle (1.5);
      \draw[cstcurve,cstra,second] (A)--(1.2,.9)
        node[midway,above left] {$\delta$};
      \filldraw[cstdote,draw=main] (A) circle
        node[left,second] {$z_0$};
    \end{tikzpicture}
  \end{minipage}
  \caption{邻域和去心邻域}
\end{figure}

设 $G$ 是复平面的一个子集, $z_0\in\BC$.
它们的位置关系有三种可能:
\begin{enumerate}
  \item 如果存在 $z_0$ 的一个邻域 $U$ 完全包含在 $G$ 中, 则称 $z_0$ 是 $G$ 的一个\emph{内点}.
  \item 如果存在 $z_0$ 的一个邻域 $U$ 完全不包含在 $G$ 中, 则称 $z_0$ 是 $G$ 的一个\emph{外点}.
  \item 如果 $z_0$ 的任何一个邻域 $U$, 都有属于和不属于 $G$ 的点, 则称 $z_0$ 是 $G$ 的一个\emph{边界点}.
\end{enumerate}
显然内点都属于 $G$, 外点都不属于 $G$, 而边界点则都有可能.
这类比于区间的端点和区间的关系.

\begin{figure}
  \centering
  \begin{tikzpicture}
    \filldraw[cstcurve,main,cstfill1,smooth] plot coordinates {(2,0) (1.83,.9) (.64,1.46) (-.63,1.6) (-1.66,1.01) (-2.35,0) (-1.81,-1.06) (-.73,-1.68) (.74,-1.57) (1.82,-.91) (2,0)};
    \coordinate (A) at (-.7,0);
    \draw[cstcurve,second] (A) circle (.5) node[above] {$z_0$};
    \fill[cstdot,second] (A) circle;
    \coordinate (B) at (2,0);
    \draw[cstcurve,third] (B) circle (.5) node[right] {$z_0$};
    \fill[cstdot,third] (B) circle;
    \coordinate (C) at (4,0);
    \draw[cstcurve,fourth] (C) circle (.5) node[above] {$z_0$};
    \fill[cstdot,fourth] (C) circle;
    \draw (.5,0) node[main] {$G$};
  \end{tikzpicture}
  \caption{点与集合的位置关系}
\end{figure}

\begin{definition}
  \begin{enumerate}
    \item 如果 $G$ 的所有点都是内点, 也就是说, $G$ 的边界点都不属于它, 称 $G$ 是一个\emph{开集}.
    \item 如果 $G$ 的所有边界点都属于 $G$, 称 $G$ 是一个\emph{闭集}.
  \end{enumerate}
\end{definition}
例如
  \[|z-z_0|<R,\quad 1<\Re z<3,\quad\frac\pi4<\arg z<\dfrac{3\pi}4\]
都是开集\footnote{最后一个集合不包括原点}.
$G$ 是一个闭集当且仅当它的补集是开集.
直观上看: 开集往往由 $>,<$ 的不等式给出, 闭集往往由 $\ge,\le$ 的不等式给出.
不过注意这并不是绝对的.

如果 $D$ 可以被包含在某个开圆盘 $U(0,R)$ 中, 则称它是\emph{有界}的.
否则称它是\emph{无界}的.

\begin{definition}
  如果开集 $D$ 的任意两个点之间都可以用一条完全包含在 $D$ 中的折线连接起来, 则称 $D$ 是一个\emph{区域}.
  也就是说, 区域是连通的开集.
\end{definition}
区域和它的边界一起构成了\emph{闭区域}, 记作 $\ov D$.
它是一个闭集.

观察下方的图案, 阴影部分(不包含线条部分)中任意两点可用折线连接, 因此它是一个区域.
这些线条和点构成了它的边界.

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \filldraw[cstcurve,main,cstfill1,smooth] plot coordinates {(2.81,0) (2.37,1.03) (.91,1.7) (-.8,1.48) (-2.29,1.05) (-2.89,0) (-2.24,-1.03) (-.92,-1.64) (.81,-1.65) (2.38,-.93) (2.81,0)};
    \filldraw[cstcurve,main,fill=white,smooth] plot coordinates {(-.86,-.3) (-1.16,.31) (-1.62,.1) (-1.68,-.69) (-1.17,-.91) (-.86,-.3)};
    \filldraw[cstcurve,main,fill=white] (.5,.3) circle (.3);
    \fill[cstdot,main] (1.5,0) circle;
    \fill[cstdot,main] (1.6,-.5) circle;
    \draw[cstcurve,second,main] plot coordinates {(1,.5) (1.2,.3) (1.2,-.3) (1.4,.5)};
    \coordinate [label=left:\textcolor{second}{$z_1$}] (A) at (-1,.8);
    \coordinate [label=below:\textcolor{second}{$z_2$}] (B) at (1,-.8);
    \draw[cstcurve,second] (A)--(-.2,.5)--(.2,-.5)--(B);
  \end{tikzpicture}
  \caption{区域和它的边界}
\end{figure}

数学中边界的概念与日常所说的边界是两码事. 例如区域 $|z|>1$ 的边界是 $|z|=1$, 其闭区域是 $|z|\ge 1$.

很多区域可以由复数的实部、虚部、模和辐角的不等式所确定.
\begin{exercise}
  下方区域对应的闭区域是什么?
\end{exercise}

\begin{figure}[hbpt]
  \begin{minipage}{.24\textwidth}
    \centering
    \begin{tikzpicture}
      \draw[cstaxis](-1.5,0)--(1.5,0);
      \draw[cstaxis](0,-1.5)--(0,1.5);
      \fill[cstfille1] (-1.2,0) rectangle (1.2,.8);
      \draw (0,-1.5) node[below,align=center] {上半平面\\$\Im z>0$};
    \end{tikzpicture}
  \end{minipage}
  \begin{minipage}{.24\textwidth}
    \centering
    \begin{tikzpicture}
      \draw[cstaxis](-1.5,0)--(1.5,0);
      \draw[cstaxis](0,-1.5)--(0,1.5);
      \fill[cstfille1] (-1.2,0) rectangle (1.2,-.8);
      \draw (0,-1.5) node[below,align=center] {下半平面\\$\Im z<0$};
    \end{tikzpicture}
  \end{minipage}
  \begin{minipage}{.24\textwidth}
    \centering
    \begin{tikzpicture}
      \draw[cstaxis](-1.5,0)--(1.5,0);
      \draw[cstaxis](0,-1.5)--(0,1.5);
      \fill[cstfille1] (-1.2,-1) rectangle (0,1);
      \draw (0,-1.5) node[below,align=center] {左半平面\\$\Re z<0$};
    \end{tikzpicture}
  \end{minipage}
  \begin{minipage}{.24\textwidth}
    \centering
    \begin{tikzpicture}
      \draw[cstaxis](-1.5,0)--(1.5,0);
      \draw[cstaxis](0,-1.5)--(0,1.5);
      \fill[cstfille1] (0,1) rectangle (1.2,-1);
      \draw (0,-1.5) node[below,align=center] {右半平面\\$\Re z>0$};
    \end{tikzpicture}
  \end{minipage}
\end{figure}

\begin{figure}[hbpt]
  \begin{minipage}{.24\textwidth}
    \centering
    \begin{tikzpicture}
      \draw[cstaxis](-1.5,0)--(1.5,0);
      \draw[cstaxis](0,-1.5)--(0,1.5);
      \fill[cstfille1] (-.6,-1) rectangle (.2,1);
      \draw[cstcurve,main] (-.6,-1)--(-.6,1);
      \draw[cstcurve,main] (.2,-1)--(.2,1);
      \draw (0,-1.5) node[below,align=center] {竖直带状区域\\$x_1<\Re z<x_2$};
    \end{tikzpicture}
  \end{minipage}
  \begin{minipage}{.24\textwidth}
    \centering
    \begin{tikzpicture}
      \draw[cstaxis](-1.5,0)--(1.5,0);
      \draw[cstaxis](0,-1.5)--(0,1.5);
      \fill[cstfille1] (-.5,-.4) rectangle (1.1,.4);
      \draw[cstcurve,main] (-.5,-.4)--(1.1,-.4);
      \draw[cstcurve,main] (-.5,.4)--(1.1,.4);
      \draw (0,-1.5) node[below,align=center] {水平带状区域\\$y_1<\Im z<y_2$};
    \end{tikzpicture}
  \end{minipage}
  \begin{minipage}{.24\textwidth}
    \centering
    \begin{tikzpicture}
      \draw[cstaxis](-.5,0)--(2.5,0);
      \draw[cstaxis](0,-.5)--(0,2.5);
      \coordinate (A) at (0,0);
      \coordinate (B) at ({2.2*cos(60)},{2.2*sin(60)});
      \coordinate (C) at ({2.2*cos(10)},{2.2*sin(10)});
      \fill[cstfille1] (A)--(B) arc(60:10:2.2)--cycle;
      \draw[cstcurve,main] (C)--(A)--(B);
      \draw (1,-.5) node[below,align=center] {角状区域\\$\alpha_1<\arg z<\alpha_2$};
    \end{tikzpicture}
  \end{minipage}
  \begin{minipage}{.24\textwidth}
    \centering
    \begin{tikzpicture}
      \filldraw[cstcurve,main,cstfill1] (0,0) circle (1.2);
      \filldraw[cstcurve,main,fill=white] (0,0) circle (.6);
      \draw[cstaxis](-1.5,0)--(1.5,0);
      \draw[cstaxis](0,-1.5)--(0,1.5);
      \draw (0,-1.5) node[below,align=center] {圆环域\\$r<|z|<R$};
    \end{tikzpicture}
  \end{minipage}
\end{figure}


\subsection{区域的特性}

设 $x(t),y(t),t\in[a,b]$ 是两个连续函数,
则参变量方程
  \[\begin{cases}x=x(t),& \\y=y(t),&\end{cases}t\in[a,b]\]
定义了一条\emph{连续曲线}.
这也等价于 $C:z=z(t)=x(t)+iy(t),t\in[a,b]$.
如果除了两个端点有可能重叠外, 其它情形不会出现重叠的点, 则称 $C$ 是\emph{简单曲线}.
如果还满足两个端点重叠, 即 $z(a)=z(b)$, 则称 $C$ 是\emph{简单闭曲线}或\emph{闭路}.

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \draw[cstaxis](-.3,0)--(9.5,0);
    \draw[cstaxis](0,-.3)--(0,2.5);
    \coordinate (A) at (.7,.9);
    \coordinate (B) at (3.5,.9);
    \draw[cstcurve,main,smooth] plot coordinates {(A) (1.5,1.6) (2.5,.6) (B)};
    \fill[cstdot,second] (A) circle node[below] {$z(a)$};
    \fill[cstdot,second] (B) circle node[above] {$z(b)$};
    \draw[cstcurve,second,smooth] plot coordinates {(4.8,.7) (5.76,1.25) (6.31,2) (5.77,2.71) (4.77,2.45) (4.78,1.55) (6.2,.7) };
    \draw[cstcurve,main,smooth] plot coordinates {(9.02,1.5) (8.9,1.98) (8.33,2.27) (7.69,2.18) (7.07,1.95) (6.94,1.5) (7.11,1.04) (7.68,.75) (8.34,.82) (8.93,1.08) (9.02,1.5)};
  \end{tikzpicture}
  \caption{简单曲线、非简单曲线、闭路}
\end{figure}

闭路 $C$ 把复平面划分成了两个区域, 一个有界一个无界.
分别称这两个区域是 $C$ 的\emph{内部}和\emph{外部}.
$C$ 是它们的公共边界.
\footnote{B. Bolzano 最早明确陈述了这个定理, 并指出它是需要证明的. 1893 年, C. Jordan 首次给出了证明, 其中假设了该定理对于简单多边形成立 (这个情形并不难证明). 不少数学家认为第一个给出完备证明的是美国数学家 O. Veblen(1905).}

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \fill[cstfille1] (-2,-1.5) rectangle (2,1.5);
    \filldraw[cstcurve,main,cstfill1,smooth] plot coordinates {(1.18,0) (.93,.64) (.33,1.06) (-.32,1.08) (-.83,.59) (-1.15,0) (-.83,-.68) (-.36,-1) (.36,-1.08) (.83,-.69) (1.18,0)};
  \end{tikzpicture}
  \caption{闭路的内部和外部}
\end{figure}

在前面所说的几个常见区域的例子中, 我们在区域中画一条闭路.
除了圆环域之外, 闭路的内部仍然包含在这个区域内.

\begin{definition}
  如果区域 $D$ 中的任一闭路的内部都包含在 $D$ 中, 则称 $D$ 是\emph{单连通区域}.
  否则称之为\emph{多连通区域}.
\end{definition}

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \filldraw[cstcurve,main,cstfill1,smooth] plot coordinates {(2.81,0) (2.37,1.03) (.91,1.7) (-.8,1.48) (-2.29,1.05) (-2.89,0) (-2.24,-1.03) (-.92,-1.64) (.81,-1.65) (2.38,-.93) (2.81,0)};
    \filldraw[cstcurve,main,fill=white,smooth] plot coordinates {(-.86,-.3) (-1.16,.31) (-1.62,.1) (-1.68,-.69) (-1.17,-.91) (-.86,-.3)};
    \filldraw[cstcurve,main,fill=white] (.5,.3) circle (.3);
    \fill[cstdot,main] (1.5,0) circle;
    \fill[cstdot,main] (1.6,-.5) circle;
    \draw[cstcurve,main] plot coordinates {(1,.5) (1.2,.3) (1.2,-.3) (1.4,.5)};
    \draw[cstcurve,second,smooth] plot coordinates {(1.94,-.2) (1.79,.41) (1.23,.77) (.58,.81) (.04,.35) (-.3,-.2) (.03,-.81) (.53,-1.19) (1.23,-1.08) (1.76,-.82) (1.94,-.2)};
  \end{tikzpicture}
  \caption{多连通区域}
\end{figure}

单连通区域内的任一闭路可以``连续地变形''成一个点.\footnote{不妨设 $\ell: z=x(t)+iy(t),t\in[0,1]$ 是闭路.
如果存在连续函数 $X,Y:[0,1]\times[0,1]\to \BR$ 使得对 $0\le s<1$
$\ell_s: z=X(s,t)+iY(s,t),t\in[0,1]$
都是闭路, 且 $\ell_0=\ell,\ell_1=a+bi$,
则称闭路 $\ell$ 可以连续地变形为点 $a+bi$.}
这也等价于: 设 $\ell_0,\ell_1$ 是从 $A$ 到 $B$ 的两条连续曲线, 则 $\ell_0$ 可以连续地变形为 $\ell_1$ 且保持端点不动.\footnote{不妨设 $\ell_0: z=x_0(t)+iy_0(t),\ell_1: z=x_1(t)+iy_1(t),t\in[0,1]$.
如果存在连续函数 $X,Y:[0,1]\times[0,1]\to \BR$ 使得
\[\ell_0: z=X(0,t)+iY(0,t),\quad \ell_1: z=X(1,t)+iY(1,t),\]
则称 $\ell_0$ 可以连续地变形为 $\ell_1$ 且保持端点不动.
}

\begin{example}
  \begin{enumerate}
    \item $\Re(z^2)\le1$. 设 $z=x+yi$, 则 $\Re(z^2)=x^2-y^2\le1$. 这是无界的单连通闭区域.
    \item $\arg z\neq \pi$. 即角状区域 $-\pi<\arg z<\pi$. 这是无界的单连通区域.
    \item $\abs{\dfrac1z}\le3$. 即 $|z|\ge\dfrac13$. 这是无界的多连通闭区域.
    \item $|z+1|+|z-1|<4$. 表示一个椭圆的内部. 这是有界的单连通区域.
  \end{enumerate}
\end{example}

\begin{figure}[hbpt]
  \begin{minipage}{.24\textwidth}
    \centering
    \begin{tikzpicture}
      \fill[cstfille1] (-1.414,-1) rectangle (1.414,1);
      \filldraw[cstcurve,main,domain=-45:45,smooth,fill=white] plot ({sec(\x)},{tan(\x)});
      \filldraw[cstcurve,main,domain=-45:45,smooth,fill=white] plot ({-sec(\x)},{tan(\x)});
      \draw[cstaxis] (-1.8,0)--(1.8,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
    \end{tikzpicture}
  \end{minipage}
  \begin{minipage}{.24\textwidth}
    \centering
    \begin{tikzpicture}
      \fill[cstfille1] (0,0) circle (1.2);
      \draw[cstaxis] (0,0)--(1.5,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
      \draw[cstdash,main] (-1.5,0)--(0,0);
    \end{tikzpicture}
  \end{minipage}
  \begin{minipage}{.24\textwidth}
    \centering
    \begin{tikzpicture}
      \fill[cstfille1] (-1.2,-1.2) rectangle (1.2,1.2);
      \filldraw[cstcurve,main,fill=white] (0,0) circle (.5);
      \draw[cstaxis] (-1.5,0)--(1.5,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
    \end{tikzpicture}
  \end{minipage}
  \begin{minipage}{.24\textwidth}
    \centering
    \begin{tikzpicture}
      \filldraw[cstdash,main,cstfill1] (0,0) circle (1 and {0.5*sqrt(3)});
      \draw[cstaxis] (-1.5,0)--(1.5,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
    \end{tikzpicture}
  \end{minipage}
\end{figure}

\begin{exercise}
  $|z+1|+|z-1|\ge 1$ 表示什么集合?
\end{exercise}


\section{复变函数}

\subsection{复变函数的定义}

所谓的\emph{映射}, 就是两个集合之间的一种对应 $f:A\to B$, 使得对于每一个 $a\in A$, 有一个唯一确定的 $b=f(a)$ 与之对应.
\begin{itemize}
  \item 当 $A$ 和 $B$ 都是实数集合的子集时, 它就是一个实变函数.
  \item 当 $A$ 和 $B$ 都是复数集合的子集时, 它就是一个\emph{复变函数}.
\end{itemize}

\begin{example}
  $f(z)=\Re z,\arg z,|z|$, $z^n$ ($n\neq0$ 为整数), $\dfrac{z+1}{z^2+1}$ 都是复变函数.
\end{example}

\begin{definition}
  \begin{itemize}
    \item 称 $A$ 为 函数 $f$ 的\emph{定义域}.
    \item 称 $\set{w=f(z)\mid z\in A}$ 为它的\emph{值域}.\footnotemark
  \end{itemize} 
\end{definition}
\footnotetext{值域和\emph{陪域} $B$ 往往不相同. 在高等数学中的函数陪域总可选为 $\BR$, 本课程中复变函数陪域总可选为 $\BC$.
尽管在某些情形下不同陪域的函数视为不同, 但在高等数学和本课程中, 不考虑陪域是否相同, 只要定义域和对应关系相同, 就视为同一函数.}
\begin{exercise}
  上述函数的定义域和值域分别是什么?
\end{exercise}

在复变函数理论中, 常常会遇到\emph{多值的复变函数}, 也就是说一个 $z\in A$ 可能有多个 $w$ 与之对应.
例如 $\Arg z,\sqrt[n]z$ 等.
为了方便研究, 我们常常需要对每一个 $z$, 选取固定的一个 $f(z)$ 的值.
这样便得到了这个多值函数的一个\emph{单值分支}.
\begin{example}
  $\arg z$ 是无穷多值函数 $\Arg z$ 的一个单值分支.
\end{example}

在考虑多值的情况下, 复变函数总有反函数.
如果 $f$ 和 $f^{-1}$ 都是单值的, 则称 $f$ 是\emph{一一对应}.
\begin{example}
  $f(z)=z^n$ 的反函数就是 $f^{-1}(w)=\sqrt[n]{w}$.
  {当 $n=\pm1$ 时, $f$ 是一一对应.}
\end{example}
若无特别声明, 本书中\emph{复变函数总是指单值的复变函数}.


\subsection{映照}

大部分复变函数的图像无法在三维空间中表示出来.
为了直观理解和研究, 我们用两个复平面($z$ 复平面和 $w$ 复平面)之间的\emph{映照}来表示这种对应关系,
其中 
\[w=u+iv=u(x,y)+iv(x,y)\]
的实部和虚部是两个二元实变函数.

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \begin{scope}[xshift=-25mm]
      \draw[cstaxis] (-2,0)--(2,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
      \draw
        (2,0) node[above] {$x$}
        (0,1.5) node[left] {$y$}
        (0,-1.5) node[below,main] {$z$ 复平面};
      \draw[cstcurve,main,smooth] plot coordinates {(-1.5,0) (-1.7,-.4) (-.3,-.9) (.5,-.7) (.9,0) (1.1,1) (-.3,1.2) (-.7,1) (-1.5,0)};
      \coordinate (a) at (.5,.8);
      \coordinate (b) at (.5,.5);
      \coordinate (c) at (-.3,.3);
    \end{scope}
    \begin{scope}[xshift=25mm]
      \draw[cstaxis] (-2,0)--(2,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
      \draw
        (2,0) node[above] {$u$}
        (0,1.5) node[left] {$v$}
        (0,-1.5) node[below,second] {$w$ 复平面};
      \draw[cstcurve,smooth,second] plot coordinates {(-1.3,0) (-.5,-.5) (0,-.8) (.5,-.5) (1,0) (1.3,.9) (.8,1.2) (-.5,.8) (-1.3,0)};
      \coordinate (A) at (.3,.7) circle;
      \coordinate (B) at (-.3,-.3) circle;
    \end{scope}
    \draw[cstdash,smooth,third,cstra] (a) to [bend left=25] (A);
    \draw[cstdash,smooth,third,cstra] (b)to [bend right=15] (B);
    \draw[cstdash,smooth,third,cstra] (c) to [bend right=25] (B);
    \fill[cstdot,main] (a) circle;
    \fill[cstdot,main] (b) circle;
    \fill[cstdot,main] (c) circle;
    \fill[cstdot,second] (A) circle;
    \fill[cstdot,second] (B) circle;
  \end{tikzpicture}
  \caption{映照}
\end{figure}

\begin{example}
  函数 $w=\ov z$.
  如果把 $z$ 复平面和 $w$ 复平面重叠放置, 则这个映照对应的是关于 $z$ 轴的翻转变换.
  它把任一区域映成和它全等的区域, 且 $u=x,v=-y$.
\end{example}

\begin{center}
  \begin{tikzpicture}
    \begin{scope}[xshift=-25mm]
      \draw[cstaxis] (-2,0)--(2,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
      \draw
        (2,0) node[above] {$x$}
        (0,1.5) node[left] {$y$}
        (0,-1.5) node[below,main] {$z$ 复平面};
      \draw[cstcurve,main,smooth] plot coordinates {(-1.5,0) (-1.7,-.4) (-.3,-.9) (.5,-.7) (.9,0) (1.1,1) (-.3,1.2) (-.7,1) (-1.5,0)};
      \coordinate (a) at (-1.2,-.3);
      \coordinate (b) at (.6,.9);
      \coordinate (c) at ($.8*(a)+.2*(b)$);
      \coordinate (d) at ($.5*(a)+.5*(b)$);
      \coordinate (e) at ($.2*(a)+.8*(b)$);
      \draw[cstcurve,main] (a)--(b);
    \end{scope}
    \begin{scope}[xshift=25mm]
      \draw[cstaxis] (-2,0)--(2,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
      \draw
        (2,0) node[above] {$u$}
        (0,1.5) node[left] {$v$}
        (0,-1.5) node[below,second] {$w$ 复平面};
      \draw[cstcurve,second,smooth] plot coordinates {(-1.5,0) (-1.7,.4) (-.3,.9) (.5,.7) (.9,0) (1.1,-1) (-.3,-1.2) (-.7,-1) (-1.5,0)};
      \coordinate (A) at (-1.2,.3);
      \coordinate (B) at (.6,-.9);
      \coordinate (C) at ($.8*(A)+.2*(B)$);
      \coordinate (D) at ($.5*(A)+.5*(B)$);
      \coordinate (E) at ($.2*(A)+.8*(B)$);
      \draw[cstcurve,second] (A)--(B);
    \end{scope}
    \draw[cstdash,smooth,third,cstra] (c) to[bend right=15] (C);
    \draw[cstdash,smooth,third,cstra] (d) to[bend right=25] (D);
    \draw[cstdash,smooth,third,cstra] (e) to[bend left=45] (E);
    \fill[cstdot,main] (c) circle;
    \fill[cstdot,main] (d) circle;
    \fill[cstdot,main] (e) circle;
    \fill[cstdot,second] (C) circle;
    \fill[cstdot,second] (D) circle;
    \fill[cstdot,second] (E) circle;
  \end{tikzpicture}
\end{center}

\begin{example}
  函数 $w=az$.
  设 $a=re^{i\theta}$, 则这个映照对应的是一个旋转映照(逆时针旋转 $\theta$)和一个相似映照(放大为 $r$ 倍)的复合.
  它把任一区域映成和它相似的区域.
\end{example}

\begin{center}
  \begin{tikzpicture}
    \begin{scope}[xshift=-25mm]
      \draw[cstaxis] (-2,0)--(2,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
      \draw
        (2,0) node[above] {$x$}
        (0,1.5) node[left] {$y$}
        (0,-1.5) node[below,main] {$z$ 复平面};
      \draw[cstcurve,main,smooth] plot coordinates {(-1.5,0) (-1.7,-.4) (-.3,-.9) (.5,-.7) (.9,0) (1.1,1) (-.3,1.2) (-.7,1) (-1.5,0)};
      \coordinate (a) at (-1.2,-.3);
      \coordinate (b) at (.6,.9);
      \coordinate (c) at ($.8*(a)+.2*(b)$);
      \coordinate (d) at ($.5*(a)+.5*(b)$);
      \coordinate (e) at ($.2*(a)+.8*(b)$);
      \draw[cstcurve,main] (a)--(b);
    \end{scope}
    \begin{scope}[xshift=25mm]
      \draw[cstaxis] (-2,0)--(2,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
      \draw
        (2,0) node[above] {$u$}
        (0,1.5) node[left] {$v$}
        (0,-1.5) node[below,second] {$w$ 复平面};
      \draw[cstcurve,second,smooth,scale=.8,rotate=90] plot coordinates {(-1.5,0) (-1.7,-.4) (-.3,-.9) (.5,-.7) (.9,0) (1.1,1) (-.3,1.2) (-.7,1) (-1.5,0)};
      \coordinate (A) at (.24,-.96);
      \coordinate (B) at (-.72,.48);
      \coordinate (C) at ($.8*(A)+.2*(B)$);
      \coordinate (D) at ($.5*(A)+.5*(B)$);
      \coordinate (E) at ($.2*(A)+.8*(B)$);
      \draw[cstcurve,second] (A)--(B);
    \end{scope}
    \draw[cstdash,smooth,third,cstra] (c) to[bend right=25] (C);
    \draw[cstdash,smooth,third,cstra] (d) to[bend right=10] (D);
    \draw[cstdash,smooth,third,cstra] (e) to[bend left=20] (E);
    \fill[cstdot,main] (c) circle;
    \fill[cstdot,main] (d) circle;
    \fill[cstdot,main] (e) circle;
    \fill[cstdot,second] (C) circle;
    \fill[cstdot,second] (D) circle;
    \fill[cstdot,second] (E) circle;
  \end{tikzpicture}
\end{center}

\begin{example}
  函数 $w=z^2$.
  这个映照把 $z$ 的辐角增大一倍, 因此它会把角形区域变换为角形区域, 并将夹角放大一倍.
  
  由于 $u=x^2-y^2,v=2xy$.
  因此它把 $z$ 复平面上两族分别以直线 $y=\pm x$ 和坐标轴为渐近线的等轴双曲线 $x^2-y^2=c_1,2xy=c_2$分别映射为 $w$ 复平面上的两族平行直线 $u=c_1,v=c_2$.
\end{example}
  
\begin{center}
  \begin{tikzpicture}
    \begin{scope}[xshift=-25mm]
      \draw[cstaxis] (-2,0)--(2,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
      \draw
        (2,0) node[above] {$x$}
        (0,1.5) node[left] {$y$}
        (0,-1.5) node[below,main] {$z$ 复平面};
      \fill[cstfille1] (0,0)--({1.5*cos(37.5)},{1.5*sin(37.5)}) arc(37.5:7.5:1.5)--cycle;
      \draw[cstcurve,main] (0,0)--({1.5*cos(37.5)},{1.5*sin(37.5)});
      \draw[cstcurve,main] (0,0)--({1.5*cos(7.5)},{1.5*sin(7.5)});
      \coordinate (a) at (0,1);
      \coordinate (b) at (.8,1.2);
      \coordinate (c) at (-.6,-.3);
    \end{scope}
    \begin{scope}[xshift=25mm]
      \draw[cstaxis] (-2,0)--(2,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
      \draw
        (2,0) node[above] {$u$}
        (0,1.5) node[left] {$v$}
        (0,-1.5) node[below,second] {$w$ 复平面};
      \fill[cstfille2] (0,0)--({1.8*cos(75)},{1.8*sin(75)}) arc(75:15:1.8)--cycle;
      \draw[cstcurve,second] (0,0)--({1.8*cos(75)},{1.8*sin(75)});
      \draw[cstcurve,second] (0,0)--({1.8*cos(15)},{1.8*sin(15)});
      \coordinate (A) at (-1,0);
      \coordinate (B) at (-.8,1.92);
      \coordinate (C) at (.27,.36);
    \end{scope}
    \draw[cstdash,smooth,third,cstra] (a) to[bend left=10] (A);
    \draw[cstdash,smooth,third,cstra] (b) to[bend left=20] (B);
    \draw[cstdash,smooth,third,cstra] (c) to[bend right=25] (C);
    \fill[cstdot,fill=main] (a) circle;
    \fill[cstdot,fill=main] (b) circle;
    \fill[cstdot,fill=main] (c) circle;
    \fill[cstdot,fill=second] (A) circle;
    \fill[cstdot,fill=second] (B) circle;
    \fill[cstdot,fill=second] (C) circle;
  \end{tikzpicture}
\end{center}

\begin{center}
  \begin{tikzpicture}
    \begin{scope}[xshift=-25mm]
      \draw[cstaxis] (-2,0)--(2,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
      \begin{scope}[cstcurve,main,smooth]
        \draw (-1.2,-1.2)--(1.2,1.2);
        \draw (-1.2,1.2)--(1.2,-1.2);
        \draw[domain=-35:35]
          plot ({sec(\x)},{tan(\x)})
          plot ({-sec(\x)},{tan(\x)})
          plot ({tan(\x)},{sec(\x)})
          plot ({tan(\x)},{-sec(\x)});
        \draw[domain=-46:46]
          plot ({(.8*sec(\x))},{0.8*tan(\x)})
          plot ({(-.8*sec(\x))},{0.8*tan(\x)})
          plot ({0.8*tan(\x)},{0.8*sec(\x)})
          plot ({0.8*tan(\x)},{0.8*-sec(\x)});
        \draw[domain=-57:57]
          plot ({(.6*sec(\x))},{0.6*tan(\x)})
          plot ({(-.6*sec(\x))},{0.6*tan(\x)})
          plot ({0.6*tan(\x)},{0.6*sec(\x)})
          plot ({0.6*tan(\x)},{0.6*-sec(\x)});
        \draw[domain=-68:68]
          plot ({(.4*sec(\x))},{0.4*tan(\x)})
          plot ({(-.4*sec(\x))},{0.4*tan(\x)})
          plot ({0.4*tan(\x)},{0.4*sec(\x)})
          plot ({0.4*tan(\x)},{0.4*-sec(\x)});
      \end{scope}
      \begin{scope}[cstcurve,second,smooth,rotate=45]
        \draw (-1.2,-1.2)--(1.2,1.2);
        \draw (-1.2,1.2)--(1.2,-1.2);
        \draw[domain=-35:35]
          plot ({sec(\x)},{tan(\x)})
          plot ({-sec(\x)},{tan(\x)})
          plot ({tan(\x)},{sec(\x)})
          plot ({tan(\x)},{-sec(\x)});
        \draw[domain=-46:46]
          plot ({(.8*sec(\x))},{0.8*tan(\x)})
          plot ({(-.8*sec(\x))},{0.8*tan(\x)})
          plot ({0.8*tan(\x)},{0.8*sec(\x)})
          plot ({0.8*tan(\x)},{0.8*-sec(\x)});
        \draw[domain=-57:57]
          plot ({(.6*sec(\x))},{0.6*tan(\x)})
          plot ({(-.6*sec(\x))},{0.6*tan(\x)})
          plot ({0.6*tan(\x)},{0.6*sec(\x)})
          plot ({0.6*tan(\x)},{0.6*-sec(\x)});
        \draw[domain=-68:68]
          plot ({(.4*sec(\x))},{0.4*tan(\x)})
          plot ({(-.4*sec(\x))},{0.4*tan(\x)})
          plot ({0.4*tan(\x)},{0.4*sec(\x)})
          plot ({0.4*tan(\x)},{0.4*-sec(\x)});
      \end{scope}
    \end{scope}
    \begin{scope}[xshift=25mm]
      \draw[cstaxis] (-2,0)--(2,0);
      \draw[cstaxis] (0,-1.5)--(0,1.5);
      \begin{scope}[cstcurve,second]
        \draw (-1.3,-1.2)--(1.3,-1.2);
        \draw (-1.3,-0.9)--(1.3,-.9);
        \draw (-1.3,-0.6)--(1.3,-.6);
        \draw (-1.3,-0.3)--(1.3,-.3);
        \draw (-1.3,0)--(1.3,0);
        \draw (-1.3,0.3)--(1.3,.3);
        \draw (-1.3,0.6)--(1.3,.6);
        \draw (-1.3,0.9)--(1.3,.9);
        \draw (-1.3,1.2)--(1.3,1.2);
      \end{scope}
      \begin{scope}[cstcurve,main,rotate=90]
        \draw (-1.3,-1.2)--(1.3,-1.2);
        \draw (-1.3,-0.9)--(1.3,-.9);
        \draw (-1.3,-0.6)--(1.3,-.6);
        \draw (-1.3,-0.3)--(1.3,-.3);
        \draw (-1.3,0)--(1.3,0);
        \draw (-1.3,0.3)--(1.3,.3);
        \draw (-1.3,0.6)--(1.3,.6);
        \draw (-1.3,0.9)--(1.3,.9);
        \draw (-1.3,1.2)--(1.3,1.2);
      \end{scope}
    \end{scope}
  \end{tikzpicture}
\end{center}

\begin{example}
  求下列集合在映照 $w=z^2$ 下的像.
  \begin{enumerate}
    \item 线段 $0<|z|<2,\arg z=\dfrac\pi2$.
    \item 双曲线 $x^2-y^2=4$.
    \item 扇形区域 $0<\arg z<\dfrac\pi4,0<|z|<2$.
  \end{enumerate}
\end{example}
\begin{solution}
  \begin{enumerate}
    \item 设 $z=re^{\frac{\pi i}2}=ir$, 则 $w=z^2=-r^2$.
      因此它的像还是一条线段 $0<|w|<4,\arg w=-\pi$.
    \item 由于
      \[w=u+iv=z^2=(x^2-y^2)+2xyi.\]
      因此 $u=x^2-y^2=4,v=2xy$.
      由于任何复数均存在平方根, 存在 $z=x+yi$ 使得 $f(z)=4+iv$, 其中 $x^2-y^2=4$.
      因此这条双曲线的像的确就是直线 $\Re w=4$.\footnote{在很多教材或习题册中, 往往会忽略检查所给的集合中的每个元素都有原像.}
    \item 设 $z=re^{i\theta}$, 则 $w=r^2e^{2i\theta}$.
      因此它的像是扇形区域 $0<\arg w<\dfrac\pi2,0<|w|<4$.
  \end{enumerate}
\end{solution}

\begin{example}
  求圆周 $|z|=2$ 在映照 $w=\dfrac{z+1}{z-1}$ 下的像.
\end{example}

\begin{solution}
  由于 $z=\dfrac{w+1}{w-1}$, $\abs{\dfrac{w+1}{w-1}}=2$,
  {因此
  \[|w+1|=2|w-1|,\quad w\ov w+w+\ov w+1=4w\ov w-4w-4\ov w+4,\]}
  {
    \[w\ov w-\frac53 w-\frac53\ov w+1=0,\quad \abs{w-\frac53}^2=\dfrac{16}9,\]即 $\abs{w-\dfrac53}=\dfrac43$, 是一个圆周.}
\end{solution}


\section{极限和连续性}

\subsection{无穷远点}

类似于实变函数情形, 我们可以定义复变函数的极限.

\subsubsection{数列极限}
先来看数列极限的定义.

\begin{definition}
  设 $\{z_n\}_{n\ge 1}$ 是一个复数列.
  如果 $\forall \varepsilon>0,\exists N$ 使得当 $n\ge N$ 时 $|z_n-z|<\varepsilon$, 则称 $z$ 是\emph{数列 $\{z_n\}$ 的极限}, 记作 \emph{$\lim\limits_{n\to\infty}z_n=z$}.
\end{definition}

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \fill[cstfille1] (0,0) circle (1.2);
    \filldraw[cstcurve,main,fill=white] (0,0) circle (.5);
    \draw[cstaxis] (-1.5,0)--(1.5,0);
    \draw[cstaxis] (0,-1.5)--(0,1.5);
  \end{tikzpicture}
  \caption{$\infty$ 的(去心)邻域}
\end{figure}

如果 $\forall X>0,\exists N$ 使得当 $n\ge N$ 时 $|z_n|>X$, 则记 \emph{$\lim\limits_{n\to\infty}z_n=\infty$}.
如果称
  \[\Uc(\infty,X)=\{z\in\BC\mid|z|>X\}\]
为 \emph{$\infty$ 的(去心) $X$ 邻域},
那么上述定义可统一表述为:

\begin{definition}
  $\lim\limits_{n\to\infty}z_n=z\in\BC\cup\set\infty$ 是指: 对 $z$ 的任意 $\delta$ 邻域 $U$, $\exists N$ 使得当 $n\ge N$ 时 $z_n\in U$.\footnotemark
\end{definition}
\footnotetext{一般地, 一个点的邻域是指包含它的任意一个开集.
可以说明, 把这里的任意 $\delta$ 邻域换成任意邻域, 并不会改变定义, 因为包含 $z$ 的开集一定包含一个 $z$ 的 $\delta$ 领域.}

\subsubsection{复球面和扩充复平面}
那么有没有一种看法使得 $\infty$ 的邻域和普通复数的邻域没有差异呢?
我们将介绍复球面的概念, 它是复数的一种几何表示且自然包含无穷远点 $\infty$.
这种思想是在黎曼研究多值复变函数时引入的.

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \fill[cstfill1] (-3.65,-.804)--(-1.85,.804)--(3.65,.804)--(1.85,-.804)--cycle;
    \filldraw[cstcurve,cstfill] (0,1) circle (1);
    \draw[cstdash] (0,1) circle (1 and 0.3);
    \draw[cstdash,third] (0,0) circle (2 and 0.6);
    \coordinate [label=above:\textcolor{third}{$N$}] (N) at (0,2);
    \draw[cstdash] (0,0)--(N);
    \draw[cstaxis] (0,0)--(2.5,0);
    \draw[cstaxis] (0,0)--(-.8,-.9);
    \coordinate [label=right:\textcolor{main}{$z_1$}] (z1) at (1.65,-.75);
    \coordinate [label=left:\textcolor{main}{$Z_1$}] (Z1) at (.6,1);
    \coordinate [label=left:\textcolor{second}{$z_2$}] (z2) at (-1,0);
    \coordinate [label=below right:\textcolor{second}{$Z_2$}] (Z2) at (-.7,.6);
    \draw[cstcurve,main,cstra] (N)--(z1);
    \fill[cstdot,main] (Z1) circle;
    \draw[cstcurve,cstra,second] (N)--(z2);
    \fill[cstdot,second] (Z2) circle;
    \fill[cstdot,third] (N) circle;
  \end{tikzpicture}
  \caption{复球面和复平面}
\end{figure}

取一个与复平面相切于原点 $z=0$ 的球面.
过 $O$ 做垂直于复平面的直线, 并与球面相交于另一点 $N$, 称之为北极.
\begin{itemize}
  \item 对于平面上的任意一点 $z$, 连接北极 $N$ 和 $z$ 的直线一定与球面相交于除 $N$ 以外的唯一一个点 $Z$.
  \item 反之, 球面上除了北极外的任意一点 $Z$, 直线 $NZ$ 一定与复平面相交于唯一一点.
\end{itemize}
这样, 球面上除北极外的所有点和全体复数建立了一一对应.

当 $|z|$ 越来越大时, 其对应球面上点也越来越接近 $N$.
如果我们在复平面上添加一个额外的"点"——\emph{无穷远点}, 记作 \emph{$\infty$}.
那么\emph{扩充复数集合 $\BC^*=\BC\cup\set\infty$} 就正好和球面上的点一一对应.
称这样的球面为\emph{复球面}, 称包含无穷远点的复平面为\emph{扩充复平面}或\emph{闭复平面}.

它和实数列极限符号中的 $\infty$ 有什么联系呢?
选取上述图形的一个截面来看, 实轴可以和圆周去掉一点建立一一对应.
于是实数列极限符号中的 $\infty$ 在复球面上就是 $\infty$.

\begin{figure}[hbpt]
  \centering
  \begin{tikzpicture}
    \filldraw[cstcurve,cstfill] (0,1) circle (1);
    \coordinate [label=above:\textcolor{third}{$N$}] (N) at (0,2);
    \draw[cstdash] (0,0)--(N);
    \draw[cstaxis] (-2,0)--(2.5,0);
    \coordinate [label=below:\textcolor{main}{$x_1$}] (x1) at (2.2,0);
    \coordinate [label=above right:\textcolor{main}{$X_1$}] (X1) at (1,1.1);
    \coordinate [label=below:\textcolor{second}{$x_2$}] (x2) at (-1,0);
    \coordinate [label=left:\textcolor{second}{$X_2$}] (X2) at (-.8,.4);
    \draw[cstcurve,cstra,main] (0,2)--(x1);
    \fill[cstdot,main] (X1) circle;
    \draw[cstcurve,cstra,second] (0,2)--(x2);
    \fill[cstdot,second] (X2) circle;
    \fill[cstdot,third] (N) circle;
  \end{tikzpicture}
  \caption{圆周和实轴}
\end{figure}

朴素地看, 复球面上任意一点可以定义 $\delta$ 邻域为与其距离小于 $\delta$ 的所有点.
特别地, $\infty$ 的邻域通过前面所说的对应关系, 可以对应到扩充复平面上 $\infty$ 的一个邻域.
所以在复球面上, 我们将普通复数和 $\infty$ 的邻域可以视为相同的概念.


\subsection{数列的极限}

下述定理保证了我们可以使用实数列的敛散性判定技巧.

\begin{theorem}
  设 $z_n=x_n+y_ni,z=x+yi$, 则
  \[\lim_{n\to\infty}z_n=z\iff \lim_{n\to\infty}x_n=x,\lim_{n\to\infty}y_n=y.\]
\end{theorem}

\begin{proof}
  由三角不等式
  \[|x_n-x|,|y_n-y|\le|z_n-z|\le|x_n-x|+|y_n-y|\]
  易证.
\end{proof}

由此可知极限的四则运算法则对于数列也是成立的.
\begin{theorem}
  设 $\lim\limits_{n\to\infty}z_n=z,\lim\limits_{n\to\infty}w_n=w$, 则
  \begin{enumerate}
    \item $\lim\limits_{n\to\infty}(z_n\pm w_n)=z\pm w$;
    \item $\lim\limits_{n\to\infty} z_nw_n=zw$;
    \item 当 $w\neq 0$ 时, $\lim\limits_{n\to\infty}\dfrac{z_n}{w_n}=\dfrac zw$.
  \end{enumerate}
\end{theorem}

\begin{example}
  设 $z_n=\left(1+\dfrac1n\right)e^{\frac{\pi i}n}$. 数列 $\{z_n\}$ 是否收敛?
\end{example}

\begin{solution}
  由于
  \[x_n=\left(1+\frac1n\right)\cos\frac\pi n\to 1,\quad
  y_n=\left(1+\frac1n\right)\sin\frac\pi n\to 0.\]
  因此 $\{z_n\}$ 收敛且 $\lim\limits_{n\to\infty}z_n=1$.
\end{solution}

\subsection{函数的极限}

\begin{definition}
  设函数 $f(z)$ 在点 $z_0$ 的某个去心邻域内有定义.
  如果存在复数 $A$, 使得对 $A$ 的任意邻域 $U(A,\varepsilon),\exists\delta>0$ 使得
    \[z\in\Uc(z_0,\delta)\implies f(z)\in U(A,\varepsilon),\]
  则称 $A$ 为 \emph{$f(z)$ 当 $z\to z_0$ 时的极限}, 记为 \emph{$\lim\limits_{z\to z_0}f(z)=A$} 或 \emph{$f(z)\to A (z\to z_0)$}.
\end{definition}
此时我们称\emph{极限存在}.

上述定义中的 $z_0$ 和 $A$ 可换成 $\infty$, 从而得到 $z\to\infty$ 的极限定义, 以及 $\lim f(z)=\infty$ 的含义.

不难看出, 复变函数的极限和二元实函数的极限定义是类似的:
即 $z\to z_0$ 沿任一曲线趋向于 $z_0$ 的极限都是相同的.

\begin{theorem}
  设 $f(z)=u(x,y)+iv(x,y),z_0=x_0+y_0i,A=u_0+v_0i$, 则
  \[\lim_{z\to z_0}f(z)=A\iff
  \lim_{\substack{x\to x_0\\y\to y_0}}u(x,y)=u_0,\quad
  \lim_{\substack{x\to x_0\\y\to y_0}}v(x,y)=v_0.\]
\end{theorem}

\begin{proof}
  由三角不等式
  \[|u-u_0|,|v-v_0|\le|f(z)-A|\le|u-u_0|+|v-v_0|\]
  易证.
\end{proof}

由此可知极限的四则运算法则对于复变函数也是成立的.

\begin{theorem}
  设 $\lim\limits_{z\to z_0}f(z)=A,\lim\limits_{z\to z_0}g(z)=B$, 则
  \begin{enumerate}
    \item $\lim\limits_{z\to z_0}(f\pm g)(z)=A\pm B$;
    \item $\lim\limits_{z\to z_0}(fg)(z)=AB$;
    \item 当 $B\neq 0$ 时, $\lim\limits_{z\to z_0}\left(\dfrac fg\right)(z)=\dfrac AB$.
  \end{enumerate}
\end{theorem}

在学习了复变函数的导数后, 我们也可以使用等价无穷小替换、洛必达法则等工具来计算极限.

\begin{example}
  证明: 当 $z\to0$ 时, 函数 $f(z)=\dfrac{\Re z}{|z|}$ 的极限不存在.
\end{example}

\begin{proof}
  令 $z=x+yi$, 则 $f(z)=\dfrac x{\sqrt{x^2+y^2}}$.
  因此
    \[u(x,y)=\frac x{\sqrt{x^2+y^2}},\quad v(x,y)=0.\]
  当 $z$ 在实轴原点两侧分别趋向于 $0$ 时, $u(x,y)\to\pm1$.因此 $\lim\limits_{\substack{x\to 0\\y\to0}}u(x,y)$ 不存在,从而 $\lim\limits_{z\to z_0}f(z)$ 不存在.
\end{proof}


\subsection{函数的连续性}

\begin{definition}
  \begin{itemize}
    \item 如果 $\lim\limits_{z\to z_0}f(z)=f(z_0)$, 则称 $f(z)$ 在 \emph{$z_0$ 处连续}.
    \item 如果 $f(z)$ 在区域 $D$ 内处处连续, 则称 $f(z)$ 在 \emph{$D$ 内连续}.
  \end{itemize}
\end{definition}

根据前面的极限判定定理可知:
\begin{theorem}
  函数 $f(z)=u(x,y)+iv(x,y)$ 在 $z_0=x_0+iy_0$ 处连续当且仅当 $u(x,y)$ 和 $v(x,y)$ 在 $(x_0,y_0)$ 处连续.
\end{theorem}

\begin{example}
  设 $f(z)=\ln(x^2+y^2)+i(x^2-y^2)$.
  $u(x,y)=\ln(x^2+y^2)$ 除原点外处处连续, $v(x,y)=x^2-y^2$ 处处连续.因此 $f(z)$ 在 $z\neq0$ 处连续.
\end{example}

\begin{theorem}
  \begin{itemize}
    \item 在 $z_0$ 处连续的两个函数 $f(z),g(z)$ 之和、差、积、商($g(z_0)\neq 0$) 在 $z_0$ 处仍然连续.
    \item 如果函数 $g(z)$ 在 $z_0$ 处连续, 函数 $f(w)$ 在 $g(z_0)$ 处连续, 则 $f\bigl(g(z)\bigr)$ 在 $z_0$ 处连续.
  \end{itemize}
\end{theorem}

显然 $f(z)=z$ 是处处连续的, 故多项式函数
\[P(z)=a_0+a_1z+a_2z^2+\cdots+a_nz^n\]
也处处连续, 有理函数 $\dfrac{P(z)}{Q(z)}$ 在 $Q(z)$ 的零点以外处处连续.

\begin{example}
  证明: 如果 $f(z)$ 在 $z_0$ 连续, 则 $\ov{f(z)}$ 在 $z_0$ 也连续.
\end{example}

\begin{proof}
  设 $f(z)=u(x,y)+iv(x,y),z_0=x_0+iy_0$.
  那么 $u(x,y),v(x,y)$ 在 $(x_0,y_0)$ 连续.从而 $-v(x,y)$ 也在 $(x_0,y_0)$ 连续.所以 $\ov{f(z)}=u(x,y)-iv(x,y)$ 在 $(x_0,y_0)$ 连续.
\end{proof}
\begin{proof}[另证]
  函数 $g(z)=\ov z=x-iy$ 处处连续,从而 $g\bigl(f(z)\bigr)=\ov{f(z)}$ 在 $z_0$ 处连续.
\end{proof}

可以看出, 在极限和连续性上, 复变函数和两个二元实函数没有什么差别.
那么复变函数和多变量微积分的差异究竟是什么导致的呢?
归根到底就在于 $\BC$ 是一个域, 上面可以做除法.
这就导致了复变函数有\emph{导数}, 而不是像多变量实函数只有偏导数.
这种特性使得可导的复变函数具有整洁优美的性质, 我们将逐步揭开它的神秘面纱.


\sectionHomework
\begin{homework}
  \item 判断题.
    \begin{exlist}
      \item $z$ 是实数当且仅当 $z=\ov z$. \fillbrace{}
      \item $z$ 是纯虚数当且仅当 $z=-\ov z$. \fillbrace{}
      \item $z$ 是实数当且仅当 $\arg z=0,\pi$. \fillbrace{}
      \item $z$ 是纯虚数当且仅当 $\arg z=\pm\dfrac\pi2$. \fillbrace{}
      \item 若 $f(z)$ 在 $z_0$ 处连续, $g(z)$ 在 $z_0$ 处不连续, 则 $(f+g)(z)$ 在 $z_0$ 一定不连续. \fillbrace{}
    \end{exlist}
  \item 选择题.
    \begin{exlist}
      \item 选择合适的选项填入下方的括号中.
      \begin{enumerate}
        \item $|z|=\Re z+1$ 是\fillbrace{}.
        \item $|z+i|=|z-i|$ 是\fillbrace{}.
        \item $\bigl||z+i|-|z-i|\bigr|=1$ 是\fillbrace{}.
        \item $|z|+|z-2i|=2$ 是\fillbrace{}.
        \item $\Re(i\ov z)=3$ 是\fillbrace{}.
        \item $z\ov z-(2+i)z-(2-i)\ov z=4$ 是\fillbrace{}.
        \item $z=1+it,-1\le t\le 1$ 是\fillbrace{}.
        \item $z=i+2e^{i\theta},0\le \theta\le 2\pi$ 是\fillbrace{}.
      \end{enumerate}
        \begin{taskschoice}(4)
          () 直线
          () 圆周
          () 不是圆的椭圆
          () 双曲线
          () 双曲线的一支
          () 抛物线
          () 一个点
          () 一条线段
        \end{taskschoice}
      \item 选择合适的选项填入下方的括号中.
      \begin{enumerate}
        \item $z\ov z-(2+i)z-(2-i)\ov z\le 4$ 是\fillbrace{}.
        \item $-1<\arg z<\pi-1$ 的\fillbrace{}.
        \item $1<|z|<2$ 是\fillbrace{}.
        \item $0<\Re z<1$ 是\fillbrace{}.
        \item $\Im z\le0,\Re z\ge0$ 是\fillbrace{}.
        \item $|z-1|<|z+3|$ 是\fillbrace{}.
        \item $\left|\dfrac{z+1}{z-1}\right|<2$ 是\fillbrace{}.
        \item $\arg z<\dfrac{3\pi}4$ 是\fillbrace{}.
      \end{enumerate}
        \begin{taskschoice}(2)
          () 有界单连通区域
          () 有界多连通区域
          () 无界单连通区域
          () 无界多连通区域
          () 有界单连通闭区域
          () 有界多连通闭区域
          () 无界单连通闭区域
          () 无界多连通闭区域
        \end{taskschoice}
    \end{exlist}
  \item 填空题.
    \begin{exlist}
      \item 如果 $x,y$ 是实数且 $\dfrac{x+1+i(y-3)}{5+3i}=1+i$, 那么 $x+y=$\fillblank{}.
      \item 设 $z=-i$, 则 $1+z+z^2+z^3+z^4=$\fillblank{}.
      \item 化简 $(-1+i)^{10}-(-1-i)^{10}$=\fillblank{}.
      \item 化简 $i^{2022}-(-i)^{2022}=$\fillblank{}.
      \item 化简 $\dfrac{(1+i)^{101}}{(1-i)^{99}}=$\fillblank{}.
      \item $\biggl(\dfrac{(1+i)^2}2\biggr)^{2021}$ 的模是\fillblank{}.
      \item $2^{-i}$ 的辐角主值是\fillblank{}.
      \item $-1-i$ 的辐角主值是\fillblank{}.
      \item $2023-i$ 绕 $0$ 逆时针旋转 $\dfrac\pi2$ 后得到的复数是\fillblank{}.
      \item 区域 $0<\arg z<\dfrac\pi3$ 在映射 $w=z^3$ 下的像是\fillblank[12em]{}.
      \item 已知映射 $w=z^3$, 则 $z=\sqrt3+i$ 在 $w$ 复平面上的像是\fillblank{}.
      \item 极限 $\displaystyle\lim_{z\to1+i}(1+z^2+2z^4)=$\fillblank{}.
    \end{exlist}
  \item 计算题.
    \begin{exlist}
      \item $z_1=-z,z_2=\ov z,z_3=-\ov{z}$ 在复平面上对应的点分别与 $z$ 在复平面上对应的点是什么关系?
      \item 已知点 $z_1,z_2,z_3$ 不共线. 点 $\dfrac12(z_1+z_2)$ 和 $\dfrac13(z_1+z_2+z_3)$ 表示什么点?
      \item 求下列复数 $z$ 的实部与虚部, 共轭复数, 模和辐角主值:
        \begin{tasks}(4)
          \task $\dfrac{5+i}{2+3i}$;
          \task $\dfrac{3i}{1-i}-\dfrac1i$;
          \task $\dfrac{(3+4i)(2-5i)}{2i}$;
          \task $i^8-4i^{21}+i$.
        \end{tasks}
      \item 求下列复数 $z$ 的三角和指数形式:
        \begin{tasks}(4)
          \task $i$;
          \task $1+i\sqrt3$;
          \task $3-\sqrt 3i$;
          \task $\dfrac{2i}{1-i}$;
          \task $\ov{\biggl(\dfrac{4+3i}{1+2i}\biggr)}$;
          \task $\dfrac{3+i}{i}-\dfrac{10i}{3-i}$;
          \task $\dfrac{(\cos \varphi+i\sin \varphi)^5}{(\cos \varphi-i\sin \varphi)^3}$.
        \end{tasks}
      \item 计算
        \begin{tasks}(3)
          \task $(\sqrt3-i)^5$;
          \task $(1+i)^6$;
          \task $\sqrt[3]{-8}$;
          \task $\sqrt[4]{-2+2i}$;
          \task $\sqrt[4]{-2}$;
          \task $(1-i)^{1/3}$.
        \end{tasks}
      \item 用复参数方程表示连接 $-1+i$ 与 $1-4i$ 的直线段.
      \item 用复参数方程表示以 $z_0$ 为圆心, $R$ 为半径的圆周.
      \item 讨论极限 $\displaystyle\lim_{z\to0}\left(\frac{z}{~\ov z~}-\frac{~\ov z~}z\right)$ 是否存在. 若存在请求出具体的值, 若不存在请证明.
      \item 下列数列 $\set{z_n}$ 是否收敛? 如果收敛, 求出它们的极限:
        \begin{tasks}(3)
          \task $z_n=\dfrac{1+ni}{1-ni}$;
          \task $\displaystyle z_n=\left(1+\frac i2\right)^n$;
          \task $z_n=(-1)^n+\dfrac{i}{n+1}$;
          \task $z_n=\dfrac{(3+2i)^n}{(3+4i)^n}$;
          \task $z_n=\biggl(1+\dfrac{(-1)^n}n\biggr)e^{-\frac{n\pi i}2}$.
        \end{tasks}
    \end{exlist}
  \item 证明题.
    \begin{exlist}
      \item 证明: 当 $|z|=1>|w|$ 时, $\left|\dfrac{z-w}{1-z\ov w}\right|=1$.
      \item 证明: 如果复数 $a+ib$ 是实系数方程
      	\[a_0z^n+a_1z^{n-1}+\cdots+a_{n-1}z+a_n=0\]
      	的根, 则 $a-ib$ 也是它的根.
      \item 设 $\dfrac{z_2-z_1}{z_3-z_1}=\dfrac{z_1-z_3}{z_2-z_3}$. 证明: $|z_1-z_2|=|z_2-z_3|=|z_3-z_1|$ 并说明这些等式的几何意义.
      \item 设 $z=e^{it}$, 证明:\begin{tasks}(2)
          \task $z^n+\dfrac1{z^n}=2\cos{nt}$;
          \task $z^n-\dfrac1{z^n}=2i\sin{nt}$.
        \end{tasks}
    \end{exlist}
\end{homework}



\sectionExtraReading

\begin{homework}
  \item 我们知道, 对于任意两个集合 $A,B$, 我们可以定义 $A\to B$ 的映射.
  在数学中, 很多对象是带有``结构''的集合, 例如实线性空间 $V$ 是一个拥有如下结构:
  \begin{center}
    零元 $0\in V$;\qquad 加法 $v_1+v_2\in V$;\qquad 数乘 $\lambda v$,
  \end{center}
  且满足一些特定性质的集合.
  如果 $A,B$ 具有同一种结构, 映射 $f:A\to B$ ``保持''了这些结构, 则我们称 $f$ 是\emph{同态}.	
  例如实线性空间之间的同态就是指一个映射 $f:V\to W$, 使得
  \[f(0)=0;\qquad f(v_1+v_2)=f(v_1)+f(v_2);\qquad f(\lambda v)=\lambda f(v).\]

  再比如域是带有如下结构:
  \begin{center}
    零元 $0$;\qquad 幺元 $1$;\qquad 加法;\qquad 减法;\qquad 乘法;\qquad 除法, 
  \end{center}
  且满足特定性质的集合(交换律分配律之类的). 所以域之间的同态就是指一个 $f:F\to K$, 使得
  \begin{itemize}
    \item $f(0)=0,\quad f(1)=1$;
    \item $f(x+y)=f(x)+f(y),\quad f(x-y)=f(x)-f(y)$;
    \item $f(xy)=f(x)f(y),\quad f(x/y)=f(x)/f(y)$.
  \end{itemize}
  如果一个同态是双射(一一对应), 则称之为\emph{同构}.

  \begin{exlist}
    \item 设 $f:\BQ\to\BQ$ 是有理数域之间的同构, 证明 $f$ 只能是恒等映射.
    \item 设 $f:\BR\to\BR$ 是实数域之间的连续的同构, 证明 $f$ 只能是恒等映射.
    \item 设 $f:\BC\to\BC$ 是复数域之间的连续的同构, 证明 $f$ 只能是恒等映射或复共轭.
    \item 如果 $F=\BR+\BR t$ 是一个真包含 $\BR$ 的域, 证明 $F$ 同构于 $\BC$.
    \item 设
    \[F=\set{\begin{pmatrix}
      x&-y\\y&x\end{pmatrix}: x,y\in\BR}
      =\set{xE+yJ: x,y\in\BR}\subseteq M_2(\BR),\]
    其中 $E=\begin{pmatrix}1& \\&1\end{pmatrix}$,
    $J=\begin{pmatrix}&-1\\1&\end{pmatrix}$.
    证明 $F$ 是一个域且同构于 $\BC$.
    \item 从(5)中可以看出, 复数 $z_0=x_0+y_0i=re^{i\theta}$ 对应的矩阵 $x_0\bfE+y_0\bfJ$ 所对应的线性变换, 将平面向量旋转 $\theta$ 并将模长放缩至 $r$ 倍.
    \end{exlist}
    
    \item 满足 $z^n=1$ 的复数 $z$ 被称为 \emph{$n$ 次单位根}.
    不难看出 $z=e^{\frac{2k\pi i}n},k=0,1,\dots,n-1$.
    单位根在代数, 几何和组合中有着丰富的应用. 我们来看一个例子.
    设集合 $A=\set{1,2,\dots,2026}$.

    \begin{exlist}
      \item 集合 $A$ 有多少个子集? 试着将 $A$ 的每一个子集与
      \[N(x)=\prod_{a=1}^{2026}(1+x^a)\]
      的展开式中的每一项建立一个一一对应.
      \item 设 $S\subseteq A$. 定义
      \[f(S)=\prod_{a\in S}x^a=x^{\sum_{a\in S}a}.\]
      证明所有的 $S$ 对应的 $f(S)$ 之和就是 $N(x)$.
      \item 证明 $N(x)$ 的展开式合并同类项后 $x^k$ 的系数就是 $A$ 的那些满足元素之和是 $k$ 的子集的个数.
      \item 现在我们想知道 $A$ 有多少个子集满足元素之和是 $5$ 的倍数.
    令 $x$ 是 $5$ 次单位根, 则 $N(x)$ 可以表为
    \[N(x)=N_0+N_1x+N_2x^2+N_3x^3+N_4x^4,\]
      那么 $N_0$ 就是元素之和是 $5$ 的倍数的集合个数.
      \item 当 $x=1$ 时, 显然 $N(1)=2^{2026}$.
      当 $x\neq 1$ 是 $5$ 次单位根时, $1,x,x^2,x^3,x^4$ 是方程 $X^5-1=0$ 的所有根, 所以 $2,1+x,1+x^2,1+x^3,1+x^4$ 是方程 $(X-1)^5-1=0$ 的所有根. 由韦达定理可知
      \[(1+x^0)(1+x)(1+x^2)(1+x^3)(1+x^4)=2.\]
      由此证明
      \[N(x)=2^{405}(1+x).\]
      \item 计算 $N(1)+N(e^{2\pi i/5})+N(e^{4\pi i/5})+N(e^{6\pi i/5})+N(e^{8\pi i/5})$. 由此得到 $N_0=\dfrac{2^{2026}-2^{406}}5$.
      \item 想一想, $N_1,N_2,N_3,N_4$ 分别是多少?
    \end{exlist}
    更多细节可见: \url{https://www.bilibili.com/video/BV1R34y1W7Xn/}
\end{homework}


\sectionExerciseAnswer

\exans $-4$.
\exans $1$.
\exans $-\ov z$.
\exans $(x_1x_2-y_1y_2)^2+(x_1y_2+x_2y_1)^2$ 或 $(x_1x_2+y_1y_2)^2+(x_1y_2-x_2y_1)^2$.
\exans $\dfrac{7-4i}5$.

\exans 仅当 $z$ 不是负实数和 $0$ 时它才成立.

\exans $z_1,\dots,z_n$ 中的非零元辐角相等.
\exans $\displaystyle z=2\sqrt3\left(\cos\frac{-\pi}3+i\sin\frac{-\pi}3\right)=2\sqrt3e^{-\frac{\pi i}3}$, 写成 $\dfrac{5\pi}3$ 也可以.

\exans $-2^{2022}$.
\exans $\pm\dfrac{\sqrt3+i}2,\pm i,\pm\dfrac{\sqrt3-i}2$.

\exans 双曲线 $x^2-y^2=\dfrac12$ 和双曲线 $xy=\dfrac14$.
\exans
\begin{enumerate}
	\item 上半平面对应的闭区域为 $\Im z\ge0$.
	\item 下半平面对应的闭区域为 $\Im z\le0$.
	\item 左半平面对应的闭区域为 $\Re z\le0$.
	\item 右半平面对应的闭区域为 $\Re z\ge0$.
	\item 竖直带状区域对应的闭区域为 $x_1\le\Re z\le x_2$.
	\item 水平带状区域对应的闭区域为 $y_1\le\Im z\le y_2$.
	\item 角状区域对应的闭区域为 $\alpha_1\le \arg z\le \alpha_2$ 以及原点. 如果 $\alpha_1=-\pi,\alpha_2=\pi$, 则为 $\BC$.
	\item 圆环域对应的闭区域为 $r\le|z|\le R$.
\end{enumerate}
\exans 整个复平面.

\exans
\begin{enumerate}
	\item $\Re z$ 的定义域为 $\BC$, 值域为 $\BR$.
	\item $\arg z$ 的定义域为 $\{z\in\BC\mid z\neq 0\}$, 值域为 $(-\pi,\pi]$.
	\item $|z|$ 的定义域为 $\BC$, 值域为 $\{x\in\BR\mid x\ge0\}$.
	\item 当 $n>0$ 时, $z^n$ 的定义域为 $\BC$, 值域为 $\BC$.
	当 $n<0$ 时, $z^n$ 的定义域为 $\{z\in\BC\mid z\neq 0\}$, 值域为 $\{z\in\BC\mid z\neq 0\}$.
	\item $\dfrac{z+1}{z^2+1}$ 的定义域为 $\{z\in\BC\mid z\neq \pm i\}$, 值域为 $\BC$.
\end{enumerate}
