\ctexset{
  secnumdepth=4,
  tocdepth=2,
  chapter = {
    name = {第,章},
    number = \chinese{chapter},
    format = \centering\color{main}\huge\bfseries\uuline,
    beforeskip={10pt}
  },
  section = {
    name = {,},
    format = \raggedright\color{main}\Large\bfseries,
    % beforeskip={7ex plus 2ex minus .4ex},
    afterskip={4.6ex plus .4ex},
  },
  subsection = {
    name = {,},
    format = \color{main}\large\bfseries,
    % beforeskip={6.5ex plus 2ex minus .4ex},
    afterskip={3ex plus .4ex},
  },
  subsubsection = {
    name = {,},
    format = \color{main}\bfseries,
    indent=\parindent
  }
}
\renewcommand{\thesubsubsection}{\arabic{subsubsection}.}
\labelformat{chapter}{第\zhnumber{\thechapter}章}
\labelformat{subsubsection}{\thesubsection.#1小节}
\labelformat{equation}{公式 (\theequation) }
\labelformat{figure}{图 \thefigure{} }


\RequirePackage{kvoptions}
\RequirePackage{etoolbox}
\RequirePackage{amsthm}

\RequirePackage[T1]{fontenc}
% \setmainfont{Times New Roman}
% \setCJKsansfont[ItalicFont={KaiTi},BoldFont={LXGW ZhenKai}]{Source Han Sans HW SC}








% \SetupKeyvalOptions{family=ELEGANT, prefix=ELEGANT@, setkeys=\kvsetkeys}
% \newcommand{\ekv}[1]{\kvsetkeys{ELEGANT}{#1}}
% % ----- Colors -----
% \DeclareStringOption[nocolor]{color}
% \DeclareStringOption[answer]{result}
% \DeclareStringOption[fancy]{mode}
% \DeclareStringOption[normal]{device}
% \DeclareStringOption[cm]{math}
% \DeclareStringOption[marginfalse]{marginpar}
% \DeclareStringOption[onecol]{toc}
% \DeclareStringOption{scheme}

% % ----- backward compatibility
% \DeclareVoidOption{nocolor}{\ekv{color=none}}
% \DeclareVoidOption{green}{\ekv{color=green}}
% \DeclareVoidOption{cyan}{\ekv{color=cyan}}
% \DeclareVoidOption{blue}{\ekv{color=blue}}
% \DeclareVoidOption{gray}{\ekv{color=gray}}
% \DeclareVoidOption{black}{\ekv{color=black}}
% \DeclareVoidOption{beamercolor}{\ekv{color=beamercolor}}
% \DeclareVoidOption{doremi}{\ekv{color=doremi}}
% \DeclareVoidOption{madoka}{\ekv{color=madoka}}

% \DeclareVoidOption{chinese}{\ekv{scheme=chinese}}

% \DeclareVoidOption{fancy}{\ekv{mode=fancy}}
% \DeclareVoidOption{simple}{\ekv{mode=simple}}
% \DeclareBoolOption[false]{usesamecnt}

% \DeclareVoidOption{answer}{\ekv{result=answer}}
% \DeclareVoidOption{noanswer}{\ekv{result=noanswer}}

% \DeclareStringOption[numeric-comp]{citestyle}
% \DeclareStringOption[numeric]{bibstyle}

% \DeclareVoidOption{margintrue}{\ekv{marginpar=margintrue}}
% \DeclareVoidOption{marginfalse}{\ekv{marginpar=marginfalse}}

% \DeclareStringOption[biber]{bibend}
% \DeclareVoidOption{biber}{\ekv{bibend=biber}}
% \DeclareVoidOption{bibtex}{\ekv{bibend=bibtex}}


% % ----- Math option -----
% % \newcommand\mailto[1]{\href{mailto:#1}{\nolinkurl{#1}}}

% % ----- Title Style -----
% \DeclareStringOption[hang]{titlestyle}[hang]
% % ----- backward compatibility
% \DeclareVoidOption{hang}{\ekv{titlestyle=hang}}
% \DeclareVoidOption{display}{\ekv{titlestyle=display}}
% % ----- Default Options -----
% \DeclareDefaultOption{\PassOptionsToClass{\CurrentOption}{book}}

% \ProcessKeyvalOptions*\relax
% % \ProcessOptions*\relax
% % \LoadClass[a4paper,oneside]{book}
\RequirePackage{setspace}
\RequirePackage{csquotes}
\RequirePackage{hyperref}
\hypersetup{
  breaklinks,
  unicode,
  linktoc=all,
  bookmarksnumbered=true,
  bookmarksopen=true,
  pdfkeywords={ElegantBook},
  colorlinks,
  linkcolor=second,
  citecolor=second,
  urlcolor=second,
  plainpages=false,
  pdfstartview=FitH,
  pdfborder={0 0 0},
  linktocpage
}
% \newif\ifELEGANT@Hy@later
%   \@ifpackagelater{hyperref}{2022/05/16}
%     {\ELEGANT@Hy@latertrue}
%     {\ELEGANT@Hy@laterfalse}

% %% device settings
\RequirePackage{geometry}
\geometry{
  a4paper,
  % top=25.4mm,
  % bottom=25.4mm,
  % left=20mm,
  % right=30mm,
	% marginparwidth=5cm,
  % marginparsep=5mm,
  % headheight=2.17cm,
  % headsep=4mm,
  % footskip=12mm
}{\relax}


% \RequirePackage{indentfirst,comment}
% % fontsetting
% \ifdefstring{\ELEGANT@math}{mtpro2}{
%   \let\Bbbk\relax
%   \RequirePackage[lite]{mtpro2}
% }{\relax}

% \setcounter{tocdepth}{1}
% \renewcommand{\baselinestretch}{1.2}

% \PassOptionsToPackage{no-math}{fontspec}
% \PassOptionsToPackage{quiet}{fontspec}
% \RequirePackage{iftex}

% \ifpdftex
%   \RequirePackage{newtxtext}
%   \RequirePackage[scaled=.90]{helvet}
% \else
%   \RequirePackage[no-math]{fontspec}
%   \setmainfont{TeXGyreTermesX}[
%     UprightFont = *-Regular ,
%     BoldFont = *-Bold ,
%     ItalicFont = *-Italic ,
%     BoldItalicFont = *-BoldItalic ,
%     Extension = .otf ,
%     Scale = 1.0]
    
%   \setsansfont{texgyreheros}[
%     UprightFont = *-regular ,
%     BoldFont = *-bold ,
%     ItalicFont = *-italic ,
%     BoldItalicFont = *-bolditalic ,
%     Extension = .otf ,
%     Scale = 0.9]
% \fi

%   \ifdefstring{\ELEGANT@chinesefont}{founder}{
%     \setCJKsecondfont[BoldFont={FZHei-B01},ItalicFont={FZKai-Z03}]{FZShuSong-Z01}
%     \setCJKsansfont[BoldFont={FZHei-B01}]{FZKai-Z03}
%     \setCJKmonofont[BoldFont={FZHei-B01}]{FZFangSong-Z02}
%     \setCJKfamilyfont{zhsong}{FZShuSong-Z01}
%     \setCJKfamilyfont{zhhei}{FZHei-B01}
%     \setCJKfamilyfont{zhkai}[BoldFont={FZHei-B01}]{FZKai-Z03}
%     \setCJKfamilyfont{zhfs}[BoldFont={FZHei-B01}]{FZFangSong-Z02}
%     \newcommand*{\songti}{\CJKfamily{zhsong}}
%     \newcommand*{\heiti}{\CJKfamily{zhhei}}
%     \newcommand*{\kaishu}{\CJKfamily{zhkai}}
%     \newcommand*{\fangsong}{\CJKfamily{zhfs}}}{\relax}
  
%   \ifdefstring{\ELEGANT@chinesefont}{nofont}{
%     \xeCJKsetup{AutoFakeBold=true}
%     }{\relax}

%   \ifdefstring{\ELEGANT@chinesefont}{ctexfont}{
%     \xeCJKsetup{AutoFakeBold=true}
%     }{\relax}
  
%   \AfterEndPreamble{
%     \setlength\parindent{2\ccwd}}
\setlength\parindent{2\ccwd}

\ifcsname kaishu\endcsname
  \newcommand{\citshape}{\kaishu}
\else
  \newcommand{\citshape}{\itshape}
\fi
\ifcsname kaishu\endcsname
  \newcommand{\cnormal}{\kaishu}
\else
  \newcommand{\cnormal}{\normalfont}
\fi

\ifcsname fangsong\endcsname
  \newcommand{\cfs}{\fangsong}
\else
  \newcommand{\cfs}{\normalfont}
\fi


% \newcommand{\question}[1]{{\par\citshape #1}\\[0.2ex]}

% \RequirePackage[labelfont={bf,color=main}]{caption} 
\RequirePackage[labelfont={bf}]{caption} 
\captionsetup[table]{skip=3pt,labelsep=space}
\captionsetup[figure]{skip=3pt,labelsep=space}

\AtBeginDocument{
  \setlength{\abovedisplayskip}{3pt}
  \setlength{\belowdisplayskip}{3pt}
  \RequirePackage[flushmargin,stable]{footmisc}
  \setlength{\footnotesep}{12pt}
}



\RequirePackage{graphicx}
%\RequirePackage{enumerate}
\RequirePackage{amsmath,mathrsfs,amsfonts,amssymb}
% \providecommand\qed{}
% \renewcommand{\qed}{\hfill\ensuremath{\square}}
\RequirePackage{booktabs}
\RequirePackage{multicol,multirow}

\RequirePackage{fancyvrb}
\RequirePackage{makecell,lipsum,hologo}

%%中文结构名字


% %%   章节设置
% \RequirePackage[center,pagestyles]{titlesec}
% \RequirePackage[title,titletoc,header]{appendix}


% \RequirePackage[
%   backend=\ELEGANT@bibend,
%   citestyle=\ELEGANT@citestyle,
%   bibstyle=\ELEGANT@bibstyle
% ]{biblatex}

\renewcommand{\baselinestretch}{1.3}
\renewcommand{\contentsname}{目录}
\renewcommand{\tablename}{表}
\renewcommand{\partname}{\color{main}}
\renewcommand{\thepart}{第\zhnumber{\arabic{part}}部分}
\renewcommand{\listfigurename}{插图目录}
\renewcommand{\listtablename}{表格目录}
\renewcommand{\bibname}{参考文献}
\newcommand{\ebibname}{参考文献}
\renewcommand{\appendixname}{附录}
% \renewcommand{\appendixtocname}{附录}
\renewcommand{\indexname}{索\hspace{2em}引}
\newcommand{\authorname}{\citshape 作者：}
\newcommand{\institutename}{\citshape 组织：}
\newcommand{\datename}{\citshape 时间：}
\newcommand{\introductionname}{内容提要}
\newcommand\bioinfo[2]{\gdef\@bioinfo{{\citshape #1}：#2}}
\newcommand{\updatename}{更新：}
\newcommand{\historyname}{版本更新历史}
\newcommand{\beforechap}{第}
\newcommand{\afterchap}{章}


% \graphicspath{{./figure/}{./figures/}{./image/}{./images/}{./graphics/}{./graphic/}{./pictures/}{./picture/}}

% \RequirePackage{tikz} %% load tikz without tikz
% \usetikzlibrary{backgrounds,calc,shadows,positioning,fit}
% \newcommand*\circled[1]{\tikz[baseline=(char.base)]{
%             \node[shape=circle,draw,inner sep=1pt] (char) {#1};}}
% %  https://tex.stackexchange.com/questions/7032/good-way-to-make-textcircled-numbers

% \RequirePackage{apptools}

\RequirePackage[inline]{enumitem}

\setlist[itemize,1]{label={\textcolor{main}{$\bullet$}}}
\setlist[itemize,2]{label={\textcolor{main}{$\bullet$}}}
\setlist[itemize,3]{label={\textcolor{main}{$\bullet$}}}
\setlist[enumerate]{format=\upshape\textcolor{main}}
\setlist[enumerate,1]{label=\color{main}{(\arabic*)}}
\setlist[enumerate,2]{label=\color{main}(\alph*).}
\setlist[enumerate,3]{label=\color{main}\Roman*.}
\setlist[enumerate,4]{label=\color{main}\Alph*.}
\newlist{homework}{enumerate}{1}
\setlist[homework,1]{label={\zhnum*、\hspace*{-\labelsep}}}
\newlist{exlist}{enumerate}{3}
\setlist[exlist,1]{label=\color{main}{\arabic*.},leftmargin=0em}
\setlist[exlist,2]{label=\color{main}{(\roman*)}}
\setlist[exlist,3]{label=\color{main}{(\Roman*)}}

\newcommand{\delspace}{\hspace{-1.5em}}
% 枚举环境
\newcommand{\setenumtype}[1]{
	\ifstrequal{#1}{(1)}{%
		\renewcommand{\theenumi}{{\upshape\textcolor{main}{(\arabic{enumi})}}}
	}{}
	\ifstrequal{#1}{(i)}{%
		\renewcommand{\theenumi}{{\upshape\textcolor{main}{(\roman{enumi})}}}
	}{}
	\ifstrequal{#1}{1.}{%
		\renewcommand{\theenumi}{{\upshape\textcolor{main}{\arabic{enumi}.~}}}
	}{}
	\ifstrequal{#1}{A.}{%
		\renewcommand{\theenumi}{{\upshape\textcolor{main}{\Alph{enumi}.~}}}
	}{}
  \setcounter{enumi}{0}%
}
% 分段枚举环境
\newenvironment{enumpar}[1][(1)]{%
	\setenumtype{#1}\renewcommand{\item}{%
		\par%
	\refstepcounter{enumi}\theenumi{ }}}%
{\ignorespacesafterend}
% 首项不分段枚举环境
\newenvironment{enumnopar}[1][(1)]{%
	\setenumtype{#1}\renewcommand{\item}{%
    \ifnum\value{enumi}=0\else\par\fi%
  \refstepcounter{enumi}\theenumi { }}}%
{\ignorespacesafterend}
% 不分段枚举环境
\NewDocumentEnvironment{enuminline}{O{(1)} O{1em}}{%
	\setenumtype{#1}\renewcommand{\item}{%
	\ifnum\value{enumi}=0\else\hspace{#2}\fi%
	\refstepcounter{enumi}\theenumi { }}}%
{\ignorespacesafterend}
% 不分段固定宽度
% \newlength{\fullwidth}
% \newlength{\enumlistwidth}
% \newcounter{enumlisttype}
% \NewDocumentEnvironment{enumlist}{O{1} O{(1)}}{%
%   \setlength{\fullwidth}{\linewidth}%
%   \addtolength{\fullwidth}{-\leftmargin}%
%   \addtolength{\fullwidth}{-5em}%
%   \ifnum#1=1\setlength{\enumlistwidth}{\fullwidth}\fi%
%   \ifnum#1=2\setlength{\enumlistwidth}{.5\fullwidth}\fi%
%   \ifnum#1=3\setlength{\enumlistwidth}{.333\fullwidth}\fi%
%   \ifnum#1=4\setlength{\enumlistwidth}{.25\fullwidth}\fi%
%   \ifnum#1=5\setlength{\enumlistwidth}{.2\fullwidth}\fi%
%   \setenumtype{#2}
%   \setcounter{enumlisttype}{0}%
%   \renewcommand{\item}[1]{%
%     \ifnum\value{enumlisttype}=#1\setcounter{enumlisttype}{0}\fi%
%     \ifnum\value{enumlisttype}=0\par\fi%
%     \refstepcounter{enumlisttype}
%     \refstepcounter{enumi}
%     \makebox[\enumlistwidth][l]{\makebox[1.5em][r]{\theenumi} ##1}%
%   }
% }{\ignorespacesafterend}



% % 首项不分段枚举环境
\newenvironment{itemnopar}[1][$\bullet$]{%
	\renewcommand{\item}{\par\hspace*{1em}{\upshape\textcolor{main}{#1}} { }}}%
{\ignorespacesafterend}


\RequirePackage{tasks}
\settasks{%
	label={\upshape\textcolor{main}{(\roman*)}},%
	label-width=1.5em,%
	before-skip={0pt},%
	after-skip={0pt}%
}
\NewTasksEnvironment[
  label-width=1.5em,
  item-indent=4em
]{tasksexam}[\item]
\NewTasksEnvironment[
  label-width=1.5em,
  item-indent=2em
]{tasksexer}[\item]
\NewTasksEnvironment[
  label={\upshape{(\Alph*)}},
  label-width=1.5em,
  item-indent=2em
]{taskschoice}[\item]
\NewTasksEnvironment[
  label={\arabic*.},
  label-width=1.5em
]{tasksans}[\item]



\RequirePackage{bbding}


\RequirePackage[many]{tcolorbox}
\tcbset{
  common/.style={
    lower separated=false,
    coltitle=white,
    colback=white,
    boxrule=0pt,
    fonttitle=\bfseries,
    enhanced,
    left=1mm,right=1mm,bottom=1mm,top=2mm,
    before skip=2mm minus 1mm,
    after skip=2mm minus 1mm,
    attach boxed title to top left={
      yshift=-0.11in, xshift=0.15in
    },
    boxed title style={
      boxrule=0pt, arc=0pt, outer arc=0pt
    },
    before upper={\parindent2em\vspace{.2\baselineskip}}
  },
  indent/.style={
    before upper={\parindent2em}
  },
  noindent/.style={
    before upper={\vspace{.2\baselineskip}}
  },
  parttitle/.style={
    mainstyle,
    left=1em,
    bottom=1ex,
    fonttitle=\large,
    attach boxed title to top center={
      yshift=-10pt, xshift=0pt
    }
  },
  sectiontitle/.style={
    thirdstyle,
    left=-0.5em, top=4ex,
    bottom=1ex,
    fonttitle=\large,
    attach boxed title to top center={
      yshift=-10pt, xshift=0pt
    }
  },
  mainstyle/.style={
    common,
    % borderline={0pt}{0pt}{main,cstdash},
    colbacktitle=main,
    colback=main!5,
    borderline={0pt}{0pt}{main},
  },
  secondstyle/.style={
    common,
    borderline={0pt}{0pt}{second,cstdash},
    colbacktitle=second
  },
  thirdstyle/.style={
    common,
    borderline={0pt}{0pt}{third,cstdash},
    colbacktitle=third
  },
  fourthstyle/.style={
    common,
    borderline={0pt}{0pt}{fourth,cstdash},
    colbacktitle=fourth
  },
  fifthstyle/.style={
    common,
    borderline={0pt}{0pt}{fifth,cstdash},
    colbacktitle=fifth
  }
}





% @ means notitle, * means indent
\RequirePackage{xparse}
\newenvironment{main}[1]{\begin{tcolorbox}[mainstyle,fontupper=\citshape,title=\bfseries{#1},noindent]}{\end{tcolorbox}}
\newenvironment{main@}{\begin{tcolorbox}[mainstyle,fontupper=\citshape,notitle]}{\end{tcolorbox}}

% 环境
\newcommand{\envskip}{\hskip 1em plus 1em minus .5em}
% \renewenvironment{main}[1]%
% 	{%
% 		\vspace*{.25\baselineskip}
% 		\par\textcolor{main}{\bf #1}\envskip
% 	}{%
% 		\par\ignorespacesafterend\vspace{.2\baselineskip}
% 	}

\newcounter{thm}[chapter]
\setcounter{thm}{0}
\renewcommand{\thethm}{\thechapter.\arabic{thm}}
\NewDocumentEnvironment{theorem}{o}{
  \refstepcounter{thm}
  \begin{main}{定理 \thethm \IfNoValueTF{#1}{}{~(#1)}}}{\end{main}
}
\NewDocumentEnvironment{proposition}{o}{
  \refstepcounter{thm}
  \begin{main}{命题 \thethm \IfNoValueTF{#1}{}{~(#1)}}}{\end{main}}
\NewDocumentEnvironment{corollary}{o}{
  \refstepcounter{thm}
  \begin{main}{推论 \thethm \IfNoValueTF{#1}{}{~(#1)}}}{\end{main}}
\NewDocumentEnvironment{lemma}{o}{
  \refstepcounter{thm}
  \begin{main}{引理 \thethm \IfNoValueTF{#1}{}{~(#1)}}}{\end{main}}

\newcounter{def}[chapter]
\setcounter{def}{0}
\renewcommand{\thedef}{\thechapter.\arabic{def}}
\NewDocumentEnvironment{definition}{o}{
  \refstepcounter{def}
  \begin{main}{定义 \thedef \IfNoValueTF{#1}{}{~(#1)}}}{\end{main}}

\NewDocumentEnvironment{conjecture}{o}{
  \refstepcounter{thm}
  \begin{fifth}{猜想 \thethm \IfNoValueTF{#1}{}{~(#1)}}}{\end{fifth}}

%% Example with counter
\newcounter{exam}[chapter]
\setcounter{exam}{0}
\renewcommand{\theexam}{\thechapter.\arabic{exam}}
\NewDocumentEnvironment{example}{o}{
  \refstepcounter{exam}\par
  \textbf{\color{main}例 \theexam}\envskip}{
    \par\ignorespacesafterend\vspace{.2\baselineskip}}

%% Exercise with counter
\newcounter{exer}[chapter]
\setcounter{exer}{0}
\renewcommand{\theexer}{\thechapter.\arabic{exer}}
\newenvironment{exercise}[1][]{
  \refstepcounter{exer}\par%
  \makebox[-3pt][r]{\scriptsize\color{third}\HandPencilLeft\quad}
  \label{exer:\theexer}
  \textbf{\color{third}练习 \theexer}\envskip}{
    \par\ignorespacesafterend}
\newcommand\exans{
  \refstepcounter{exer}
  \par\noindent
  \textbf{\color{main}\ref{exer:\theexer}}
}

%% Problem with counter
\newcounter{prob}[chapter]
\setcounter{prob}{0}
\renewcommand{\theprob}{\thechapter.\arabic{prob}}
\newenvironment{problem}[1][]{
  \refstepcounter{prob}
  \par\noindent\textbf{\color{second}{作~~业} \theprob #1 }\rmfamily}{
  \par\ignorespacesafterend}

\newenvironment{solution}[1][解]{\par\textbf{\color{main}#1~~} \citshape}{\par}
\renewenvironment{proof}[1][证明]{\par\textbf{\color{main}#1~~} \citshape}{\par}

\newenvironment{remark}{\vspace*{5pt}\noindent\textbf{\color{third}注}}{\vspace*{5pt}\par}

\newlength{\storedtextwidth}
\newlength{\storedhoffset}
\newenvironment{introduction}{
	\setlength{\storedtextwidth}{\textwidth}%
	\setlength{\storedhoffset}{\hoffset+\oddsidemargin}%
  \begin{tcolorbox}[
    enhanced,
    breakable,
    colback=main,
    colupper=white,
    boxrule=0pt,
    boxsep=0pt,
    top=\baselineskip,
    bottom=\baselineskip,
    left=0pt,
    before skip=8pt,
    sharp corners,
    notitle,
    indent,
    grow sidewards by=.3\storedtextwidth,
  ]
    \centering
    \begin{minipage}{\storedtextwidth}\parindent=2em
      }{
    \end{minipage}
  \end{tcolorbox}
}


\renewenvironment{introduction}{}{}



\newcommand{\section@}[1]{
  \newpage
  \begin{center}
    \phantomsection\addcontentsline{toc}{section}{#1}
    \markright{#1}
    \textcolor{main}{\Large\bfseries~#1~}
  \end{center}
}
\newcommand{\sectionHomework}{\section@{作业}}
% \newenvironment{ExtraReading}{
%   \section{扩展阅读\optional}
  % \setcounter{subsection}{0}
  % \renewcommand{\thesubsection}{\Alph{subsection}.}
% }{
  % \renewcommand{\thesubsection}{\arabic{chapter}.\arabic{section}.\arabic{subsection}}
% }
% \newcommand{\sectionExerciseAnswer}{
%   \setcounter{exer}{0}
%   \section@{练习答案}
%   \hypersetup{linkcolor=fifth}
% }


% \newenvironment{answer}[1][答案]{
%   \chapter{#1}
%   \begin{homeworklist}}{
%   \end{homeworklist}}

% % \newenvironment{exerciseset}{
% %   \vspace*{10pt}
% %   \par\indent\makebox[-3pt][r]{
% %   \large\color{fourth}\HandPencilLeft\quad}
% %   \textbf{\color{second}{\Large\bfseries练习}}\rmfamily
% %   \begin{exenum}}{
% %   \end{exenum}}

% % \newcommand{\subexs}[1][1]{\vskip1ex\par%
% %   \setcounter{subexperiod}{#1}%
% %   \noindent{\color{green!60!black}{\kaishu 作业~\theexercise. }}}
% % \newcounter{subexnum}[enumii]
% % \newcounter{subexcount}[enumii]
% % \newcounter{subexperiod}[enumii]
% % \newcommand{\setsubex}[1][4]{\setcounter{subexperiod}{#1}}
% % \newcommand{\subex}[1]{%
% % 	\stepcounter{subexnum}%
% % 	\ifnum\value{subexperiod}>4%
% % 		\setcounter{subexperiod}{5}
% % 	\fi%
% % 	\ifnum\value{subexperiod}>1%
% % 		\ifnum\value{subexcount}=0\par\fi%
% % 		\ifnum\value{subexperiod}=2\makebox[0.44\linewidth][l]{\textcolor{main}{(\thesubexnum)} #1}\fi%
% % 		\ifnum\value{subexperiod}=3\makebox[0.29\linewidth][l]{\textcolor{main}{(\thesubexnum)} #1}\fi%
% % 		\ifnum\value{subexperiod}=4\makebox[0.21\linewidth][l]{\textcolor{main}{(\thesubexnum)} #1}\fi%
% % 		\ifnum\value{subexperiod}>4\makebox[0.16\linewidth][l]{\textcolor{main}{(\thesubexnum)} #1}\fi%
% % 		\stepcounter{subexcount}%
% % 		\ifnum\value{subexperiod}=\value{subexcount}\setcounter{subexcount}{0}\fi%
% % 	\else%
% % 		\ifnum\value{subexperiod}=1%
% % 			\par\textcolor{main}{(\thesubexnum)} #1%
% % 		\else
% % 			\textcolor{main}{(\thesubexnum)} #1\relax%
% % 		\fi
% % 	\fi%
% % }

% \def\relsec{\endgroup start}
% \def\endrelsec{end\begingroup\def \@currenvir {relsec}}

% %页眉页脚
% \RequirePackage{fancyhdr}
% \fancyhf{}


% \fancyfoot[c]{\color{main}\small\thepage}
% \if@twoside
%   \fancyhead[EL]{\color{main}\cnormal\leftmark}
%   \fancyhead[OR]{\color{main}\cnormal\rightmark}
% \else
%   \fancyhead[R]{\color{main}\cnormal\rightmark}
% \fi

% \renewcommand{\headrule}{\color{main}\hrule width\textwidth}
% \pagestyle{fancy}
% \renewcommand{\headrulewidth}{1pt}
% % \renewcommand{\headrule}{}
% \fancypagestyle{plain}{\renewcommand{\headrulewidth}{0pt}\fancyhf{}\renewcommand{\headrule}{}}
% \renewcommand{\sectionmark}[1]{\markright{\thesection\, #1}{}}


\global\let\@title\@empty
\global\let\@author\@empty
% \global\let\@date\@empty
\newcommand{\subtitle}[1]{\gdef\@subtitle{#1}}
% \newcommand{\institute}[1]{\gdef\@institute{#1}}
% \newcommand{\version}[1]{\gdef\@version{#1}}
% \newcommand{\extrainfo}[1]{\gdef\@extrainfo{#1}}

% \RequirePackage{mwe}
% \newcommand{\logo}[1]{\gdef\@logo{#1}}
% \newcommand{\cover}[1]{\gdef\@cover{#1}}


\renewcommand*{\maketitle}{%
\hypersetup{pageanchor=false}
\pagenumbering{Alph}
\begin{titlepage}
  \newgeometry{margin = 0in}
  \parindent=0pt
  \setlength{\fboxsep}{0pt}
  \colorbox{main!50!white}{\makebox[\linewidth][c]{\shortstack[c]{\vspace{.5\linewidth}}}}
  \begin{tikzpicture}[overlay,xshift=.5\linewidth,yshift=.25\linewidth]
    \begin{scope}[scale=2]
      \fill[cstcurve,cstfill1] (0,0) circle(2.5 and 1.5);
      \fill[cstcurve,white] (1,0) circle(0.6);
      \fill[cstcurve,white] (-1,0) circle(0.6);
  
      \draw[cstcurve,main,domain=0:90,cstwra] plot ({2.5*cos(\x)}, {1.5*sin(\x)});
      \draw[cstcurve,main,domain=85:180] plot ({2.5*cos(\x)}, {1.5*sin(\x)});
      \draw[cstcurve,second,domain=180:270,cstwra] plot ({2.5*cos(\x)}, {1.5*sin(\x)});
      \draw[cstcurve,second,domain=265:360] plot ({2.5*cos(\x)}, {1.5*sin(\x)});
  
      \draw[cstcurve,main,domain=0:140] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});
      \draw[cstcurve,main,domain=135:180,cstwla] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});
      \draw[cstcurve,second,domain=180:320] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});
      \draw[cstcurve,second,domain=315:360,cstwla] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});
  
      \draw[cstcurve,main,domain=0:140] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});
      \draw[cstcurve,main,domain=135:180,cstwla] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});
      \draw[cstcurve,second,domain=180:320] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});
      \draw[cstcurve,second,domain=315:360,cstwla] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});
  
      \draw
        (2,1.3) node[main] {$C_0$}
        (-1,0.85) node[main] {$C_1^-$}
        (1,0.85) node[main] {$C_2^-$}
        (-2,-0.3) node {$\gamma_1$}
        (0,-0.3) node {$\gamma_2$}
        (2,-0.3) node {$\gamma_3$};
      \draw[cstcurve] (-2.5,0)--(-1.6,0);
      \draw[cstcurve] (-0.4,0)--(0.4,0);
      \draw[cstcurve] (1.6,0)--(2.5,0);
      \draw[cstcurve,thick,main] (-2.5,0.025)--(-1.6,0.025);
      \draw[cstcurve,thick,second] (-2.5,-0.025)--(-1.6,-0.025);
      \draw[cstcurve,thick,main] (-0.4,0.025)--(0.4,0.025);
      \draw[cstcurve,thick,second] (-0.4,-0.025)--(0.4,-0.025);
      \draw[cstcurve,thick,main] (1.6,0.025)--(2.5,0.025);
      \draw[cstcurve,thick,second] (1.6,-0.025)--(2.5,-0.025);
    \end{scope}
  \end{tikzpicture}
  \vfill
  \vskip-2ex
  \hspace{2em}
  \begin{flushright}
    \parbox{0.8\textwidth}{
      \bfseries{\fontsize{50}{60}\selectfont \color{main}
        \ifcsname @title\endcsname \@title \fi
      \par}}
  \end{flushright}
  \vfill
  \vspace{-1.0cm}
  \setstretch{2.5}
  \hspace{2.5em}
  \begin{minipage}[c]{0.67\linewidth}
    {\color{main}\bfseries\Large
      \ifcsname @subtitle\endcsname\@subtitle\\[2ex]\fi}
    \color{main}\normalsize
    {\renewcommand{\arraystretch}{0.618}
    \begin{tabular}{l}
      % \ifcsname @author\endcsname \authorname \@author\\\fi
      \ifx\@author\empty\else\authorname\cnormal\@author\\ \fi\color{second}
      \ifcsname @institute\endcsname \institutename \cnormal\@institute\\ \fi\color{third}
      % \ifcsname @date\endcsname  \@date\\\fi
      \ifx\@date\empty\else\datename\cnormal\@date \\ \fi\color{fourth}
      % \ifcsname @version\endcsname \cnormal\versionname\@version\\ \fi
      \ifcsname @bioinfo\endcsname \cnormal\@bioinfo\\ \fi
    \end{tabular}}
  \end{minipage}
  % \begin{minipage}[c]{0.27\linewidth}
  % \begin{tikzpicture}[remember picture,overlay]
  %   \begin{pgfonlayer}{background}
  %     \node[opacity=0.8,
  %           anchor=south east,
  %           outer sep=0pt,
  %           inner sep=0pt] at ($(current page.south east) +(-0.8in,2.5in)$) {
  %             \ifcsname @logo\endcsname\includegraphics[width=4.2cm]{\@logo}\fi};
  %   \end{pgfonlayer}
  % \end{tikzpicture}
  % \end{minipage}
  \vfill
  \begin{center}
    \setstretch{1.3}
    \parbox[t]{0.7\textwidth}{\centering \citshape 
      \ifcsname @extrainfo\endcsname\@extrainfo\fi}
  \end{center}
  \vfill
\end{titlepage}
\restoregeometry
\thispagestyle{empty}}



\renewcommand*{\maketitle}{%
  \hypersetup{pageanchor=false}
  \begin{titlepage}
    \pagecolor{yellow!5}
    \centering
    \newgeometry{margin = 0in}
    \begin{minipage}[c][.3\linewidth][c]{\linewidth}
      \centering
      \vspace{7ex}
      \LARGE
      {
        \kaishu
        \ifcsname @subtitle\endcsname
          \@subtitle\par
        \fi
      }
      \vspace{3ex}
      {
        \bfseries\fontsize{30}{40}\selectfont\color{main}
        \ifcsname @title\endcsname
          \@title\par
        \fi
      }
      \vspace{5ex}
      {
        \fangsong
        \ifcsname @author\endcsname
          \@author\par
        \fi
      }
    \end{minipage}
    \vspace{20ex}
    \begin{tcolorbox}[
      enhanced,
      breakable,
      colback=green!30,
      colupper=white,
      boxrule=0pt,
      boxsep=0pt,
      top=\baselineskip,
      bottom=\baselineskip,
      left=0pt,
      height=.85\linewidth,
      before skip=0pt,
      sharp corners,
      notitle
    ]
    \centering
    \vspace{5ex}
    \includegraphics[width=.7\linewidth]{cover.png}
    \end{tcolorbox}
    合肥工业大学
  \end{titlepage}
  \newpage\nopagecolor
  \thispagestyle{empty}
  \newpage
}{\relax}






% \newcommand{\dollar}{\mbox{\textdollar}}

% \RequirePackage{listings}
% \renewcommand{\ttdefault}{cmtt}
% \lstdefinestyle{mystyle}{
%   basicstyle=%
%     \ttfamily
%     \lst@ifdisplaystyle\small\fi
% }

% \lstset{basicstyle=\ttfamily,style=mystyle,breaklines=true}

% \definecolor{lightgrey}{rgb}{0.9,0.9,0.9}
% \definecolor{frenchplum}{RGB}{190,20,83}
% \lstset{language=[LaTeX]TeX,
%   texcsstyle=*\color{second},
%   numbers=none,
%   mathescape=false,
%   breaklines=true,
%   keywordstyle=\color{second},
%   commentstyle=\color{gray},
%   emph={elegantpaper,fontenc,fontspec,xeCJK,citestyle,FiraMono,xunicode,figure,fig,image,img,table,itemize,enumerate,ctex,microtype,description,times,booktabs,tabular,PDFLaTeX,XeLaTeX,type1cm,BibTeX,device,color,mode,lang,amsthm,tcolorbox,titlestyle,cite,ctex,listings,base,math,scheme,toc,esint,chinesefont,amsmath,bibstyle,natbib,pgfornament,addbibresource,printbibliography},
%   emphstyle={\color{frenchplum}},
%   morekeywords={DeclareSymbolFont,SetSymbolFont,toprule,midrule,bottomrule,institute,version,includegraphics,setmainfont,setsansfont,setmonofont ,setCJKsecondfont,setCJKsansfont,setCJKmonofont,RequirePackage,figref,tabref,email,maketitle,keywords,definecolor,extrainfo,logo,cover,subtitle,appendix,chapter,section,hypersetup,secondmatter,frontmatter,tableofcontents,elegantpar,heiti,kaishu,lstset,pagecolor,zhnumber,marginpar,part,equote,marginnote,bioinfo,datechange,listofchange,lvert,lastpage,songti,heiti,fangsong,setCJKfamilyfont,textbf,elegantnewtheorem,thmcnt,colorlet,usesamecnt},
%   frame=single,
%   tabsize=2,
%   rulecolor=\color{main},
%   framerule=0.2pt,
%   columns=flexible,
%   % backgroundcolor=\color{lightgrey}
% }

% \newcommand\bmmax{0}
% \RequirePackage{bm}

% % add the list of change history
% \newcommand{\dateinfoline}[2]{
%   \noindent\makebox[0pt][r]{%
%   \makebox[-3em][r]{%
%     \small
%     \textbf{\textcolor{main}{#1}}}\;\;}%
%   {\citshape\updatename\ignorespaces#2}}

% \newcommand{\datechange}[2]{%
%   \noindent{\makebox[\textwidth][r]{\color{main}\rule{1.15\textwidth}{.4pt}}}
%   \dateinfoline{#1}{#2}
%   \addcontentsline{dates}{section}{#1 -- #2}}

% \newcommand{\listofchanges}{%
%   \begingroup
%     \renewcommand{\contentsname}{\historyname}
%     \let\old@starttoc\@starttoc
%     \def\@starttoc##1{
%       \old@starttoc{dates}}
%     \tableofcontents%
%   \endgroup}
% % https://tex.stackexchange.com/questions/472931/list-of-all-dates-in-a-document

% \newenvironment{change}{
%   \begin{enumerate}[label=\small\protect\circled{\arabic*}]}{
%   \end{enumerate}}

% % \renewcommand\tableofcontents{%
% %   \hypersetup{linktoc=all, linkcolor=main}
% %     \if@twocolumn
% %       \@restonecoltrue\onecolumn
% %     \else
% %       \@restonecolfalse
% %     \fi
% %     \chapter*{\contentsname
% %         \@mkboth{%
% %            \MakeUppercase\contentsname}{\MakeUppercase\contentsname}}%
% %     \ifdefstring{\ELEGANT@toc}{twocol}{
% %       \setlength{\columnsep}{2em}
% %       \begin{multicols}{2}%
% %         \@starttoc{toc}
% %       \end{multicols}}{
% %       \@starttoc{toc}}
% %     \if@restonecol\twocolumn\fi
% %     \hypersetup{linkcolor=fourth}}


% \renewcommand*{\cleardoublepage}{\clearpage\if@twoside \ifodd\c@page\else
% \hbox{}%
% \thispagestyle{empty}%
% \newpage%
% \if@twocolumn\hbox{}\newpage\fi\fi\fi}

% \RequirePackage{calc}
% \RequirePackage[titles]{tocloft}
% % \ifdefstring{\ELEGANT@lang}{cn}{
%   % \renewcommand{\cftchappresnum}{\beforechap\space}
%   % \renewcommand{\cftchapaftersnum}{\space\afterchap}
%   % \setlength{\cftchapnumwidth}{\widthof{\textbf{附录~十一}}}
% %   \renewcommand{\numberline}[1]{%
% %   \@cftbsnum #1\@cftasnum~\@cftasnumb ~%
% %   }
% %   \g@addto@macro\appendix{%
% %     \ifELEGANT@Hy@later
% %       \patchcmd{\NR@chapter}%
% %         {\numberline{\xchaptertitle}}{\numberline{\thechapter}}%
% %         {}{\fail}      
% %     \else
% %       \patchcmd{\Hy@org@chapter}%
% %         {\numberline{\xchaptertitle}}{\numberline{\thechapter}}%
% %         {}{\fail}  
% %     \fi
% %     \addtocontents{toc}{%
% %       \protect\renewcommand{\protect\cftchappresnum}{\appendixname\space}%
% %       \protect\renewcommand{\protect\cftchapaftersnum}{}%
% %     }%
% %   }
% % }{
% %   \renewcommand{\cftchappresnum}{\chaptername\space}
% %   \renewcommand{\cftchapaftersnum}{\space}
% %   \setlength{\cftchapnumwidth}{\widthof{\textbf{Appendix~9}}}
% %   \g@addto@macro\appendix{%
% %     \addtocontents{toc}{%
% %       \protect\renewcommand{\protect\cftchappresnum}{\appendixname\space}%
% %       \protect\renewcommand{\protect\cftchapaftersnum}{}%
% %       \setlength{\cftchapnumwidth}{\widthof{\textbf{Appendix~999}}}
% %     }%
% %   }
% % }

% % restore the tt default family to lmodern tt family
% \renewcommand\ttdefault{lmtt}
