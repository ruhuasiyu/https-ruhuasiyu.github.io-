\documentclass[xcolor={table}]{ctexbook}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{geometry}
% \usepackage{enumerate}
\usepackage{bm}
\usepackage{extarrows}
\usepackage{mathrsfs}
\usepackage{stmaryrd}
\usepackage{multirow}
\usepackage{tikz}
\usepackage{color,calc}
\usepackage{caption}
\usepackage{subcaption}
\RequirePackage[many]{tcolorbox}
\tcbset{
	common/.style={
		lower separated=false,
		coltitle=white,
		boxrule=1pt,
		fonttitle=\bfseries,
		enhanced,
		left=1mm,right=1mm,bottom=1mm,top=2mm,
		before skip=2mm minus 1mm,
		after skip=2mm minus 1mm,
		attach boxed title to top left={
			yshift=-0.11in, xshift=0.15in
		},
		boxed title style={
			boxrule=0pt, arc=0pt, outer arc=0pt
		}
	},
	indent/.style={
		before upper={\parindent1em}
	},
	parttitle/.style={
		blockstyle,
		left=1em,
		bottom=1ex,
		fonttitle=\large,
		attach boxed title to top center={
			yshift=-10pt, xshift=0pt
		}
	},
	sectiontitle/.style={
		exampstyle,
		left=-0.5em, top=4ex,
		bottom=1ex,
		fonttitle=\large,
		attach boxed title to top center={
			yshift=-10pt, xshift=0pt
		}
	}
}
\tcbset{
	blockstyle/.style={
		common,
		colframe=blue,
		colback=blue!10,
		colbacktitle=blue!80
	}
}
\tcbset{
	defstyle/.style={
		common,
		colframe=blue!50!red,
		colback=blue!50!red!7,
		colbacktitle=blue!50!red!80
	}
}
\tcbset{
	proofstyle/.style={
		common,
		colframe=red!50!green,
		colback=red!50!green!7,
		colbacktitle=red!50!green!80
	}
}
\tcbset{
	exampstyle/.style={
		common,
		colframe=green!50!black,
		colback=green!50!black!10,
		colbacktitle=green!50!black!80
	}
}
\tcbset{
	alertstyle/.style={
		common,
		colframe=red,
		colback=-blue!40!black,
		colbacktitle=red!80,
		colupper=red
	}
}
% @ means notitle, * means indent
\RequirePackage{xparse}
\renewenvironment{quote}[1]{\begin{tcolorbox}[exampstyle,title=#1,fontupper=\itshape,fontlower=\itshape,halign lower=flush right,lower separated=true]}{\end{tcolorbox}}
\newenvironment{quote@}{\begin{tcolorbox}[exampstyle,notitle,fontupper=\itshape,fontlower=\itshape,halign lower=flush right,lower separated=true]}{\end{tcolorbox}}
\newenvironment{quote*}[1]{\begin{tcolorbox}[exampstyle,title=#1,fontupper=\itshape,fontlower=\itshape,halign lower=flush right,lower separated=true,indent]}{\end{tcolorbox}}
\newenvironment{quote@*}{\begin{tcolorbox}[exampstyle,notitle,fontupper=\itshape,fontlower=\itshape,halign lower=flush right,lower separated=true,indent]}{\end{tcolorbox}}
% theorems
\newenvironment{block}[1]{\begin{tcolorbox}[blockstyle,title=#1]}{\end{tcolorbox}}
\newenvironment{block@}{\begin{tcolorbox}[blockstyle,notitle]}{\end{tcolorbox}}
\newenvironment{block*}[1]{\begin{tcolorbox}[blockstyle,title=#1,indent]}{\end{tcolorbox}}
\newenvironment{block@*}{\begin{tcolorbox}[blockstyle,notitle,indent]}{\end{tcolorbox}}

\NewDocumentEnvironment{theorem}{o}{\begin{block}{定理\IfNoValueTF{#1}{}{~(#1)}}}{\end{block}}
\NewDocumentEnvironment{theorem*}{o}{\begin{block*}{定理\IfNoValueTF{#1}{}{~(#1)}}}{\end{block*}}

\NewDocumentEnvironment{proposition}{o}{\begin{block}{命题\IfNoValueTF{#1}{}{~(#1)}}}{\end{block}}
\NewDocumentEnvironment{proposition*}{o}{\begin{block*}{命题\IfNoValueTF{#1}{}{~(#1)}}}{\end{block*}}

\NewDocumentEnvironment{corollary}{o}{\begin{block}{推论\IfNoValueTF{#1}{}{~(#1)}}}{\end{block}}
\NewDocumentEnvironment{corollary*}{o}{\begin{block*}{推论\IfNoValueTF{#1}{}{~(#1)}}}{\end{block*}}

\NewDocumentEnvironment{conjecture}{o}{\begin{block}{猜想\IfNoValueTF{#1}{}{~(#1)}}}{\end{block}}
\NewDocumentEnvironment{conjecture*}{o}{\begin{block*}{猜想\IfNoValueTF{#1}{}{~(#1)}}}{\end{block*}}

\NewDocumentEnvironment{lemma}{o}{\begin{block}{引理\IfNoValueTF{#1}{}{~(#1)}}}{\end{block}}
\NewDocumentEnvironment{lemma*}{o}{\begin{block}{引理\IfNoValueTF{#1}{}{~(#1)}}}{\end{block*}}

\NewDocumentEnvironment{fact}{o}{\begin{block}{事实\IfNoValueTF{#1}{}{~(#1)}}}{\end{block}}
\NewDocumentEnvironment{fact*}{o}{\begin{block*}{事实\IfNoValueTF{#1}{}{~(#1)}}}{\end{block*}}
% proofs
\newenvironment{proofblock}[1]{\begin{tcolorbox}[proofstyle,title=#1,fontupper=\itshape]}{\end{tcolorbox}}
\newenvironment{proofblock@}{\begin{tcolorbox}[proofstyle,notitle,fontupper=\itshape]}{\end{tcolorbox}}
\newenvironment{proofblock*}[1]{\begin{tcolorbox}[proofstyle,title=#1,fontupper=\itshape,indent]}{\end{tcolorbox}}
\newenvironment{proofblock@*}{\begin{tcolorbox}[proofstyle,notitle,fontupper=\itshape,indent]}{\end{tcolorbox}}

\NewDocumentEnvironment{solution}{o}{\begin{proofblock}{解\IfNoValueTF{#1}{}{~(#1)}}}{\end{proofblock}}
\NewDocumentEnvironment{solution*}{o}{\begin{proofblock*}{解\IfNoValueTF{#1}{}{~(#1)}}}{\end{proofblock*}}

\NewDocumentEnvironment{solutionc}{o}{\begin{proofblock}{续解\IfNoValueTF{#1}{}{~(#1)}}}{\end{proofblock}}
\NewDocumentEnvironment{solutionc*}{o}{\begin{proofblock*}{续解\IfNoValueTF{#1}{}{~(#1)}}}{\end{proofblock*}}

\NewDocumentEnvironment{proofs}{o}{\begin{proofblock}{证明\IfNoValueTF{#1}{}{~(#1)}}}{\end{proofblock}}
\NewDocumentEnvironment{proofs*}{o}{\begin{proofblock*}{证明\IfNoValueTF{#1}{}{~(#1)}}}{\end{proofblock*}}

\NewDocumentEnvironment{proofc}{o}{\begin{proofblock}{续证\IfNoValueTF{#1}{}{~(#1)}}}{\end{proofblock}}
\NewDocumentEnvironment{proofc*}{o}{\begin{proofblock}{续证\IfNoValueTF{#1}{}{~(#1)}}}{\end{proofblock*}}

\NewDocumentEnvironment{proofe}{o}{\pushQED{\qed}\begin{proofblock}{续证\IfNoValueTF{#1}{}{~(#1)}}}{\popQED\end{proofblock}}
\NewDocumentEnvironment{proofe*}{o}{\pushQED{\qed}\begin{proofblock*}{续证\IfNoValueTF{#1}{}{~(#1)}}}{\popQED\end{proofblock*}}

\NewDocumentEnvironment{analysis}{o}{\begin{proofblock}{分析\IfNoValueTF{#1}{}{~(#1)}}}{\end{proofblock}}
\NewDocumentEnvironment{analysis*}{o}{\begin{proofblock*}{分析\IfNoValueTF{#1}{}{~(#1)}}}{\end{proofblock*}}

\NewDocumentEnvironment{answer}{o}{\begin{proofblock}{答案\IfNoValueTF{#1}{}{~(#1)}}}{\end{proofblock}}
\NewDocumentEnvironment{answer*}{o}{\begin{proofblock*}{答案\IfNoValueTF{#1}{}{~(#1)}}}{\end{proofblock*}}
% definitions
\newenvironment{defblock}[1]{\begin{tcolorbox}[defstyle,title=#1,fontupper=\itshape]}{\end{tcolorbox}}
\newenvironment{defblock@}{\begin{tcolorbox}[defstyle,notitle,fontupper=\itshape]}{\end{tcolorbox}}
\newenvironment{defblock*}[1]{\begin{tcolorbox}[defstyle,title=#1,fontupper=\itshape,indent]}{\end{tcolorbox}}
\newenvironment{defblock@*}{\begin{tcolorbox}[defstyle,notitle,fontupper=\itshape,indent]}{\end{tcolorbox}}

\NewDocumentEnvironment{definition}{o}{\begin{defblock}{定义\IfNoValueTF{#1}{}{~(#1)}}}{\end{defblock}}
\NewDocumentEnvironment{definition*}{o}{\begin{defblock*}{定义\IfNoValueTF{#1}{}{~(#1)}}}{\end{defblock*}}
% examples
\newenvironment{exampleblock}[1]{\begin{tcolorbox}[exampstyle,title=#1]}{\end{tcolorbox}}
\newenvironment{exampleblock@}{\begin{tcolorbox}[exampstyle,notitle]}{\end{tcolorbox}}
\newenvironment{exampleblock*}[1]{\begin{tcolorbox}[exampstyle,title=#1,indent]}{\end{tcolorbox}}
\newenvironment{exampleblock@*}{\begin{tcolorbox}[exampstyle,notitle,indent]}{\end{tcolorbox}}

\NewDocumentEnvironment{example}{o}{\begin{exampleblock}{例\IfNoValueTF{#1}{}{~(#1)}}}{\end{exampleblock}}
\NewDocumentEnvironment{example*}{o}{\begin{exampleblock*}{例\IfNoValueTF{#1}{}{~(#1)}}}{\end{exampleblock*}}

\NewDocumentEnvironment{exercise}{o}{\begin{exampleblock}{练习\IfNoValueTF{#1}{}{~(#1)}}}{\end{exampleblock}}
\NewDocumentEnvironment{exercise*}{o}{\begin{exampleblock*}{练习\IfNoValueTF{#1}{}{~(#1)}}}{\end{exampleblock*}}

\NewDocumentEnvironment{thinking}{o}{\begin{exampleblock}{思考\IfNoValueTF{#1}{}{~(#1)}}}{\end{exampleblock}}
\NewDocumentEnvironment{thinking*}{o}{\begin{exampleblock*}{思考\IfNoValueTF{#1}{}{~(#1)}}}{\end{exampleblock*}}

\NewDocumentEnvironment{remark}{o}{\begin{exampleblock}{注\IfNoValueTF{#1}{}{~(#1)}}}{\end{exampleblock}}
\NewDocumentEnvironment{remark*}{o}{\begin{exampleblock*}{注\IfNoValueTF{#1}{}{~(#1)}}}{\end{exampleblock*}}
% alert
\newenvironment{alertblock}[1]{\begin{tcolorbox}[alertstyle,title=#1]}{\end{tcolorbox}}
\newenvironment{alertblock@}{\begin{tcolorbox}[alertstyle,notitle]}{\end{tcolorbox}}
\newenvironment{alertblock*}[1]{\begin{tcolorbox}[alertstyle,title=#1,indent]}{\end{tcolorbox}}
\newenvironment{alertblock@*}{\begin{tcolorbox}[alertstyle,notitle,indent]}{\end{tcolorbox}}

% Math Font
\RequirePackage{lmodern}
\RequirePackage[T1]{fontenc}
\setCJKsansfont[ItalicFont={KaiTi},BoldFont={LXGW ZhenKai}]{Source Han Sans HW SC}
\setlength{\parskip}{6pt plus 6pt minus 6pt}
\input{symbols}
\colorlet{heavyb}{blue!80}
\colorlet{lightb}{blue!15}
\colorlet{heavyg}{green!80}
\colorlet{lightg}{green!15}
\colorlet{heavyr}{red!80}
\colorlet{lightr}{red!20}
% 图形色
\colorlet{dcolora}{red}
\colorlet{dcolorb}{blue}
\colorlet{dcolorc}{red!50!blue}
\colorlet{dcolord}{green!50!black}
\colorlet{dcolore}{orange}
% 枚举数字引用标志
\newcommand\enumnum[1]{{\mdseries\upshape{enumerate item}(#1)}}
\newcommand\enumnumhk[1]{{
	\begin{pgfpicture}{-1ex}{0ex}{0.5ex}{2ex}
		\pgfpathcircle{\pgfpoint{0pt}{.75ex}}{1ex}
		\pgfusepath{stroke}
		\pgftext[base]{\color{fg}#1}
	\end{pgfpicture}%
}}
% 缩进
% \renewcommand{\indent}{\hspace*{1em}}
% \setlength{\parindent}{1em}
\newcommand\mqed{{\qedsymbol}} % 手动证毕标志
\newcommand\peq{\mathrel{\phantom{=}}} % 用于对齐的等号幻影
\newlength{\ltemp}\newlength{\lxxmax}\newlength{\lquar}\newlength{\lhalf}\newlength{\lfull}
\newcounter{lxxtype}
\NewDocumentCommand\xx{O{0} m m m m}{%
	\setlength{\lfull}{\columnwidth}%
	\addtolength{\lfull}{-\leftmargin}%
	\setlength{\lhalf}{0.5\lfull}%
	\setlength{\lquar}{0.25\lfull}%
	\setcounter{lxxtype}{0}%
	\ifnum#1=1\setcounter{lxxtype}{1}\fi%
	\ifnum#1=2\setcounter{lxxtype}{2}\fi%
	\ifnum#1=4\setcounter{lxxtype}{4}\fi%
	\settowidth{\lxxmax}{(A)~#2~}% 获取最长选项长度
	\settowidth{\ltemp}{(B)~#3~}%
	\ifdimcomp\ltemp>\lxxmax{\setlength{\lxxmax}{\ltemp}}{}%
	\settowidth{\ltemp}{(C)~#4~}%
	\ifdimcomp\ltemp>\lxxmax{\setlength{\lxxmax}{\ltemp}}{}%
	\settowidth{\ltemp}{(D)~#5~}%
	\ifdimcomp\ltemp>\lxxmax{\setlength{\lxxmax}{\ltemp}}{}%
	\ifnum\value{lxxtype}=0%
		\setcounter{lxxtype}{4}%
		\ifdimcomp\lxxmax>\lquar{\setcounter{lxxtype}{2}}{}%
		\ifnum\value{lxxtype}=2%
			\ifdimcomp\lxxmax>\lhalf{\setcounter{lxxtype}{1}}{}%
		\fi%
	\fi%

	\ifnum\value{lxxtype}=1%
		\\\makebox[\lfull][l]{(A)~#2}%
		\\\makebox[\lfull][l]{(B)~#3}%
		\\\makebox[\lfull][l]{(C)~#4}%
		\\\makebox[\lfull][l]{(D)~#5}%
	\fi%
	\ifnum\value{lxxtype}=2%
		\\\makebox[\lhalf][l]{(A)~#2}%
			\makebox[\lhalf][l]{(B)~#3}%
		\\\makebox[\lhalf][l]{(C)~#4}%
			\makebox[\lhalf][l]{(D)~#5}%
	\fi%
	\ifnum\value{lxxtype}=4%
		\\\makebox[\lquar][l]{(A)~#2}% 
			\makebox[\lquar][l]{(B)~#3}%
			\makebox[\lquar][l]{(C)~#4}%
			\makebox[\lquar][l]{(D)~#5}%
	\fi%
}
\usepackage[normalem]{ulem}
\NewDocumentCommand\fillblank{O{1cm} O{0cm} m}{\uline{\makebox[#1]{\raisebox{#2}{\emph{#3}}}}}
\newcommand\fillbrace[1]{{(\nolinebreak\hspace{0.5em minus 0.5em}\emph{#1}\hspace{0.5em minus 0.5em}\nolinebreak)}}
\newcommand\resizet[1]{\resizebox{!}{#1\baselineskip}}
\newcommand{\trueex}{$\checkmark$}
\newcommand{\falseex}{$\times$}
% TIKZ 设置
\usetikzlibrary{
	quotes,
	shapes.arrows,
	arrows.meta,
	positioning,
	shapes.geometric,
	patterns,
	calc,
	angles,
	decorations.pathreplacing,
	backgrounds % 背景边框
}
\tikzset{
	background rectangle/.style={semithick,draw=cyan,fill=white,rounded corners},
	cstarrowto/.style     ={-Stealth}, %尖箭头
	cstarrowfrom/.style   ={Stealth-},
	cstarrowdouble/.style ={Stealth-Stealth},
	cstarrow1to/.style    ={-Straight Barb}, %宽箭头
	cstarrow1from/.style  ={Straight Barb-},
	cstarrow1double/.style={Straight Barb-Straight Barb},
	cstnarrow/.style      ={-Latex, line width=0.1cm}, %文本框间箭头
	cstaxis/.style        ={-Stealth, thick}, %坐标轴
	cstcurve/.style       ={very thick}, %一般曲线
	cstdash/.style        ={thick, dash pattern= on 0.2cm off 0.05cm}, %虚线
	cstdot/.style         ={radius=0.07}, %实心点
	cstdote/.style        ={radius=0.06, fill=white}, %空心点
	cstfill/.style        ={fill=cyan!30}, %填充
	cstfille/.style       ={pattern=north east lines, pattern color=cyan}, %虚线填充
	cstfill1/.style       ={fill=red!30}, %填充
	cstfille1/.style      ={pattern=north east lines, pattern color=red}, %虚线填充
	cstnode/.style        ={fill=white,draw=black,text=black,rounded corners=0.2cm,line width=1pt},
	cstnodeb/.style       ={fill=lightb,draw=heavyb,text=black,rounded corners=0.2cm,line width=1pt},
	cstnodeg/.style       ={fill=lightg,draw=heavyg,text=black,rounded corners=0.2cm,line width=1pt},
	cstnoder/.style       ={fill=lightr,draw=heavyr,text=black,rounded corners=0.2cm,line width=1pt}
}
\begin{document}

% 标题
\author{张神星}
% \institute{合肥工业大学}
% \email{zhangshenxing@hfut.edu.cn}
\title{复变函数与积分变换}
\maketitle

\chapter{复数与复变函数}

复数起源于多项式方程的求根问题. 
我们考虑一元二次方程 $x^2+bx+c=0$, 配方可得
	\[\left(x+\frac b2\right)^2=\frac{b^2-4c}4.\]
于是得到求根公式
	\[x=\frac{-b\pm\sqrt\Delta}2,\quad \Delta=b^2-4c.\]
\begin{enumerate}
	\item 当 $\Delta>0$ 时, 有两个不同的实根;
	\item 当 $\Delta=0$ 时, 有一个二重的实根;
	\item 当 $\Delta<0$ 时, 无实根. 然而, 如果我们\emph{接受负数开方}的话, 此时仍然有两个根, 形式地计算可以发现它们满足原来的方程.
\end{enumerate}

现在我们来考虑一元三次方程.
\begin{example}
	解方程 $x^3+6x-20=0$.
\end{example}
\begin{solution}
	设 $x=u+v$, 则
		\[u^3+v^3+3uv(u+v)+6(u+v)-20=0.\]
	{%
		我们希望 $u^3+v^3=20, uv=-2$,%
		则 $u^3,v^3$ 满足一元二次方程 $X^2-20X-8=0$.%
		解得
		\[u^3=10\pm\sqrt{108}{=(1\pm\sqrt3)^3.}\]%
		所以 $u=1\pm\sqrt3, v=1\mp\sqrt 3$,%
		$x=u+v=2$.
	}
\end{solution}

那么这个方程是不是真的只有 $x=2$ 这一个解呢?
由 $f'(x)=3x^2+6>0$ 可知其单调递增, 因此确实只有一个解.
\begin{center}
	\begin{tikzpicture}[framed]
		\filldraw[cstcurve,dcolora,domain=-3.1:3.7,smooth,fill=white] plot ({(\x)*0.4},{(\x*\x*\x+6*\x-20)*0.04});
		\draw[cstaxis] (-2.5,0)--(2.5,0);
		\draw[cstaxis] (0,-2.9)--(0,2.5);
		\fill[cstdot,dcolorb] (0,-0.8) circle;
		\fill[cstdot,dcolorb] (0.8,0) circle;
		\draw (0,-.8) node[right] {$-20$};
		\draw (.8,0) node[above left] {$2$};
	\end{tikzpicture}
\end{center}

\begin{example}
	解方程 $x^3-7x+6=0$.
\end{example}

\begin{solution*}
同样地我们有 $x=u+v$, 其中
	\[u^3+v^3=-6,\quad uv=\frac73.\]
{于是 $u^3,v^3$ 满足一元二次方程 $X^2+6X+\dfrac{343}{27}=0$.
}{然而这个方程没有实数解.}

{我们可以强行解得
	\[u^3=-3+\frac{10}9\sqrt{-3}.\]}
\end{solution*}

\begin{solutionc}
	\[u=\sqrt[3]{-3+\frac{10}9\sqrt{-3}}
	=\frac{3+2\sqrt{-3}}3,\frac{-9+\sqrt{-3}}6,\frac{3-5\sqrt{-3}}6,\]
{相应地
	\[v=\frac{3-2\sqrt{-3}}3,\frac{-9-\sqrt{-3}}6,\frac{3+5\sqrt{-3}}6,\]
}{
	\[x=u+v=2,-3,1.\]}
\end{solutionc}

{所以我们从一条``\emph{错误的路径}''走到了正确的目的地?}

对于一般的三次方程 $x^3+px+q=0$ 而言, 类似可得:
	\[x=u-\frac p{3u},\quad u^3=-\frac q2+\sqrt{\Delta},\quad \Delta=\frac{q^2}4+\frac{p^3}{27}.\]
由于 $p=0$ 情形较为简单, 所以我们不考虑这种情形.
通过分析函数图像的极值点可以知道:
\begin{enumerate}
	\item 当 $\Delta>0$ 时, 有 $1$ 个实根.
	\item 当 $\Delta=0$ 时, 有 $2$ 个实根 $x=-\sqrt[3]{4q},\half\sqrt[3]{4q}$ ($2$重).
	\item 当 $\Delta<0$ 时, 有 $3$ 个实根.
\end{enumerate}
\begin{center}
	\begin{tikzpicture}
		\begin{scope}[framed]
			\draw[cstcurve,dcolora,domain=-2.4:3.3,smooth] plot ({(\x)*0.25},{(\x*\x*\x-3*\x-10)*0.06});
			\draw[cstaxis] (-1.5,0)--(1.5,0);
			\draw[cstaxis] (0,-1.2)--(0,1.2);
		\end{scope}
		\begin{scope}[framed,xshift=40mm]
			\draw[cstcurve,dcolora,domain=-3.1:2.7,smooth] plot ({(\x)*0.25},{(\x*\x*\x-3*\x+2)*0.06});
			\draw[cstaxis] (-1.5,0)--(1.5,0);
			\draw[cstaxis] (0,-1.2)--(0,1.2);
		\end{scope}
		\begin{scope}[framed,xshift=80mm]
			\draw[cstcurve,dcolora,domain=-3.9:3.7,smooth] plot ({(\x)*0.2},{(\x*\x*\x-7*\x+1)*0.03});
			\draw[cstaxis] (-1.5,0)--(1.5,0);
			\draw[cstaxis] (0,-1.2)--(0,1.2);
		\end{scope}
	\end{tikzpicture}
\end{center}

所以我们想要使用求根公式的话, 就\emph{必须接受负数开方}.
那么为什么当 $\Delta<0$ 时, 从求根公式一定能得到 $3$ 个实根呢?
在学习了第一章的内容之后我们就可以回答这个问题了.

尽管在十六世纪, 人们已经得到了三次方程的求根公式, 然而对其中出现的虚数, 却是难以接受.

\begin{quote@*}
	圣灵在分析的奇观中找到了超凡的显示, 这就是那个理想世界的端兆, 那个介于存在与不存在之间的两栖物, 那个我们称之为虚的 $-1$ 的平方根。
\tcblower
莱布尼兹 (Leibniz)
\end{quote@*}

我们将在下一节使用更为现代的语言来解释和运用复数.

\section{复数及其代数运算}

\subsection{复数的概念}

现在我们来正式介绍复数的概念.
\begin{definition}
	固定一个记号 $i$, \emph{复数}就是形如 $z=x+yi$ 的元素, 其中 $x,y$ 均是实数, 且不同的 $(x,y)$ 对应不同的复数.
\end{definition}
换言之, 每一个复数可以唯一地表达成 $x+yi$ 这样的形式.
也就是说, 复数全体构成一个二维实线性空间, 且 $\{1,i\}$ 是一组基.

我们将\emph{全体复数记作 $\BC$}, 全体实数记作 $\BR$, 则 $\BC=\BR+\BR i$.

由于 $\BC$ 是一个二维实向量空间, $1$ 和 $i$ 构成一组基,
因此它和平面上的点可以建立一一对应.
\begin{center}
	\begin{tikzpicture}
		\begin{scope}
			\draw[cstaxis] (-0.4,0)--(2,0);
			\draw[cstaxis] (0,-0.4)--(0,2);
			\draw[cstdash] (1.6,0)--(1.6,1.2);
			\draw[cstdash] (0,1.2)--(1.6,1.2);
			\fill[cstdot,dcolora] (1.6,1.2) circle;
			\draw (-0.2,-0.2) node {$0$};
			\draw[dcolorb,Latex-Latex,line width=.5mm] (2.2,.8)--(3.4,.8);
			\draw
				(1.6,1.5) node[dcolora] {$z=x+yi$}
				(2.8,.3) node[dcolorb] {\small 一一对应}
				(0.8,-0.7) node[dcolorb] {复平面};
		\end{scope}
		\begin{scope}[xshift=4cm]
			\draw[cstaxis] (-.4,0)--(2,0);
			\draw[cstaxis] (0,-0.4)--(0,2);
			\draw[decorate,decoration={brace,amplitude=5},dcolora] (0,0)--(1.6,0);
			\draw[decorate,decoration={brace,amplitude=5},dcolorb] (0,1.2)--(0,0);
			\draw[cstdash] (1.6,0)--(1.6,1.2);
			\draw[cstdash] (0,1.2)--(1.6,1.2);
			\fill[cstdot,dcolora] (1.6,1.2) circle;
			\draw[dcolorb,Latex-Latex,line width=.5mm] (2.2,.8)--(3.4,.8);
			\draw
				(1.6,1.5) node[dcolora] {$Z(x,y)$}
				(.8,.3) node[dcolora] {$x$}
				(.3,.6) node[dcolorb] {$y$}
				(-.2,-.2) node {$O$}
				(1,-0.7) node {直角坐标系}
				(2.8,.3) node[dcolorb] {\small 一一对应};
		\end{scope}
		\begin{scope}[xshift=8cm]
			\draw[cstaxis] (-.4,0)--(2,0);
			\draw[cstaxis] (0,-.4)--(0,2);
			\draw[cstcurve,cstarrowto,dcolora] (0,0)--(1.6,1.2);
			\draw 
				(1.5,1.5) node[dcolora] {$\overrightarrow{OZ}=(x,y)$}
				(-.2,-.2) node {$O$}
				(1,-.7) node {向量};
		\end{scope}
	\end{tikzpicture}
\end{center}

当 $y=0$ 时, $z=x$ 就是一个实数.
它对应复平面上的点就是直角坐标系的 $x$ 轴上的点.
因此我们称 $x$ 轴为\textcolor{dcolorb}{实轴}.
相应地, 称 $y$ 轴为\textcolor{dcolorc}{虚轴}.
称 $z=x+yi$ 在实轴和虚轴的投影为它的\textcolor{dcolorb}{实部 $\Re z=x$} 和\textcolor{dcolorc}{虚部 $\Im z=y$}.

当 $\Im z=0$ 时, $z$ 是实数.
不是实数的复数是\emph{虚数}.
当 $\Re z=0$ 且 $z\neq 0$ 时, 称 $z$ 是\emph{纯虚数}.

\begin{center}
	\begin{tikzpicture}
		\begin{scope}
			\draw[cstaxis] (-0.4,0)--(2.7,0);
			\draw[cstaxis,dcolorb] (-0.4,0)--(2.7,0);
			\draw[cstaxis] (0,-0.4)--(0,2);
			\draw[cstaxis,dcolorc] (0,-0.4)--(0,2);
			\draw[cstdash] (1.6,0)--(1.6,1.2);
			\draw[cstdash] (0,1.2)--(1.6,1.2);
			\fill[cstdot,dcolora] (1.6,1.2) circle;
			\draw[decorate,decoration={brace,amplitude=5},dcolorb] (1.6,0)--(0,0);
			\draw[decorate,decoration={brace,amplitude=5},dcolorc] (0,1.2)--(0,0);
			\draw[dcolorb,thick] (-0.95,.2)--(0.7,.2)--(0.7,0)[->];
			\draw[dcolorc,->,thick] (-0.61,1.3)--(0,1.3);
			\draw 
				(1.6,1.4) node[dcolora] {$z=x+yi$}
				(-0.2,-0.2) node {$0$}
				(2.2,.4) node[dcolorb] {实轴}
				(0.6,1.9) node[dcolorc] {虚轴}
				(0.8,-0.3) node[dcolorb] {$\Re z$}
				(0.6,.6) node[dcolorc] {$\Im z$}
				(-1.51,.1) node[cstnode,draw=dcolorb,text=dcolorb] {实数}
				(-1.6,1.2) node[align=center,cstnode,draw=dcolorc,text=dcolorc] {纯虚数\\不含原点};
		\end{scope}
		\begin{scope}[xshift=1cm]
			\filldraw[cstcurve,dcolora,cstfill] (5.5,1) circle (2.2 and 1.8);
			\filldraw[cstcurve,dcolora,fill=white] (5.5,1)--(3.3,1) arc (180:300:2.2 and 1.8) -- cycle;
			\draw[cstcurve,dcolora] (5,1.9) circle (0.85 and 0.65);
			\draw 
				(4.8,.35) node[align=center] {\small 实数 \\$0,1,\sqrt2,\pi,e$}
				(8.5,1) node[align=center,dcolora] {全\\体\\复\\数}
				(6.6,1.3) node[align=center] {\small 虚数 \\$i,\pi i,\frac{-1+\sqrt 3 i}2$}
				(5,1.9) node[align=center] {\small 纯虚数 \\$i,-i,\pi i$};
		\end{scope}
	\end{tikzpicture}
\end{center}

\begin{example}
	实数 $x$ 取何值时, $z=(x^2-3x-4)+(x^2-5x-6)i$ 是:\par
	\enumnum1 实数; \enumnum2 纯虚数.
\end{example}
\begin{solution}
	\begin{enumerate}
		\item $\Im z=x^2-5x-6=0$, 即 $x=-1$ 或 $6$.
		\item $\Re z=x^2-3x-4=0$, 即 $x=-1$ 或 $4$.
			{但同时要求 $\Im z=x^2-5x-6\neq 0$, 因此 $x\neq -1$, $x=4$.}
	\end{enumerate}
\end{solution}
\begin{exercise}
	若 $x^2(1+i)+x(5+4i)+4+3i$ 是纯虚数, 则实数 $x=$\fillblank{{$-4$}}.
\end{exercise}

\subsection{复数的代数运算}

设 $z_1=x_1+y_1i,z_2=x_2+y_2i$.
由 $\BC$ 是二维实线性空间可得复数的加法和减法:
\begin{align*}
	z_1+z_2&=(x_1+x_2)+(y_1+y_2)i,\\
	{z_1-z_2}&{=(x_1-x_2)+(y_1-y_2)i.}
\end{align*}
复数的加减法与其对应的向量 $\overrightarrow{OZ}$ 的加减法是一致的.
\begin{center}
	\begin{tikzpicture}[scale=.9,framed]
	\draw[cstaxis] (-1.2,0)--(3.5,0);
	\draw[cstaxis] (0,-2.2)--(0,1.6);
	\draw[cstcurve,cstarrowto,dcolora] (0,0)--(2,-0.5);
	\draw[cstcurve,cstarrowto,dcolora] (0,0)--(1,1.5);
	\draw[cstcurve,cstarrowto,dcolorb] (0,0)--(3,1);
	\draw[cstcurve,cstarrowto,dcolorc] (0,0)--(1,-2);
	\draw[cstdash,cstarrowto] (0,0)--(-1,-1.5);
	\draw[cstdash] (1,1.5)--(3,1)--(1,-2)--(-1,-1.5);
	\draw 
	(2.3,-0.5) node[dcolora] {$z_1$}
	(0.6,1.5) node[dcolora] {$z_2$}
	(3.7,1) node[dcolorb] {$z_1+z_2$}
	(-0.2,1.4) node {$y$}
	(3.3,-0.3) node {$x$}
	(-0.2,.2) node {$0$}
	(1.7,-2.1) node[dcolorc] {$z_1-z_2$}
	(-1.4,-1.4) node {$-z_2$};
	\end{tikzpicture}
\end{center}

\emph{规定 $i\cdot i=-1$.}
由线性空间的数乘和乘法分配律可得:
\begin{align*}
	z_1\cdot z_2&=x_1\cdot x_2+x_1\cdot y_2i+y_1i\cdot x_2+y_1i\cdot y_2i\\
	&=(x_1x_2-y_1y_2)+(x_1y_2+x_2y_1)i,
\end{align*}
\[{\frac1{z}=\frac{x-yi}{x^2+y^2},}\quad
{\frac{z_1}{z_2}=\frac{x_1x_2+y_1y_2}{x_2^2+y_2^2}+\frac{x_2y_1-x_1y_2}{x_2^2+y_2^2}i.}\]
对于正整数 $n$, 定义 $z$ 的 \emph{$n$ 次幂}为 $n$ 个 $z$ 相乘.
当 $z\neq 0$ 时, 还可以定义 $z^0=1,z^{-n}=\dfrac1{z^n}$.

\begin{example}
	\begin{enumerate}
		\item $i^2=-1,i^3=-i,i^4=1$.
		一般地, 对于整数 $n$, 
		\[i^{4n}=1,\quad i^{4n+1}=i,\quad i^{4n+2}=-1,\quad i^{4n+3}=-i.\]
		\item 令 $\omega=\dfrac{-1+\sqrt 3i}2$, 则 $\omega^2=\dfrac{-1-\sqrt3i}2,\omega^3=1$.
		\item 令 $z=1+i$, {则
		\[z^2=2i,\quad z^3=-2+2i,\quad z^4=-4,\quad z^8=16=2^4.\]}
	\end{enumerate}
\end{example}
我们把满足 $z^n=1$ 的复数 $z$ 称为 \emph{$n$ 次单位根}.
那么 $1,i,-1,-i$ 是 $4$ 次单位根, $1,\omega,\omega^2$ 是 $3$ 次单位根.

\begin{example}
	化简 $1+i+i^2+i^3+i^4=$\fillblank{{$1$}}.
\end{example}
\begin{solution}
	根据等比数列求和公式,
	\[1+i+i^2+i^3+i^4=\frac{i^5-1}{i-1}
	{=\frac{i-1}{i-1}=1.}\]
\end{solution}
\begin{exercise}[2020年A卷]
	化简 $\left(\dfrac{1-i}{1+i}\right)^{2020}$=\fillblank{{$1$}}.
\end{exercise}

复数全体构成一个\emph{域}.
所谓的域, 是指带有如下内容和性质的集合
\begin{itemize}
	\item 包含 $0,1$, 且有四则运算;
	\item 满足加法结合/交换律, 乘法结合/交换/分配律;
	\item 对任意 $a$, $a+0=a\times 1=a$.
\end{itemize}
有理数全体 $\BQ$, 实数全体 $\BR$ 也构成域, 它们是 $\BC$ 的子域.
与有理数域和实数域有着本质不同的是, 复数域是\emph{代数闭域}:
对于任何次数 $n\ge 1$ 的复系数多项式
	\[p(z)=z^n+c_{n-1}z^{n-1}+\cdots+c_1z+c_0,\]
都存在复数 $z_0$ 使得 $p(z_0)=0$.
也就是说复系数多项式可以因式分解成一次多项式的乘积.
我们会在第五章证明该结论.

在 $\BQ,\BR$ 上可以定义出一个好的大小关系,
换言之它们是有序域, 即存在一个满足下述性质的 $>$:
\begin{itemize}
	\item 若 $a\neq b$, 则要么 $a>b$, 要么 $b>a$;
	\item 若 $a>b$, 则对于任意 $c$, $a+c>b+c$;
	\item 若 $a>b,c>0$, 则 $ac>bc$.
\end{itemize}
而 \emph{$\BC$ 却不是有序域}.
如果 $i>0$, 则
	\[-1=i\cdot i>0,\quad -i=-1\cdot i>0.\]
于是 $0>i$, 矛盾! 同理 $i<0$ 也不可能.

\subsection{共轭复数}

\begin{definition}
	称 $z$ 在复平面关于实轴的对称点为它的\emph{共轭复数 $\ov z$}.
换言之, $\ov z=x-yi$.
\end{definition}
从定义出发, 不难验证共轭复数满足如下性质:
\begin{enumerate}
	\item $z$ 是 $\ov z$ 的共轭复数.
	\item $\ov{z_1\pm z_2}=\ov{z_1}\pm\ov{z_2},\ 
	\ov{z_1\cdot z_2}=\ov{z_1}\cdot\ov{z_2},\ 
	\ov{z_1/z_2}=\ov{z_1}/\ov{z_2}$.
	\item $z\ov{z}=(\Re z)^2+(\Im z)^2$.
	\item $z+\ov z=2\Re z,\ z-\ov z=2i\Im z$.
\end{enumerate}
\enumnum4表明了 $x,y$ 可以用 $z,\ov z$ 表出.
\enumnum2表明共轭复数和四则运算交换.
这意味着使用共轭复数进行计算和证明，往往比直接使用 $x,y$ 表达的形式更简单.

\begin{exercise}
	$z$ 关于虚轴的对称点是\fillblank{{$-\ov z$}}.
\end{exercise}
\begin{example}
	证明 $z_1\cdot\ov{z_2}+\ov{z_1}\cdot z_2=2\Re(z_1\cdot\ov{z_2})$.
\end{example}
我们可以设 $z_1=x_1+y_1i,z_2=x_2+y_2i$, 然后代入等式两边化简并比较实部和虚部得到.
但我们利用共轭复数可以更简单地证明它.
\begin{proof}
	{%
		由于 $\ov{z_1\cdot\ov{z_2}}=\ov{z_1}\cdot\ov{\ov{z_2}}=\ov{z_1}\cdot z_2$, %
		因此
		\[z_1\cdot\ov{z_2}+\ov{z_1}\cdot z_2
			=z_1\cdot\ov{z_2}+\ov{z_1\cdot\ov{z_2}}
			=2\Re(z_1\cdot\ov{z_2}).\qedhere\]
	}
\end{proof}

\begin{example}
	设 $z=x+yi$ 且 $y\neq 0,\pm1$. 证明: $x^2+y^2=1$ 当且仅当 $\dfrac z{1+z^2}$ 是实数.
\end{example}
\begin{proof}
	$\dfrac z{1+z^2}$ 是实数当且仅当
	\[\frac z{1+z^2}=\ov{\left(\frac z{1+z^2}\right)}=\frac{\ov z}{1+{\ov z}^2},\]
	{%
		即
		\[z(1+{\ov z}^2)=\ov z(1+z^2),\quad (z-\ov z)(z\ov z-1)=0.\]%
		由 $y\neq0$ 可知 $z\neq \ov z$.%
		故上述等式等价于 $z\ov z=1$, 即 $x^2+y^2=1$.\qedhere
	}
\end{proof}

由于 $z\ov z$ 是一个实数,
因此在做复数的除法运算时, 可以利用下式将其转化为乘法:
	\[\dfrac{z_1}{z_2}=\dfrac{z_1\ov{z_2}}{z_2\ov{z_2}}=\dfrac{z_1\ov{z_2}}{x_2^2+y_2^2}.\]
\begin{example}
	$z=-\dfrac1i-\dfrac{3i}{1-i}$, 求 $\Re z,\Im z$ 以及 $z\ov z$.
\end{example}
\begin{solution}
	\[z=-\frac1i-\frac{3i}{1-i}
	{=i-\frac{3i-3}2=\frac32-\half i,}\]
	{%
		因此
			\[\Re z=\frac32,\quad\Im z=-\half ,\quad
			z\ov z=\left(\frac32\right)^2+\left(-\half\right)^2=\frac52.\]
	}
\end{solution}

\begin{example}
	设 $z_1=5-5i,z_2=-3+4i$, 求 $\ov{\left(\dfrac{z_1}{z_2}\right)}$.
\end{example}
\begin{solution}
	\begin{align*}
		\frac{z_1}{z_2}&=\frac{5-5i}{-3+4i}
		{=\frac{(5-5i)(-3-4i)}{(-3)^2+4^2}}\\
		&{=\frac{(-15-20)+(-20+15)i}{25}}
		{=-\frac75-\frac15i,}
	\end{align*}
	{%
		因此 $\ov{\left(\dfrac{z_1}{z_2}\right)}=-\dfrac75+\dfrac15i$.
	}
\end{solution}

\section{复数的三角与指数形式}

\subsection{复数的模和辐角}

由平面的极坐标表示, 我们可以得到复数的另一种表示方式.
以 $0$ 为极点, 正实轴为极轴, 逆时针为极角方向可以自然定义出复平面上的极坐标系.
\begin{center}
	\begin{tikzpicture}
		\draw[cstaxis] (-0.4,0)--(2.5,0);
		\draw[cstaxis] (0,-0.4)--(0,2);
		\draw[cstdash] (1.6,0)--(1.6,1.2);
		\draw[cstdash] (0,1.2)--(1.6,1.2);
		\fill[cstdot,dcolora] (1.6,1.2) circle;
		\draw[decorate,decoration={brace,amplitude=5},dcolora] (1.6,0)--(0,0);
		\draw[decorate,decoration={brace,amplitude=5},dcolorb] (0,0)--(0,1.2);
		\draw
		(1.6,1.4) node[dcolora] {$z=x+yi$}
		(-0.2,-0.2) node {$0$}
		(0.7,0.8) node[dcolorc] {$r$}
		(6,1) node[dcolorc] {$r=\sqrt{x^2+y^2}$}
		(6,0.3) node[dcolorc] {$\theta=\arctan\dfrac yx$ 或 $\arctan\dfrac yx\pm\pi$}
		(1,-0.3) node[dcolora] {$x=r\cos\theta$}
		(-1.2,0.6) node[dcolorb] {$y=r\sin\theta$};
		\coordinate (A) at (3,0);
		\coordinate (B) at (0,0);
		\coordinate (C) at (1.6,1.2);
		\draw[cstcurve,dcolorc,cstarrowto] (B)--(C);
		\draw[dcolorc,thick,cstarrowto] pic [draw, "$\theta$", angle eccentricity=1.3, angle radius=0.8cm] {angle};
	\end{tikzpicture}
\end{center}

\begin{definition}
	\begin{itemize}
		\item 称 $r$ 为 $z$ 的\emph{模}, 记为 \emph{$|z|=r$}.
		\item 称 $\theta$ 为 $z$ 的\emph{辐角}, 记为 \emph{$\Arg z=\theta$}.
		{\emph{$0$ 的辐角没有意义}.}
	\end{itemize}
\end{definition}

任意 $z\neq 0$ 的辐角有无穷多个.
我们固定选择其中位于 $(-\pi,\pi]$ 的那个, 并称之为\emph{主辐角}或辐角主值, 记作 \emph{$\arg z$}.
\begin{center}
\begin{tikzpicture}
	\draw[cstaxis](-2.5,0)->(2.5,0); 
	\draw[cstaxis](0,-2)->(0,2);
	\draw[cstaxis,dcolorb,cstarrow1from] (-1,0) arc(180:-180:1);
	\filldraw[cstdote,draw=dcolora] (-1,-0.05) circle;
	\fill[cstdot,dcolora] (1,0) circle;
	\fill[cstdot,dcolora] (0.8,0.8) circle;
	\fill[cstdot,dcolora] (1.0,-0.8) circle;
	\fill[cstdot,dcolorc] (-1.0,0.6) circle;
	\fill[cstdot,dcolorc] (-0.7,0) circle;
	\fill[cstdot,dcolorb] (-0.9,-0.5) circle;
	\fill[cstdot] (0,0.5) circle;
	\fill[cstdot] (0,-0.5) circle;
	\draw
	(1.1,0.2) node[dcolora] {$0$}
	(1.0,1.1) node[dcolora] {$\arctan\dfrac yx$}
	(1.1,-1.2) node[dcolora] {$\arctan\dfrac yx$}
	(-1.2,1.2) node[dcolorc] {$\arctan\dfrac yx\colorbox{yellow}{$+\pi$}$}
	(-0.6,-0.2) node[dcolorc] {$\pi$}
	(-1.2,-1.1) node[dcolorb] {$\arctan\dfrac yx\colorbox{yellow}{$-\pi$}$}
	(-0.2,0.5) node[black] {$\dfrac\pi2$}
	(0.4,-0.5) node[black] {$-\dfrac\pi2$};
\end{tikzpicture}
\end{center}

\[\arg z=\begin{cases}
	\arctan\dfrac yx,&x>0;\\
	\arctan\dfrac yx+\pi,&x<0,y\ge0;\\
	\arctan\dfrac yx-\pi,&x<0,y<0;\\
	\dfrac\pi2,&x=0,y>0;\\
	-\dfrac\pi2,&x=0,y<0.
\end{cases}\]
那么 \emph{$\Arg z=\arg z+2k\pi, k\in\BZ$}.

注意 \emph{$\arg \ov z=-\arg z$ 未必成立}, 例如 $z$ 是负实数.

复数的模满足如下性质:
\begin{itemize}
	\item $z\ov z=|z|^2=|\ov z|^2$;
	\item $\abs{\Re z},\abs{\Im z}\le |z|\le\abs{\Re z}+\abs{\Im z}$;
	\item $\big||z_1|-|z_2|\big|\le|z_1\pm z_2|\le|z_1|+|z_2|$;
	\item $|z_1+z_2+\cdots+z_n|\le|z_1|+|z_2|+\cdots+|z_n|$.
\end{itemize}
\begin{center}
	\begin{tikzpicture}
		\begin{scope}[framed]
			\draw[cstaxis] (-1,0)--(3,0);
			\draw[cstaxis] (0,-1)--(0,2);
			\draw[cstcurve,dcolorc] (1.6,0)--(0,0);
			\draw[cstcurve,dcolorb] (1.6,0)--(1.6,1.2);
			\draw[cstcurve,dcolora] (1.6,1.2)--(0,0);
			\fill[cstdot,dcolora] (1.6,1.2) circle;
			\draw[thick] (1.6,0.2)--(1.4,0.2)--(1.4,0);
			\draw[decorate,decoration={brace,amplitude=5},dcolorc] (1.6,0)--(0,0);
			\draw[decorate,decoration={brace,amplitude=5},dcolorb] (1.6,1.2)--(1.6,0);
			\draw 
				(0.6,0.9) node[dcolora] {$|z|$}
				(0.8,-0.4) node[dcolorc] {$\abs{\Re z}$}
				(2.3,0.6) node[dcolorb] {$\abs{\Im z}$};
		\end{scope}
		\begin{scope}[framed,xshift=60mm]
			\draw[cstaxis] (-2,0)--(3,0);
			\draw[cstaxis] (0,-1.6)--(0,1.3);
			\draw[cstcurve,cstarrowto,dcolora] (0,0)--(1.6,-0.4);
			\draw[decorate,decoration={brace,amplitude=5},dcolora] (1.6,-0.4)--(0,0);
			\draw[cstcurve,cstarrowto,dcolorb] (0,0)--(0.8,1.2);
			\draw[decorate,decoration={brace,amplitude=5,aspect=0.35},dcolorb] (2.4,0.8)--(1.6,-0.4);
			\draw[cstcurve,cstarrowto,dcolorc] (0,0)--(2.4,0.8);
			\draw[decorate,decoration={brace,amplitude=5,aspect=0.65},dcolorc] (0,0)--(2.4,0.8);
			\draw[cstcurve,cstarrowto,dcolorc] (0,0)--(0.8,-1.6);
			\draw[decorate,decoration={brace,amplitude=5,aspect=0.65},dcolorc] (0.8,-1.6)--(0,0);
			\draw[dcolorc,cstarrowto] (0.116,-0.636)--(-0.7,-0.4);
			\draw[cstdash,dcolorb] (2.4,0.8)--(0.8,-1.6);
			\draw[cstdash,dcolora] (0.8,-1.6)--(-0.8,-1.2);
			\draw[cstdash,dcolorb] (-0.8,-1.2)--(0,0);
			\draw 
				(1.8,-0.6) node[dcolora] {$z_1$}
				(0.3,1.1) node[dcolorb] {$z_2$}
				(0.75,-0.55) node[dcolora] {$|z_1|$}
				(2.6,0.25) node[dcolorb] {$|z_2|$}
				(1.4,0.8) node[dcolorc,rotate=20] {$|z_1+z_2|$}
				(-1.5,-0.4) node[dcolorc] {$|z_1-z_2|$};
		\end{scope}
	\end{tikzpicture}
\end{center}

\begin{example}
	证明
	\begin{enumerate}
		\item $|z_1z_2|=|z_1\ov{z_2}|=|z_1|\cdot|z_2|$;
		\item $|z_1+z_2|^2=|z_1|^2+|z_2|^2+2\Re(z_1\ov{z_2})$.
	\end{enumerate}
\end{example}

% \begin{proof}
% 	\enumnum1 因为
% 	\[|z_1z_2|^2=z_1z_2\cdot\ov{z_1}\ov{z_2}
% 	=z_1z_2\ov{z_1}\ov{z_2}=|z_1|^2\cdot|z_2|^2,\]
% 	{%
% 		所以 $|z_1z_2|=|z_1|\cdot|z_2|$.%
% 		因此 $|z_1\ov{z_2}|=|z_1|\cdot|\ov{z_2}|=|z_1|\cdot|z_2|$.
% 	}

% 	{%
% 		\enumnum2 因为
% 		\begin{align*}
% 			\text{左边}&=(z_1+z_2)(\ov{z_1}+\ov{z_2})
% 			{=z_1\ov{z_1}+z_2\ov{z_2}+z_1\ov{z_2}+\ov{z_1}z_2,}\\
% 			\text{右边}&=z_1\ov{z_1}+z_2\ov{z_2}+z_1\ov{z_2}+\ov{z_1\ov{z_2}},
% 		\end{align*}%
% 		而 $\ov{z_1\ov{z_2}}=\ov{z_1}z_2$, 所以两侧相等.\qedhere
% 	}
% \end{proof}

% \subsection{复数的三角形式和指数形式}

% 由 $x=r\cos\theta,y=r\sin\theta$ 可得复数的\emph{三角形式}
% \[z=r(\cos\theta+i\sin\theta).\]
% 定义 $e^{i\theta}=\exp(i\theta):=\cos\theta+i\sin\theta$ (欧拉恒等式),
% 则我们得到复数的\emph{指数形式}
% \[z=re^{i\theta}=r\exp(i\theta).\]
% 这两种形式的等价的, 指数形式可以认为是三角形式的一种缩写方式.

% 求复数的三角/指数形式的\emph{关键在于计算模和辐角}.

% \begin{example}
% 	将 $z=-\sqrt{12}-2i$ 化成三角形式和指数形式.
% \end{example}

% \begin{solution}
% 	$r=|z|=\sqrt{12+4}=4$.
% 	由于 $z$ 在第三象限,因此
% 		\[\arg z=\arctan\frac{-2}{-\sqrt{12}}-\pi=\frac\pi6-\pi=-\frac{5\pi}6.\]
% 	故
% 		\[z=4\left[\cos\left(-\frac{5\pi}6\right)+i\sin\left(-
% 		\frac{5\pi}6\right)\right]=4e^{-\frac{5\pi i}6}.\]
% \end{solution}

% \begin{example}
% 	将 $z=\sin\dfrac\pi5+i\cos\dfrac\pi5$ 化成三角形式和指数形式.
% \end{example}
% \begin{solution}
% 	\[|z|=1,\quad {
% 		\arg z=\arctan\frac{\cos(\pi/5)}{\sin(\pi/5)}=\arctan\cot\frac\pi 5=\frac\pi2-\frac\pi5=\frac{3\pi}{10}.
% 	}\]
% 	{因此 $z=\displaystyle\cos\frac{3\pi}{10}+i\sin\frac{3\pi}{10}=e^{\frac{3\pi i}{10}}$.}
% \end{solution}
% 	\begin{proofblock}{另解}
% 	\[
% 	z=\sin\frac\pi5+i\cos\frac\pi5
% 	{=\cos\left(\frac\pi2-\frac\pi5\right)+i\sin\left(\frac\pi2-\frac\pi5\right)}
% 	{=\cos\frac{3\pi}{10}+i\sin\frac{3\pi}{10}=e^{\frac{3\pi i}{10}}.}
% 	\]
% \end{proofblock}

% 求复数的三角或指数形式时, 我们只需要任取一个辐角就可以了, 不要求必须是主辐角.

% \begin{exercise}
% 	将 $z=\sqrt 3-3i$ 化成三角形式和指数形式.
% \end{exercise}

% \begin{answer}
% 	$\displaystyle z=2\sqrt3\left(\cos\frac{-\pi}3+i\sin\frac{-\pi}3\right)
% 	=2\sqrt3e^{-\frac{\pi i}3}$, 写成 $\dfrac{5\pi}3$ 也可以.
% \end{answer}

% 两个模相等的复数之和的三角/指数形式形式较为简单.
% \[e^{i\theta}+e^{i\varphi}=2\cos\frac{\theta-\varphi}2e^{\frac{\theta+\varphi}2i}.\]

% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\draw[cstaxis] (-1.5,0)--(2.5,0);
% 		\draw[cstaxis] (0,-0.4)--(0,2.5);
% 		\draw[cstcurve,cstarrowto,dcolora] (0,0)--(-0.8,1.72);
% 		\draw[cstdash] (-0.8,1.72)--(1,2.32)--(1.8,0.6)--(0.5,1.16);
% 		\draw[thick] (0.7,1.074)--(0.786,1.274)--(0.586,1.36);
% 		\coordinate (A) at (2,0);
% 		\coordinate (B) at (0,0);
% 		\coordinate (C) at (1.8,0.6);
% 		\draw[thick,dcolorb] pic [draw, "$\varphi$", angle eccentricity=1.4, angle radius=0.7cm] {angle};
% 		\coordinate (A) at (1.8,0.6);
% 		\coordinate (C) at (1,2.32);
% 		\draw[cstcurve,dcolora,cstarrowto] (B)--(A);
% 		\draw[cstcurve,dcolorb,cstarrowto] (B)--(C);
% 		\draw[thick,dcolorb] pic [draw, "$\frac{\theta-\varphi}2$", angle eccentricity=1.7] {angle};
% 		\draw
% 		(-0.2,-0.3) node {$0$}
% 		(2.1,0.7) node[dcolora] {$e^{i\varphi}$}
% 		(-1.1,1.7) node[dcolora] {$e^{i\theta}$};
% 	\end{tikzpicture}
% \end{center}
% \begin{example}
% 	如果 $|z|=1,\arg z=\theta$, 则 $z+1=2\cos\dfrac\theta2 e^{\frac{\theta i}2}$.
% \end{example}

% \section{复数的乘除、乘幂与方根}

% \subsection{复数的乘除与三角/指数表示}

% 三角/指数形式在进行复数的乘法、除法和幂次计算中非常方便.

% \begin{theorem}
% 	设
% 	\[z_1=r_1(\cos\theta_1+i\sin\theta_1)=r_1e^{i\theta_1},\]
% 	\[z_2=r_2(\cos\theta_2+i\sin\theta_2)=r_2e^{i\theta_2}\neq 0,\]
% 	则
% 	\begin{align*}
% 		z_1z_2&=r_1r_2[\cos(\theta_1+\theta_2)+i\sin(\theta_1+\theta_2)]=r_1r_2e^{i(\theta_1+\theta_2)},\\
% 		\frac{z_1}{z_2}&=\frac{r_1}{r_2}[\cos(\theta_1-\theta_2)+i\sin(\theta_1-\theta_2)]=\frac{r_1}{r_2}e^{i(\theta_1-\theta_2)}.
% 	\end{align*}
% \end{theorem}

% 换言之,
% \[|z_1z_2|=|z_1|\cdot|z_2|,\quad\abs{\frac{z_1}{z_2}}=\frac{|z_1|}{|z_2|},\]
% \[\Arg(z_1z_2)=\Arg z_1+\Arg z_2,\quad
% \Arg\left(\frac{z_1}{z_2}\right)=\Arg z_1-\Arg z_2.\]
% \emph{关于多值函数的等式的含义是指: 两边所能取到的值构成的集合相等.}
% 例如此处关于辐角的等式的含义是:
% \[\Arg(z_1z_2)=\set{\theta_1+\theta_2:\theta_1\in\Arg z_1,\theta_2\in\Arg z_2}.\]
% \[\Arg\left(\frac{z_1}{z_2}\right)=\set{\theta_1-\theta_2:\theta_1\in\Arg z_1,\theta_2\in\Arg z_2}.\]

% 注意上述等式中 $\Arg$ 不能换成 $\arg$, 也就是说
% \[\arg(z_1z_2)=\arg z_1+\arg z_2,\quad
% \arg\left(\frac{z_1}{z_2}\right)=\arg z_1-\arg z_2\]
% \emph{不一定成立}.
% 这是因为 $\arg z_1\pm\arg z_2$ 有可能不落在区间 $(-\pi,\pi]$ 上.
% 例如 $z_1=z_2=e^{0.99\pi i}$, $z_1z_2=e^{1.98\pi i}$,
% \[\arg z_1+\arg z_2=0.99\pi+0.99\pi=1.98\pi,\]
% \[\arg(z_1z_2)=-0.02\pi.\]

% \begin{proof}
% 	\begin{align*}
% 		z_1z_2&=r_1(\cos\theta_1+i\sin\theta_1)\cdot
% 		r_2(\cos\theta_2+i\sin\theta_2)\\
% 		&{=r_1r_2\bigl[(\cos\theta_1\cos\theta_2-\sin\theta_1\sin\theta_2)
% 		+i(\cos\theta_1\sin\theta_2+\sin\theta_1\cos\theta_2)\bigr]}\\
% 		&{=r_1r_2\bigl[\cos(\theta_1+\theta_2)+i\sin(\theta_1+\theta_2)\bigr]}
% 	\end{align*}
% 	{因此乘法情形得证.}

% 	{设 $\dfrac{z_1}{z_2}=re^{i\theta}$,则由乘法情形可知
% 		\[rr_2=r_1,\quad \theta+\Arg z_2=\Arg z_1.\]因此 $r=\dfrac{r_1}{r_2},\theta=\theta_1-\theta_2+2k\pi$, 其中 $k\in\BZ$.\qedhere}
% \end{proof}

% 从该定理可以看出, 乘以复数 $z=re^{i\theta}$ 可以理解为模放大为 $r$ 倍, 并沿逆时针旋转角度 $\theta$.
% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\draw[cstaxis] (-2,0)--(3,0);
% 		\draw[cstaxis] (0,-0.4)--(0,4);
% 		\coordinate (A) at (1.6,0);
% 		\coordinate (B) at (0,0);
% 		\coordinate (C) at (0.96,1.92);
% 		\draw[cstcurve,dcolora,cstarrowto] (B)--(A);
% 		\draw[cstcurve,dcolora,cstarrowto] (B)--(C);
% 		\draw[cstcurve,dcolora] pic [draw, "$\theta$", angle eccentricity=1.4] {angle};
% 		\coordinate (A) at (1.3,1.6);
% 		\coordinate (C) at (-1.14,2.52);
% 		\draw[cstcurve,dcolorb,cstarrowto] (B)--(A);
% 		\draw[cstcurve,dcolorb,cstarrowto] (B)--(C);
% 		\draw[cstcurve,dcolorb] pic [draw, "$\theta$", angle eccentricity=1.3, angle radius= 0.7cm] {angle};
% 		\draw 
% 		(1.52,2.08) node[dcolora] {$z=re^{i\theta}$}
% 		(1.6,-0.3) node[dcolora] {$1$}
% 		(1.6,1.5) node[dcolorb] {$z_1$}
% 		(-1.1,2.7) node[dcolorb] {$zz_1$};
% 	\end{tikzpicture}
% \end{center}

% \begin{example}
% 	已知正三角形的两个顶点为 $z_1=1$ 和 $z_2=2+i$, 求它的另一个顶点.
% \end{example}

% \begin{solution}
% 	由于 $\overrightarrow{Z_1Z_3}$ 为 $\overrightarrow{Z_1Z_2}$ 顺时针或逆时针旋转 $\dfrac\pi3$,
% 	\begin{center}
% 		\begin{tikzpicture}[framed]
% 			\draw[cstaxis] (-0.3,0)--(2.8,0);
% 			\draw[cstaxis] (0,-0.5)--(0,1.4);
% 			\draw[cstcurve,dcolorb] (1,0)--(2,1)--(0.634,1.366)--cycle;
% 			\draw[cstdash,dcolorb] (1,0)--(2.366,-0.366)--(2,1);
% 			\draw 
% 			(1.0,-0.2) node[dcolora] {$z_1$}
% 			(2.3,1) node[dcolora] {$z_2$}
% 			(0.4,1.2) node[dcolora] {$z_3$}
% 			(2.6,-0.3) node[dcolora] {$z_3'$};
% 		\end{tikzpicture}
% 	\end{center}
% \end{solution}

% \begin{solutionc}
% 	因此
% 	\begin{align*}
% 		z_3-z_1&=(z_2-z_1)\exp\left(\pm\frac{\pi i}3\right)
% 		{=(1+i)\left(\half\pm\frac{\sqrt3}2i\right)}\\
% 		&{=\frac{1-\sqrt3}2+\frac{1+\sqrt3}2i\ \text{或}\ \frac{1+\sqrt3}2+\frac{1-\sqrt3}2i,}
% 	\end{align*}
% 	{
% 		\[z_3=\frac{3-\sqrt3}2+\frac{1+\sqrt3}2i\ \text{或}\ \frac{3+\sqrt3}2+\frac{1-\sqrt3}2i.\]
% 	}
% \end{solutionc}

% \begin{example}
% 	设 $AD$ 是 $\triangle ABC$ 的角平分线, 证明 $\dfrac{AB}{AC}=\dfrac{DB}{DC}$.
% \end{example}

% \begin{proofs}
% 	不妨设 $A=0,B=z,C=1$.
% 	则 $D=(1-\lambda)z+\lambda$, 其中 $\lambda=\dfrac{DB}{BC}\in(0,1)$.
% 	\begin{center}
% 		\begin{tikzpicture}[framed]
% 			\draw[cstaxis] (-0.3,0)--(2.8,0);
% 			\draw[cstaxis] (0,-.4)--(0,1.4);
% 			\draw[cstcurve,dcolorb] (0,0)--(2.094,0.798);
% 			\draw[cstcurve,dcolorb] (0,0)--(2,1.5)--(2.2,0)--cycle;
% 			\draw 
% 			(-0.2,-0.2) node[dcolora] {$A$}
% 			(2.6,1.5) node[dcolora] {$B=z$}
% 			(2.2,-0.3) node[dcolora] {$C=1$}
% 			(2.4,0.8) node[dcolora] {$D$};
% 		\end{tikzpicture}
% 	\end{center}
% \end{proofs}

% \begin{proofc}
% 	由于 $\angle BAD=\angle DAC$, 因此 $\dfrac{z}{(1-\lambda)z+\lambda}$ 是 $\dfrac{(1-\lambda)z+\lambda}{1}$ 的正实数倍.
% 	{
% 		即
% 		\[\dfrac{((1-\lambda)z+\lambda)^2}{z}=(1-\lambda)^2z+\dfrac{\lambda^2}z+2\lambda(1-\lambda)\in\BR.\]
% 		从而
% 		\[(1-\lambda)^2z+\dfrac{\lambda^2}z=(1-\lambda)^2\ov z+\dfrac{\lambda^2}{\ov z},\qquad
% 		((1-\lambda)^2|z|^2-\lambda^2)(z-\ov z)=0.\]
% 		显然 $z\neq \ov z$. 又因为 $0<\lambda<1$, 故
% 		\[\frac{AB}{AC}=|z|=\frac{\lambda}{1-\lambda}
% 		=\frac{DB}{BC-DB}=\frac{DB}{DC}.\qedhere\]
% 	}
% \end{proofc}

% \subsection{复数的乘幂}

% 设 $z=r(\cos\theta+i\sin\theta)=re^{i\theta}\neq0$.
% 根据复数三角/指数形式的乘法和除法运算法则, 我们有
% \begin{alertblock@}
% 	\[z^n=r^n(\cos{n\theta}+i\sin{n\theta})=r^ne^{in\theta},\quad\forall n\in\BZ.\]
% \end{alertblock@}
% 特别地, 当 $r=1$ 时, 我们得到\emph{棣莫弗公式}
% \[(\cos\theta+i\sin\theta)^n=\cos{n\theta}+i\sin{n\theta}.\]

% 对棣莫弗公式左侧进行二项式展开可以得到
% \begin{align*}
% 	\cos(2\theta)&=\hphantom{1}2\cos^2\theta-\hphantom{1}1,\\
% 	\cos(3\theta)&=\hphantom{1}4\cos^3\theta-\hphantom{1}3\cos\theta,\\
% 	\cos(4\theta)&=\hphantom{1}8\cos^4\theta-\hphantom{1}8\cos^2\theta+1,\\
% 	\cos(5\theta)&=16\cos^5\theta-20\cos^3\theta+5\cos\theta.
% \end{align*}
% 一般地, 可以证明 $\cos{n\theta}$ 是 $\cos\theta$ 的 $n$ 次多项式,
% 这个多项式
% \[g_n(T)=2^{n-1}T^n-n2^{n-3}T^{n-2}+\cdots\]
% 叫做\emph{切比雪夫多项式}.
% 它在计算数学的逼近理论中有着重要作用.

% \begin{example}
% 	求 $(1+i)^n+(1-i)^n$.
% \end{example}

% \begin{solution}
% 	由于 $\displaystyle 1+i=\sqrt2\left(\cos\frac\pi4+i\sin\frac\pi4\right),\ 
% 	1-i=\sqrt2\left(\cos\frac\pi4-i\sin\frac\pi4\right)$,
% 	{%
% 		因此
% 		\begin{align*}
% 			&\peq(1+i)^n+(1-i)^n\\
% 			&=2^{\frac n2}\left(\cos\frac{n\pi}4+i\sin\frac{n\pi}4+\cos\frac{n\pi}4-i\sin\frac{n\pi}4\right)
% 			{=2^{\frac n2+1}\cos\frac{n\pi}4.}
% 		\end{align*}
% 	}
% \end{solution}

% \begin{exercise}
% 	求 $(\sqrt3+i)^{2022}=$\fillblank[2cm]{{\emph{$-2^{2022}$}}}.
% \end{exercise}

% \subsection{复数的方根}

% 我们利用复数乘幂公式来计算复数 $z$ 的 \emph{$n$ 次方根 $\sqrt[n]z$}.
% 设
% \[w^n=z=re^{i\theta}\neq0,\quad w=\rho e^{i\varphi},\]
% 则
% \[w^n=\rho^n(\cos{n\varphi}+i\sin{n\varphi})=r(\cos\theta+i\sin\theta).\]
% 比较两边的模可知 $\rho^n=r,\rho=\sqrt[n]r$.

% 为了避免记号冲突, 当 $r$ 是正实数时, $\sqrt[n]r$ 默认表示 $r$ 的唯一的 $n$ 次正实根, 称之为\emph{算术根}.

% 由于 $n\varphi$ 和 $\theta$ 的正弦和余弦均相等, 因此存在整数 $k$ 使得
% \[n\varphi=\theta+2k\pi,\quad \varphi=\frac{\theta+2k\pi}n.\]

% 故
% \begin{alertblock@}
% \begin{align*}
% 	&w=w_k=\sqrt[n]r\exp\frac{(\theta+2k\pi)i}n\\
% 	&\hspace{42pt}=\sqrt[n]r\left(\cos\frac{\theta+2k\pi}n+i\sin\frac{\theta+2k\pi}n\right).
% \end{align*}
% \end{alertblock@}

% 不难看出, $w_k=w_{k+n}$, 而 $w_0,w_1,\dots,w_{n-1}$ 两两不同.
% 因此只需取 \emph{$k=0,1,\dots,n-1$}.
% 故\emph{任意一个非零复数的 $n$ 次方根有 $n$ 个值}.

% 这些根的模都相等, 且 $w_k$ 和 $w_{k+1}$ 辐角相差 $\dfrac{2\pi}n$.
% 因此\emph{它们是以原点为中心, $\sqrt[n]r$ 为半径的圆的内接正 $n$ 边形的顶点}.

% \begin{example}
% 	求 $\sqrt[4]{1+i}$.
% \end{example}

% \begin{solution}
% 	由于 $1+i=\sqrt2\exp\left(\dfrac{\pi i}4\right)$,
% 	{%
% 		因此
% 		\[\sqrt[4]{1+i}=\sqrt[8]2\exp\frac{(\frac\pi4+2k\pi)i}4,\quad k=0,1,2,3.\]%
% 		所以该方根所有值为
% 		\[w_0=\sqrt[8]2e^{\frac{\pi i}{16}},\quad
% 		w_1=\sqrt[8]2e^{\frac{9\pi i}{16}},\quad
% 		w_2=\sqrt[8]2e^{\frac{17\pi i}{16}},\quad
% 		w_3=\sqrt[8]2e^{\frac{25\pi i}{16}}.\]
% 	}
% \end{solution}

% 显然 $w_{k+1}=iw_k$,
% 所以 $w_0,w_1,w_2,w_3$ 形成了一个正方形.
% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\draw[cstaxis] (-2,0)--(2,0);
% 		\draw[cstaxis] (0,-1.8)--(0,1.8);
% 		\draw[cstcurve,thick,dcolora,cstarrowto] (0,0)--(1.5,0.3);
% 		\draw[cstcurve,thick,dcolora,cstarrowto] (0,0)--(-1.5,-0.3);
% 		\draw[cstcurve,thick,dcolora,cstarrowto] (0,0)--(-0.3,1.5);
% 		\draw[cstcurve,thick,dcolora,cstarrowto] (0,0)--(0.3,-1.5);
% 		\draw[cstcurve,dcolorb] (1.5,0.3)--(-0.3,1.5)--(-1.5,-0.3)--(0.3,-1.5)--cycle;
% 		\draw[cstcurve,thick,dcolora,cstarrowto] (0,0)circle(1.54);
% 		\draw
% 		(-0.2,-0.3) node {$0$}
% 		(1.8,0.3) node[dcolorb] {$w_0$}
% 		(-0.4,1.7) node[dcolorb] {$w_1$}
% 		(-1.8,-0.3) node[dcolorb] {$w_2$}
% 		(0.3,-1.7) node[dcolorb] {$w_3$};
% 	\end{tikzpicture}
% \end{center}

% \begin{exercise}
% 	求 $\sqrt[6]{-1}=$\fillblank[5cm][2mm]{{$\pm\dfrac{\sqrt3+i}2,\pm i,\pm\dfrac{\sqrt3-i}2$}}.
% \end{exercise}

% 注意当 $|n|\ge 2$ 时, \emph{$\Arg(z^n)=n\Arg z$ 不成立}.
% 这是因为
% \[\Arg(z^n)=n\arg z+2k\pi,\quad k\in\BZ,\]
% \[n\Arg z=n\arg z+2nk\pi,\quad k\in\BZ.\]
% 不过我们总有
% \[\Arg \sqrt[n]z=\dfrac1n\Arg z=\dfrac{\arg z+2k\pi}n,\quad k\in\BZ,\]
% 其中左边表示 $z$ 的所有 $n$ 次方根的所有辐角.

% 现在我们来看三次方程 $x^3+px+q=0$ 的根, $p\neq 0$.
% \[x=u+v,\quad u^3=-\frac q2+\sqrt{\Delta},\quad uv=-\frac p3.\]
% \begin{enumerate}
% 	\item 如果 $\Delta>0$, 设实数 $\alpha$ 满足 $\alpha^3=-q/2+\sqrt{\Delta}$, $\omega=e^{2\pi i/3}$.
% 				那么
% 		\[u=\alpha,\alpha\omega,\alpha\omega^2,\qquad
% 		x=\alpha-\frac p{3\alpha},\ \alpha\omega-\frac p{3\alpha} \omega^2,\ \alpha\omega^2-\frac p{3\alpha} \omega.\]
% 				容易证明后两个根都是虚数.
% 	\item 如果 $\Delta<0$, 则 $p<0$, $|u|^2=-p/3$. 从而 $v=\ov u$.
% 		设 $\sqrt[3]{-q/2+\sqrt{\Delta}}=u_1,u_2,u_3$,
% 				则我们得到 $3$ 个实根
% 		\[x=u_1+\ov{u_1},\ u_2+\ov{u_2},\ u_3+\ov{u_3}.\]
% \end{enumerate}

% \section{曲线和区域}

% \subsection{复数表平面曲线}

% 很多的平面图形能用复数形式的方程来表示, 这种表示方程有些时候会显得更加直观和易于理解.

% \begin{example*}
% 	$|z+i|=2$.

% 	{该方程表示与 $-i$ 的距离为 $2$ 的点全体, 即圆心为 $-i$ 半径为 $2$ 的圆.}

% 	{一般的圆方程为 $|z-z_0|=R$, 其中 $z_0$ 是圆心, $R$ 是半径.}
% 	{
% 	\begin{center}
% 		\begin{tikzpicture}
% 			\draw[cstaxis] (-1.5,0)--(1.5,0);
% 			\draw[cstaxis] (0,-1.8)--(0,1);
% 			\draw[cstcurve,dcolora] (0,-0.5) circle(1);
% 			\fill[cstdot,dcolorb] (0,-0.5) circle;
% 			\draw
% 			(-0.4,-0.5) node[dcolorb] {$-i$};
% 		\end{tikzpicture}
% 	\end{center}}
% \end{example*}

% \begin{example*}
% 	$|z-2i|=|z+2|$.

% 	{该方程表示与 $2i$ 和 $-2$ 的距离相等的点, 即二者连线的垂直平分线.两边同时平方化简可得 $x+y=0$.}
% 	{
% 	\begin{center}
% 		\begin{tikzpicture}[scale=.8]
% 			\draw[cstaxis] (-1.5,0)--(1.5,0);
% 			\draw[cstaxis] (0,-1.5)--(0,1.5);
% 			\draw[cstcurve,dcolora] (-1.2,1.2)--(1.2,-1.2);
% 			\fill[cstdot,dcolorb] (0,1) circle;
% 			\fill[cstdot,dcolorb] (-1,0) circle;
% 			\draw
% 				(-1,-0.3) node[dcolorb] {$-2$}
% 				(0.4,1) node[dcolorb] {$2i$};
% 		\end{tikzpicture}
% 	\end{center}}
% \end{example*}

% \begin{example*}
% 	$\Im(i+\ov z)=4$.

% 	{设 $z=x+yi$, 则 $\Im(i+\ov z)=1-y=4$, 因此 $y=-3$.}
% \end{example*}

% \begin{example*}
% 	$|z-z_1|+|z-z_2|=2a$.
% 	\begin{itemize}
% 		\item 当 $2a>|z_1-z_2|$ 时, 该方程表示以 $z_1,z_2$ 为焦点, $a$ 为长半轴的椭圆;
% 		\item 当 $2a=|z_1-z_2|$ 时, 该方程表示连接 $z_1,z_2$ 的线段;
% 		\item 当 $2a<|z_1-z_2|$ 时, 该方程表示空集.
% 	\end{itemize}
% \end{example*}
% \begin{example*}
% 	$|z-z_1|-|z-z_2|=2a$.
% 	\begin{itemize}
% 		\item 当 $2a<|z_1-z_2|$ 时, 该方程表示以 $z_1,z_2$ 为焦点, $a$ 为实半轴的双曲线的一支;
% 		\item 当 $2a=|z_1-z_2|$ 时, 该方程表示以 $z_2$ 为起点, 与 $z_2,z_1$ 连线反向的射线;
% 		\item 当 $2a>|z_1-z_2|$ 时, 该方程表示空集.
% 	\end{itemize}
% \end{example*}

% \begin{exercise}
% 	$z^2+\ov z^2=1$ 和 $z^2-\ov z^2=i$ 分别表示什么图形?
% \end{exercise}

% \begin{answer}
% 	双曲线 $x^2-y^2=\dfrac12$ 和双曲线 $xy=\dfrac14$.
% \end{answer}

% \subsection{区域的定义}

% 为了引入极限的概念, 我们需要考虑点的邻域.
% 类比于高等数学中的邻域和去心邻域, 我们在复变函数中, 称开圆盘
% \[U(z_0,\delta)=\set{z:|z-z_0|<\delta}\]
% 为 $z_0$ 的一个 \emph{$\delta$-邻域},
% 称去心开圆盘
% \[\Uc(z_0,\delta)=\set{z:0<|z-z_0|<\delta}\]
% 为 $z_0$ 的一个\emph{去心 $\delta$-邻域}.


% \begin{center}
% 	\begin{tikzpicture}
% 		\filldraw[cstcurve,dcolorb,cstfill] (0,0) circle(1);
% 		\draw[cstcurve,cstarrowto,dcolora] (0,0)--(0.8,0.6);
% 		\fill[cstdot,dcolora] (0,0) circle;
% 		\filldraw[cstcurve,dcolorb,cstfill] (3,0) circle(1);
% 		\draw[cstcurve,cstarrowto,dcolora] (3,0)--(3.8,0.6);
% 		\filldraw[cstdote,draw=dcolora] (3,0) circle;
% 		\draw
% 		(-0.3,0) node[dcolora] {$z_0$}
% 		(2.7,0) node[dcolora] {$z_0$}
% 		(0.5,0.1) node[dcolora] {$\delta$}
% 		(3.5,0.1) node[dcolora] {$\delta$};
% 	\end{tikzpicture}
% \end{center}

% 设 $G$ 是复平面的一个子集, $z_0\in\BC$.
% 它们的位置关系有三种可能:
% \begin{enumerate}
% 	\item 如果存在 $z_0$ 的一个邻域 $U$ 完全包含在 $G$ 中, 则称 $z_0$ 是 $G$ 的一个\emph{内点}.
% 	\item 如果存在 $z_0$ 的一个邻域 $U$ 完全不包含在 $G$ 中, 则称 $z_0$ 是 $G$ 的一个\emph{外点}.
% 	\item 如果 $z_0$ 的任何一个邻域 $U$, 都有属于和不属于 $G$ 的点, 则称 $z_0$ 是 $G$ 的一个\emph{边界点}.
% \end{enumerate}
% 显然内点都属于 $G$, 外点都不属于 $G$, 而边界点则都有可能.
% 这类比于区间的端点和区间的关系.


% \begin{center}
% 	\begin{tikzpicture}
% 		\filldraw[cstcurve,dcolora,cstfill,smooth] plot coordinates {(0,-0.8) (1,-0.8) (1.5,0) (1,0.6) (0,0.8) (-1,0.7) (-1.2,0) (-1,-0.6) (0,-0.8)};
% 		\draw[cstcurve,dcolorb] (-0.5,0) circle (0.5);
% 		\draw[cstcurve,dcolorc] (1.43,0) circle (0.5);
% 		\draw[cstcurve,black] (3,0) circle (0.5);
% 		\fill[cstdot,dcolorb] (-0.5,0) circle;
% 		\fill[cstdot,dcolorc] (1.5,0) circle;
% 		\fill[cstdot,black] (3,0) circle;
% 		\draw
% 		(0.5,0) node[dcolora] {$G$}
% 		(-0.5,0.2) node[dcolorb] {$z_0$}
% 		(1.75,0) node[dcolorc] {$z_0$}
% 		(3.3,0) node {$z_0$};
% 	\end{tikzpicture}
% \end{center}

% 如果 $G$ 的所有点都是内点, 也就是说, $G$ 的边界点都不属于它, 称 $G$ 是一个\emph{开集}.
% 例如
% \[|z-z_0|<R,\quad 1<\Re z<3,\quad\frac\pi4<\arg z<\dfrac{3\pi}4\] 都是开集.
% 如果 $G$ 的所有边界点都属于 $G$, 称 $G$ 是一个\emph{闭集}.
% 这等价于它的补集是开集.

% 直观上看: 开集往往由 $>,<$ 的不等式给出, 闭集往往由 $\ge,\le$ 的不等式给出.
% 不过注意这并不是绝对的.
% 例如 $|z+1|+|z-1|\ge 1$ 表示整个复平面.

% 如果 $D$ 可以被包含在某个开圆盘 $U(0,R)$ 中, 则称它是\emph{有界}的.
% 否则称它是\emph{无界}的.

% \begin{definition}
% 	如果开集 $D$ 的任意两个点之间都可以用一条完全包含在 $D$ 中的折线连接起来, 则称 $D$ 是一个\emph{区域}.
% 	{也就是说, 区域是连通的开集.}
% \end{definition}

% 观察下侧的图案, 青色部分是一个区域(不包含红色部分).
% 红色的线条和点是它的边界.
% 区域和它的边界一起构成了\emph{闭区域}, 记作 $\ov D$.
% 它是一个闭集.


% \begin{center}
% 	\begin{tikzpicture}
% 		\filldraw[cstcurve,dcolora,cstfill,smooth] plot coordinates {(0,-1.2) (1.5,-1.2) (2.3,0) (1.5,0.9) (0,1.2) (-1.5,1) (-1.8,0) (-1.5,-0.9) (0,-1.2)};
% 		\filldraw[cstcurve,dcolora,fill=white,smooth] plot coordinates {(-1.4,0) (-1,0.6) (-0.6,0) (-1.2,-0.5) (-1.4,0)};
% 		\filldraw[cstcurve,dcolora,fill=white] (0.5,0.3) circle (0.3);
% 		\fill[cstdot,dcolora] (1.5,0) circle;
% 		\fill[cstdot,dcolora] (1.6,-0.5) circle;
% 		\draw[cstcurve,dcolora,smooth] plot coordinates {(1,0.5) (1.2,0.3) (1.2,-0.3) (1.4,0.5)};
% 		\draw[cstcurve,dcolorc] (-1,0.8)--(-0.2,0.5)--(0.2,-0.5)--(1,-0.8);
% 		\draw
% 		(-1.2,0.8) node[dcolorc] {$z_1$}
% 		(1.3,-0.8) node[dcolorc] {$z_2$};
% 	\end{tikzpicture}
% \end{center}
% 数学中边界的概念与日常所说的边界是两码事. 例如区域 $|z|>1$ 的边界是 $|z|=1$, 其闭区域是 $|z|\ge 1$.

% 复平面上的区域大多由复数的实部、虚部、模和辐角的不等式所确定.
% 这些区域对应的闭区域是什么?

% \begin{center}
% 	\begin{tikzpicture}
% 		\draw[cstaxis](-1.5,0.3)--(1.5,0.3);
% 		\draw[cstaxis](0,-0.6)--(0,1.4);
% 		\fill[cstfille,pattern color=dcolorb] (-1.2,0.3) rectangle (1.2,1.1);
% 		\fill[cstfille,pattern color=dcolora] (-1.2,0.3) rectangle (1.2,-0.5);
% 		\draw[cstaxis](2.5,0)--(5.5,0);
% 		\draw[cstaxis](4,-1.1)--(4,1.3);
% 		\fill[cstfille,pattern color=dcolorb] (2.8,-1) rectangle (4,1);
% 		\fill[cstfille,pattern color=dcolora] (4,1) rectangle (5.2,-1);
% 		\draw[cstaxis](6.5,0)--(8.5,0);
% 		\draw[cstaxis](7,-1)--(7,1.2);
% 		\fill[cstfille,pattern color=dcolorb] (7.2,-0.9) rectangle (8,0.9);
% 		\draw
% 		(-0.05,1.5) node[dcolorb] {上半平面 $\Im z>0$}
% 		(-0.05,-0.9) node[dcolora] {下半平面 $\Im z<0$}
% 		(3.1,1.6) node[dcolorb,align=center] {左半平面\\$\Re z<0$}
% 		(4.9,1.6) node[dcolora,align=center] {右半平面\\$\Re z>0$}
% 		(7.7,1.7) node[dcolorb,align=center] {竖直带状区域\\$x_1<\Re z<x_2$};
% 	\end{tikzpicture}
% \end{center}

% \begin{center}
% 	\begin{tikzpicture}
% 		\draw[cstaxis](-1.5,1.2)--(1.5,1.2);
% 		\draw[cstaxis](0,1)--(0,2.2);
% 		\fill[cstfille,pattern color=dcolora] (-1.2,1.3) rectangle (1.2,2);
% 		\draw[cstaxis](2,0)--(4,0);
% 		\draw[cstaxis](2.5,-0.2)--(2.5,1.3);
% 		\fill[cstfille,pattern color=dcolorb] (2.5,0)--(3.25,1.299) arc(60:10:1.5)--cycle;
% 		\filldraw[cstcurve,dcolora,cstfill] (6.2,1) circle (1);
% 		\filldraw[cstcurve,dcolora,cstfill,fill=white] (6.2,1) circle (0.5);
% 		\draw[cstaxis](4.9,1)--(7.5,1);
% 		\draw[cstaxis](6.2,-0.2)--(6.2,2.4);
% 		\draw
% 		(0,0.5) node[dcolora,align=center] {水平带状区域\\$y_1<\Im z<y_2$}
% 		(3.4,1.8) node[dcolorb,align=center] {角状区域\\$\alpha_1<\arg z<\alpha_2$}
% 		(8.2,2) node[dcolora,align=center] {圆环域\\$r<|z|<R$};
% 	\end{tikzpicture}
% \end{center}

% \subsection{区域的特性}

% 设 $x(t),y(t),t\in[a,b]$ 是两个连续函数,
% 则参变量方程
% $\begin{cases}x=x(t),& \\y=y(t),&\end{cases}t\in[a,b]$ 定义了一条\emph{连续曲线}.
% 这也等价于 $C:z=z(t)=x(t)+iy(t),t\in[a,b]$.

% 如果除了两个端点有可能重叠外, 其它情形不会出现重叠的点, 则称 $C$ 是\emph{简单曲线}.
% 如果还满足两个端点重叠, 即 $z(a)=z(b)$, 则称 $C$ 是\emph{简单闭曲线}, 也简称为\emph{闭路}.


% \begin{center}
% 	\begin{tikzpicture}
% 		\draw[cstaxis](-0.3,0)--(9.5,0);
% 		\draw[cstaxis](0,-0.3)--(0,2.5);
% 		\draw[cstcurve,dcolora,smooth] plot coordinates {(0.2,0.9) (1,1.6) (2,0.6) (3,0.9)};
% 		\draw[cstcurve,dcolorb,smooth] plot coordinates {(4,0.5) (4.6,0.9) (5.3,2) (4.7,2.5) (3.7,2) (4.7,0.9) (5.7,0.5)};
% 		\draw[cstcurve,dcolorc,smooth,smooth] plot coordinates {(7,1) (7.5,0.4) (8,0.2) (8.5,0.4) (9,1) (8.5,1.6) (8,1.8) (7.5,1.7) (7,1)};
% 		\draw
% 		(0.5,0.7) node[dcolora] {$z(a)$}
% 		(3,1.2) node[dcolora] {$z(b)$};
% 	\end{tikzpicture}
% \end{center}

% 闭路 $C$ 把复平面划分成了两个区域, 一个有界一个无界.
% 分别称这两个区域是 $C$ 的\emph{内部}和\emph{外部}.
% $C$ 是它们的公共边界.

% 这件事情的严格证明是十分困难的 (Veblen 1905).


% \begin{center}
% 	\begin{tikzpicture}
% 		\fill[cstfille] (-2,-2) rectangle (1.5,1.5);
% 		\filldraw[cstcurve,dcolora,smooth,cstfill] plot coordinates {(-1.5,0) (-1,-0.5) (0,-1) (0.7,-1) (0.9,0) (0,0.8) (-1,0.8) (-1.5,0)};
% 	\end{tikzpicture}
% \end{center}

% 在前面所说的几个区域的例子中, 我们在区域中画一条闭路.
% 除了圆环域之外, 闭路的内部仍然包含在这个区域内.

% 	\begin{definition}
% 		如果区域 $D$ 中的任一闭路的内部都包含在 $D$ 中, 则称 $D$ 是\emph{单连通域}.
% 		否则称之为\emph{多连通域}.
% \end{definition}

% 单连通域内的任一闭路可以连续地变形成一个点.
% 这也等价于: 设 $\ell_1,\ell_2$ 是从 $A$ 到 $B$ 的两条连续曲线, 则 $\ell_1$ 可以连续地变形为 $\ell_2$ 且保持端点不动.
% \begin{center}
% 	\begin{tikzpicture}
% 		\filldraw[cstcurve,dcolora,smooth,cstfill] plot coordinates {(-2.2,0) (-1.5,-0.7) (0,-1.5) (1,-1.5) (1.4,0) (0,1.2) (-1.5,1.2) (-2.2,0)};
% 		\draw[cstcurve,dcolorc,smooth] plot coordinates {(-1.6,0) (-1.2,-0.5) (-0.3,-1) (0,-0.5) (-0.3,0.2) (-1.2,0.7) (-1.6,0)};
% 		\filldraw[cstcurve,dcolora,smooth,fill=white] plot coordinates {(-1.4,0) (-1,-0.3) (-0.8,0) (-1,0.3) (-1.4,0)};
% 		\filldraw[cstcurve,dcolora,smooth,fill=white] plot coordinates {(-0.8,-0.4) (-0.4,-0.7) (-0.2,-0.4) (-0.4,-0.1) (-0.8,-0.4)};
% 		\draw[cstcurve,dcolora,smooth] plot coordinates {(-0.7,1) (-0.2,0.9) (0.1,0.7)};
% 		\draw[cstcurve,dcolora](-0.4,1.2)--(0.1,0.7);
% 		\fill[cstdot,dcolora] (0.7,0) circle;
% 		\fill[cstdot,dcolora] (1,-0.6) circle;
% 	\end{tikzpicture}
% \end{center}

% \begin{example}
% 	\enumnum1 $\Re(z^2)<1$.

% 	{设 $z=x+yi$, 则 $\Re(z^2)=x^2-y^2<1$.这是无界的单连通域.}
% \end{example}


% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\fill[cstfille] (-1.414,-1) rectangle (1.414,1);
% 		\filldraw[cstcurve,dcolora,domain=-45:45,smooth,fill=white] plot ({sec(\x)},{tan(\x)});
% 		\filldraw[cstcurve,dcolora,domain=-45:45,smooth,fill=white] plot ({-sec(\x)},{tan(\x)});
% 		\draw[cstaxis] (-2.5,0)--(2.5,0);
% 		\draw[cstaxis] (0,-1.5)--(0,1.5);
% 	\end{tikzpicture}
% \end{center}

% \begin{example}[续]
% 	\enumnum2 $|\arg z|<\dfrac\pi3$ (不含原点).
% 	{即角状区域 $-\dfrac\pi3<\arg z<\dfrac\pi3$.这是无界的单连通域.}
% \end{example}


% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\fill[cstfille] (0,0)--(1,1.732) arc(60:-60:2)--cycle;
% 		\draw[cstcurve,dcolora] (0,0)--(1.2,2.078);
% 		\draw[cstcurve,dcolora] (0,0)--(1.2,-2.078);
% 		\draw[cstaxis] (-0.5,0)--(2.5,0);
% 		\draw[cstaxis] (0,-2.2)--(0,2.2);
% 	\end{tikzpicture}
% \end{center}

% \begin{example}[续]
% 	\enumnum3 $\abs{\dfrac1z}\le3$.
% 	{即 $|z|\ge\dfrac13$.这是无界的多连通\emph{闭区域}.}
% \end{example}


% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\fill[cstfille1] (-1.6,-1.6) rectangle (1.6,1.6);
% 		\filldraw[cstcurve,dcolora,fill=white] (0,0) circle (0.5);
% 		\draw[cstaxis] (-2,0)--(2,0);
% 		\draw[cstaxis] (0,-2)--(0,2);
% 	\end{tikzpicture}
% \end{center}

% \begin{example}[续]
% 	\enumnum4 $|z+1|+|z-1|<4$.

% 	{表示一个椭圆的内部.这是有界的单连通域.}
% \end{example}

% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\filldraw[cstcurve,dcolora,cstfill] (0,0) circle (1 and {0.5*sqrt(3)});
% 		\draw[cstaxis] (-1.5,0)--(1.5,0);
% 		\draw[cstaxis] (0,-1.1)--(0,1.1);
% 	\end{tikzpicture}
% \end{center}

% \begin{thinking}
% 	$|z+1|+|z-1|\ge 1$ 表示什么集合?
% 	{\emph{整个复平面.}}
% \end{thinking}

% \section{复变函数}

% \subsection{复变函数的定义}

% 所谓的映射, 就是两个集合之间的一种对应 $f:A\to B$, 使得对于每一个 $a\in A$, 有一个唯一确定的 $b=f(a)$ 与之对应.
% \begin{itemize}
% 	\item 当 $A$ 和 $B$ 都是实数集合的子集时, 它就是一个实变函数.
% 	\item 当 $A$ 和 $B$ 都是复数集合的子集时, 它就是一个\emph{复变函数}.
% \end{itemize}

% \begin{example}
% 	$f(z)=\Re z,\arg z,|z|,z^n,\dfrac{z+1}{z^2+1}$ 都是复变函数.
% \end{example}

% \begin{definition}
% 	\begin{itemize}
% 		\item 称 $A$ 为 函数 $f$ 的\emph{定义域}.
% 		\item 称 $\set{w=f(z):z\in A}$ 为它的\emph{值域}.
% 	\end{itemize} 
% \end{definition}
% 上述函数的定义域和值域分别是什么?

% 在复变函数理论中, 我们常常会遇到\emph{多值的复变函数}, 也就是说一个 $z\in G$ 可能有多个 $w$ 与之对应.
% 例如 $\Arg z,\sqrt[n]z$ 等.
% 为了方便研究, 我们常常需要对每一个 $z$, 选取固定的一个 $f(z)$ 的值.
% 这样我们得到了这个多值函数的一个\emph{单值分支}.
% \begin{example}
% 	$\arg z$ 是无穷多值函数 $\Arg z$ 的一个单值分支.
% \end{example}

% 在考虑多值的情况下, 复变函数总有反函数.
% 如果 $f$ 和 $f^{-1}$ 都是单值的, 则称 $f$ 是\emph{一一对应}.
% \begin{example}
% 	$f(z)=z^n$ 的反函数就是 $f^{-1}(w)=\sqrt[n]{w}$.
% 	{当 $n=\pm1$ 时, $f$ 是一一对应.}
% \end{example}

% 若无特别声明, \emph{复变函数总是指单值的复变函数}.

% \subsection{映照}

% 大部分复变函数的图像无法在三维空间中表示出来.
% 为了直观理解和研究, 我们用两个复平面($z$ 复平面和 $w$ 复平面)之间的\emph{映照}来表示这种对应关系,
% 其中 
% \[w=u+iv=u(x,y)+iv(x,y)\]
% 的实部和虚部是两个二元实变函数.
% \begin{center}
% 	\begin{tikzpicture}
% 		\draw[cstaxis] (-4.5,0)--(-0.5,0);
% 		\draw[cstaxis] (-2.5,-1.5)--(-2.5,1.5);
% 		\draw[cstaxis] (0.5,0)--(4.5,0);
% 		\draw[cstaxis] (2.5,-1.5)--(2.5,1.5);
% 		\draw[cstcurve,dcolora,smooth] plot coordinates {(-4,0) (-4.2,-0.4) (-2.8,-0.9) (-2,-0.7) (-1.6,0) (-1.4,1) (-2.8,1.2) (-3.2,1) (-4,0)};
% 		\draw[cstcurve,smooth,dcolorb] plot coordinates {(1.2,0) (2,-0.5) (2.5,-0.8) (3,-0.5) (3.5,0) (3.8,0.9) (3.3,1.2) (2,0.8) (1.2,0)};
% 		\draw[cstdash,smooth,dcolorc,cstarrowto] (-2,0.8) to [bend left=25] (2.8,0.7);
% 		\draw[cstdash,smooth,dcolorc,cstarrowto] (-2.3,0.5)to [bend right=15] (2.2,-0.3);
% 		\draw[cstdash,smooth,dcolorc,cstarrowto] (-2.8,0.3) to [bend right=25] (2.2,-0.3);
% 		\fill[cstdot,dcolora] (-2,0.8) circle;
% 		\fill[cstdot,dcolora] (-2.3,0.5) circle;
% 		\fill[cstdot,dcolora] (-2.8,0.3) circle;
% 		\fill[cstdot,dcolorb] (2.8,0.7) circle;
% 		\fill[cstdot,dcolorb] (2.2,-0.3) circle;
% 		\draw
% 		(-2.5,-1.7) node[dcolora] {$z$ 复平面}
% 		(2.5,-1.7) node[dcolorb] {$w$ 复平面}
% 		(-2.7,-0.2) node {$0$}
% 		(-0.5,-0.2) node {$x$}
% 		(-2.7,1.5) node {$y$}
% 		(2.3,0.2) node {$0$}
% 		(4.5,-0.2) node {$u$}
% 		(2.3,1.5) node {$v$};
% 	\end{tikzpicture}
% \end{center}

% \begin{example}
% 	函数 $w=\ov z$.
% 	{如果把 $z$ 复平面和 $w$ 复平面重叠放置, 则这个映照对应的是关于 $z$ 轴的翻转变换.它把任一区域映成和它全等的区域, 且 $u=x,v=-y$.}
% \end{example}

% \begin{center}
% 	\begin{tikzpicture}
% 		\draw[cstaxis] (-4.5,0)--(-0.5,0);
% 		\draw[cstaxis] (-2.5,-1.5)--(-2.5,1.5);
% 		\draw[cstaxis] (0.5,0)--(4.5,0);
% 		\draw[cstaxis] (2.5,-1.5)--(2.5,1.5);
% 		\draw[cstcurve,dcolora,smooth] plot coordinates {(-4,0) (-4.2,-0.4) (-2.8,-0.9) (-2,-0.7) (-1.6,0) (-1.4,1) (-2.8,1.2) (-3.2,1) (-4,0)};
% 		\draw[cstcurve,dcolorb,smooth] plot coordinates {(1,0) (0.8,0.4) (2.2,0.9) (3,0.7) (3.4,0) (3.6,-1) (2.2,-1.2) (1.8,-1) (1,0)};
% 		\draw[cstdash,smooth,dcolorc,cstarrowto] (-2,0.8) to[bend left=45] (3,-0.8);
% 		\draw[cstdash,smooth,dcolorc,cstarrowto] (-2.8,0.3) to[bend right=25] (2.2,-0.3);
% 		\draw[cstdash,smooth,dcolorc,cstarrowto] (-3.6,-0.2) to[bend right=15] (1.4,0.2);
% 		\draw[cstcurve,dcolora] (-1.84,0.9)--(-3.76,-0.3);
% 		\draw[cstcurve,dcolorb] (3.16,-0.9)--(1.24,0.3);
% 		\fill[cstdot,dcolora] (-2,0.8) circle;
% 		\fill[cstdot,dcolora] (-2.8,0.3) circle;
% 		\fill[cstdot,dcolora] (-3.6,-0.2) circle;
% 		\fill[cstdot,dcolorb] (3,-0.8) circle;
% 		\fill[cstdot,dcolorb] (2.2,-0.3) circle;
% 		\fill[cstdot,dcolorb] (1.4,0.2) circle;
% 		\draw
% 		(-2.5,-1.7) node[dcolora] {$z$ 复平面}
% 		(2.5,-1.7) node[dcolorb] {$w$ 复平面}
% 		(-0.5,0.2) node {$x$}
% 		(-2.7,1.5) node {$y$}
% 		(4.5,-0.2) node {$u$}
% 		(2.3,1.5) node {$v$};
% 	\end{tikzpicture}
% \end{center}

% \begin{example}
% 	函数 $w=az$.
% 	{设 $a=re^{i\theta}$, 则这个映照对应的是一个旋转映照(逆时针旋转 $\theta$)和一个相似映照(放大为 $r$ 倍)的复合.它把任一区域映成和它相似的区域.}
% \end{example}
% \begin{center}
% 	\begin{tikzpicture}
% 		\draw[cstaxis] (-4.5,0)--(-0.5,0);
% 		\draw[cstaxis] (-2.5,-1.5)--(-2.5,1.5);
% 		\draw[cstaxis] (0.5,0)--(4.5,0);
% 		\draw[cstaxis] (2.5,-1.5)--(2.5,1.5);
% 		\draw[cstcurve,dcolora,smooth] plot coordinates {(-4,0) (-4.2,-0.4) (-2.8,-0.9) (-2,-0.7) (-1.6,0) (-1.4,1) (-2.8,1.2) (-3.2,1) (-4,0)};
% 		\draw[cstcurve,dcolorb,smooth] plot coordinates {(2.5,-0.9) (2.74,-1.02) (3.04,-0.18) (2.92,0.3) (2.5,0.54) (1.9,0.66) (1.78,-0.18) (1.9,-0.42) (2.5,-0.9)};
% 		\draw[cstdash,smooth,dcolorc,cstarrowto] (-2,0.8) to[bend left=20] (2.02,0.3);
% 		\draw[cstdash,smooth,dcolorc,cstarrowto] (-2.8,0.3) to[bend right=10] (2.32,-0.18);
% 		\draw[cstdash,smooth,dcolorc,cstarrowto] (-3.6,-0.2) to[bend right=25] (2.62,-0.66);
% 		\draw[cstcurve,dcolora] (-1.84,0.9)--(-3.76,-0.3);
% 		\draw[cstcurve,dcolorb] (1.96,0.396)--(2.68,-0.756);
% 		\fill[cstdot,dcolora] (-2,0.8) circle;
% 		\fill[cstdot,dcolora] (-2.8,0.3) circle;
% 		\fill[cstdot,dcolora] (-3.6,-0.2) circle;
% 		\fill[cstdot,dcolorb] (2.02,0.3) circle;
% 		\fill[cstdot,dcolorb] (2.32,-0.18) circle;
% 		\fill[cstdot,dcolorb] (2.62,-0.66) circle;
% 		\draw
% 		(-2.5,-1.7) node[dcolora] {$z$ 复平面}
% 		(2.5,-1.7) node[dcolorb] {$w$ 复平面}
% 		(-0.5,0.2) node {$x$}
% 		(-2.7,1.5) node {$y$}
% 		(4.5,-0.2) node {$u$}
% 		(2.3,1.5) node {$v$};
% 	\end{tikzpicture}
% \end{center}

% \begin{example}
% 	函数 $w=z^2$.
% 	{这个映照把 $z$ 的辐角增大一倍, 因此它会把角形区域变换为角形区域, 并将夹角放大一倍.
% 	\begin{center}
% 		\begin{tikzpicture}
% 			\draw[cstaxis] (-4.5,0)--(-0.5,0);
% 			\draw[cstaxis] (-2.5,-1)--(-2.5,2);
% 			\draw[cstaxis] (0.5,0)--(4.5,0);
% 			\draw[cstaxis] (2.5,-1)--(2.5,2);
% 			\draw[cstdash,smooth,dcolorc,cstarrowto] (-2.5,1) to[bend left=10] (1.5,0);
% 			\draw[cstdash,smooth,dcolorc,cstarrowto] (-1.7,1.2) to[bend left=20] (1.7,1.92);
% 			\draw[cstdash,smooth,dcolorc,cstarrowto] (-3.1,-0.3) to[bend right=25] (2.77,0.36);
% 			\fill[cstdot,fill=dcolora] (-2.5,1) circle;
% 			\fill[cstdot,fill=dcolora] (-1.7,1.2) circle;
% 			\fill[cstdot,fill=dcolora] (-3.1,-0.3) circle;
% 			\fill[cstdot,fill=dcolorb] (1.5,0) circle;
% 			\fill[cstdot,fill=dcolorb] (1.7,1.92) circle;
% 			\fill[cstdot,fill=dcolorb] (2.77,0.36) circle;
% 			\fill[cstfille,pattern color=dcolora] (-2.5,0)--(-1.31,0.913) arc(37.5:7.5:1.5)--cycle;
% 			\fill[cstfille,pattern color=dcolorb] (2.5,0)--(2.966,1.74) arc(75:15:1.8)--cycle;
% 			\draw[cstcurve,dcolora] (-2.5,0) --(-1.15,1.035);
% 			\draw[cstcurve,dcolora] (-2.5,0) --(-0.814,0.222);
% 			\draw[cstcurve,dcolorb] (2.5,0) --(3.018,1.93);
% 			\draw[cstcurve,dcolorb] (2.5,0) --(4.43,0.518);
% 			\draw
% 			(-2.5,-1.2) node[dcolora] {$z$ 复平面}
% 			(2.5,-1.2) node[dcolorb] {$w$ 复平面}
% 			(-2.7,-0.2) node {$0$}
% 			(-0.5,-0.2) node {$x$}
% 			(-2.7,1.8) node {$y$}
% 			(2.3,0.2) node {$0$}
% 			(4.5,-0.2) node {$u$}
% 			(2.3,1.8) node {$v$};
% 		\end{tikzpicture}
% 	\end{center}}
% \end{example}

% \begin{example}[续]
% 	由于 $u=x^2-y^2,v=2xy$.
% 	{因此它把 $z$ 复平面上两族分别以直线 $y=\pm x$ 和坐标轴为渐近线的等轴双曲线 $x^2-y^2=c_1,2xy=c_2$分别映射为 $w$ 复平面上的两族平行直线 $u=c_1,v=c_2$.}
% 	{
% 	\begin{center}
% 		\begin{tikzpicture}
% 			\draw[cstaxis] (-4.5,0)--(-0.5,0);
% 			\draw[cstaxis] (-2.5,-1.6)--(-2.5,1.6);
% 			\draw[cstaxis] (0.5,0)--(4.5,0);
% 			\draw[cstaxis] (2.5,-1.6)--(2.5,1.6);
% 			\draw[cstcurve,dcolorb] (-3.7,-1.2)--(-1.3,1.2);
% 			\draw[cstcurve,dcolorb] (-3.7,1.2)--(-1.3,-1.2);
% 			\draw[cstcurve,dcolorb,smooth,domain=-35:35]
% 				plot ({sec(\x)-2.5},{tan(\x)})
% 				plot ({-sec(\x)-2.5},{tan(\x)})
% 				plot ({tan(\x)-2.5},{sec(\x)})
% 				plot ({tan(\x)-2.5},{-sec(\x)});
% 			\draw[cstcurve,dcolorb,smooth,domain=-46:46]
% 				plot ({(0.8*sec(\x)-2.5)},{0.8*tan(\x)})
% 				plot ({(-0.8*sec(\x)-2.5)},{0.8*tan(\x)})
% 				plot ({0.8*tan(\x)-2.5},{0.8*sec(\x)})
% 				plot ({0.8*tan(\x)-2.5},{0.8*-sec(\x)});
% 			\draw[cstcurve,dcolorb,smooth,domain=-57:57]
% 				plot ({(0.6*sec(\x)-2.5)},{0.6*tan(\x)})
% 				plot ({(-0.6*sec(\x)-2.5)},{0.6*tan(\x)})
% 				plot ({0.6*tan(\x)-2.5},{0.6*sec(\x)})
% 				plot ({0.6*tan(\x)-2.5},{0.6*-sec(\x)});
% 			\draw[cstcurve,dcolorb,smooth,domain=-68:68]
% 				plot ({(0.4*sec(\x)-2.5)},{0.4*tan(\x)})
% 				plot ({(-0.4*sec(\x)-2.5)},{0.4*tan(\x)})
% 				plot ({0.4*tan(\x)-2.5},{0.4*sec(\x)})
% 				plot ({0.4*tan(\x)-2.5},{0.4*-sec(\x)});

% 			\draw[cstcurve,dcolora] (-4,0)--(-1,0);
% 			\draw[cstcurve,dcolora] (-2.5,-1.3)--(-2.5,1.3);
% 			\draw[cstcurve,dcolora,smooth,domain=-34:34]
% 				plot ({0.8*(sec(\x)+tan(\x))-2.5},{0.8*(sec(\x)-tan(\x))})
% 				plot ({0.8*(sec(\x)+tan(\x))-2.5},{-0.8*(sec(\x)-tan(\x))})
% 				plot ({-0.8*(sec(\x)+tan(\x))-2.5},{0.8*(sec(\x)-tan(\x))})
% 				plot ({-0.8*(sec(\x)+tan(\x))-2.5},{-0.8*(sec(\x)-tan(\x))});
% 			\draw[cstcurve,dcolora,smooth,domain=-45:45]
% 				plot ({0.6*(sec(\x)+tan(\x))-2.5},{0.6*(sec(\x)-tan(\x))})
% 				plot ({0.6*(sec(\x)+tan(\x))-2.5},{-0.6*(sec(\x)-tan(\x))})
% 				plot ({-0.6*(sec(\x)+tan(\x))-2.5},{0.6*(sec(\x)-tan(\x))})
% 				plot ({-0.6*(sec(\x)+tan(\x))-2.5},{-0.6*(sec(\x)-tan(\x))});
% 			\draw[cstcurve,dcolora,smooth,domain=-57:57]
% 				plot ({0.4*(sec(\x)+tan(\x))-2.5},{0.4*(sec(\x)-tan(\x))})
% 				plot ({0.4*(sec(\x)+tan(\x))-2.5},{-0.4*(sec(\x)-tan(\x))})
% 				plot ({-0.4*(sec(\x)+tan(\x))-2.5},{0.4*(sec(\x)-tan(\x))})
% 				plot ({-0.4*(sec(\x)+tan(\x))-2.5},{-0.4*(sec(\x)-tan(\x))});
% 			\draw[cstcurve,dcolora,smooth,domain=-71:71]
% 				plot ({0.2*(sec(\x)+tan(\x))-2.5},{0.2*(sec(\x)-tan(\x))})
% 				plot ({0.2*(sec(\x)+tan(\x))-2.5},{-0.2*(sec(\x)-tan(\x))})
% 				plot ({-0.2*(sec(\x)+tan(\x))-2.5},{0.2*(sec(\x)-tan(\x))})
% 				plot ({-0.2*(sec(\x)+tan(\x))-2.5},{-0.2*(sec(\x)-tan(\x))});

% 			\draw[cstcurve,dcolorb] (1.3,-1.3)--(1.3,1.3);
% 			\draw[cstcurve,dcolorb] (1.6,-1.3)--(1.6,1.3);
% 			\draw[cstcurve,dcolorb] (1.9,-1.3)--(1.9,1.3);
% 			\draw[cstcurve,dcolorb] (2.2,-1.3)--(2.2,1.3);
% 			\draw[cstcurve,dcolorb] (2.5,-1.3)--(2.5,1.3);
% 			\draw[cstcurve,dcolorb] (2.8,-1.3)--(2.8,1.3);
% 			\draw[cstcurve,dcolorb] (3.1,-1.3)--(3.1,1.3);
% 			\draw[cstcurve,dcolorb] (3.4,-1.3)--(3.4,1.3);
% 			\draw[cstcurve,dcolorb] (3.7,-1.3)--(3.7,1.3);

% 			\draw[cstcurve,dcolora] (1.2,-1.2)--(3.8,-1.2);
% 			\draw[cstcurve,dcolora] (1.2,-0.9)--(3.8,-0.9);
% 			\draw[cstcurve,dcolora] (1.2,-0.6)--(3.8,-0.6);
% 			\draw[cstcurve,dcolora] (1.2,-0.3)--(3.8,-0.3);
% 			\draw[cstcurve,dcolora] (1.2,0)--(3.8,0);
% 			\draw[cstcurve,dcolora] (1.2,0.3)--(3.8,0.3);
% 			\draw[cstcurve,dcolora] (1.2,0.6)--(3.8,0.6);
% 			\draw[cstcurve,dcolora] (1.2,0.9)--(3.8,0.9);
% 			\draw[cstcurve,dcolora] (1.2,1.2)--(3.8,1.2);
% 			\draw
% 			(-2.5,-1.9) node {$z$ 复平面}
% 			(2.5,-1.9) node {$w$ 复平面};
% 		\end{tikzpicture}
% 	\end{center}}
% \end{example}

% \begin{example}
% 	求下列集合在映照 $w=z^2$ 下的像.

% 	\enumnum1 线段 $0<|z|<2,\arg z=\dfrac\pi2$.
% \end{example}

% \begin{solution}
% 	设 $z=re^{\frac{\pi i}2}=ir$, 则 $w=z^2=-r^2$.
% 	{因此它的像还是一条线段 $0<|w|<4,\arg w=-\pi$.
% 	\begin{center}
% 		\begin{tikzpicture}
% 			\draw[cstaxis] (-4.5,0)--(-0.5,0);
% 			\draw[cstaxis] (-2.5,-0.2)--(-2.5,1.6);
% 			\draw[cstaxis] (0.5,0)--(4.5,0);
% 			\draw[cstaxis] (2.5,-0.2)--(2.5,1.6);
% 			\draw[cstcurve,dcolora] (-2.5,0)--(-2.5,1);
% 			\filldraw[cstdote,draw=dcolora] (-2.5,0) circle;
% 			\filldraw[cstdote,draw=dcolora] (-2.5,1) circle;
% 			\draw[cstcurve,dcolorb] (0.5,0)--(2.5,0);
% 			\filldraw[cstdote,draw=dcolorb] (0.5,0) circle;
% 			\filldraw[cstdote,draw=dcolorb] (2.5,0) circle;
% 			\draw[cstdash,cstarrowto,dcolorc] (-2.2,0.5) to[bend left] (1.5,0.5);
% 			\draw
% 			(-2.5,-.4) node[dcolora] {$z$ 复平面}
% 			(2.5,-.4) node[dcolorb] {$w$ 复平面}
% 			(-0.5,-0.2) node {$x$}
% 			(-2.7,1.3) node {$y$}
% 			(4.5,-0.2) node {$u$}
% 			(2.3,1.3) node {$v$};
% 		\end{tikzpicture}
% 	\end{center}}
% \end{solution}

% \begin{example}
% 	求下列集合在映照 $w=z^2$ 下的像.

% 	\enumnum2 双曲线 $x^2-y^2=4$.
% \end{example}

% \begin{solution*}
% 	由于 \[w=u+iv=z^2=(x^2-y^2)+2xyi.\]
% 	{因此 $u=x^2-y^2=4,v=2xy$.}

% 	{可以说明当 $u=4$ 时, 对任意 $v$, $u+iv$ 都是该双曲线上某一点的像.所以这条双曲线的像是直线 $\Re w=4$.}
% \end{solution*}

% \begin{example}
% 	求下列集合在映照 $w=z^2$ 下的像.

% 	\enumnum3 扇形区域 $0<\arg z<\dfrac\pi4,0<|z|<2$.
% \end{example}

% \begin{solution}
% 	设 $z=re^{i\theta}$, 则 $w=r^2e^{2i\theta}$.
% 	{因此它的像是扇形区域 $0<\arg w<\dfrac\pi2,0<|w|<4$.}
% \end{solution}

% \begin{example}
% 	求圆周 $|z|=2$ 在映照 $w=\dfrac{z+1}{z-1}$ 下的像.
% \end{example}

% \begin{solution}
% 	由于 $z=\dfrac{w+1}{w-1}$, $\abs{\dfrac{w+1}{w-1}}=2$,
% 	{因此
% 	\[|w+1|=2|w-1|,\quad w\ov w+w+\ov w+1=4w\ov w-4w-4\ov w+4,\]}
% 	{
% 		\[w\ov w-\frac53 w-\frac53\ov w+1=0,\quad \abs{w-\frac53}^2=\dfrac{16}9,\]即 $\abs{w-\dfrac53}=\dfrac43$, 是一个圆周.}
% \end{solution}

% \section{极限和连续性}

% \subsection{无穷远点}

% 类似于实变函数情形, 我们可以定义复变函数的极限.
% 我们先来看数列极限的定义.

% \begin{definition}
% 	\begin{itemize}
% 	\item 设 $\{z_n\}_{n\ge 1}$ 是一个复数列.
% 		\emph{如果 $\forall \varepsilon>0,\exists N$ 使得当 $n\ge N$ 时 $|z_n-z|<\varepsilon$}, 则称 $z$ 是\emph{数列 $\{z_n\}$ 的极限}, 记作 \emph{$\lim\limits_{n\to\infty}z_n=z$}.
% 	\item 如果 \emph{$\forall X>0,\exists N$ 使得当 $n\ge N$ 时 $|z_n|>X$}, 则称 $\infty$ 是数列 $\{z_n\}$ 的极限, 记作 $\lim\limits_{n\to\infty}z_n=\infty$.
% 	\end{itemize}
% \end{definition}

% 如果我们称
% \[\Uc(\infty,X)=\set{z\in\BC:|z|>X}\]
% 为 $\infty$ 的(去心)邻域,
% 那么 $\lim\limits_{n\to\infty}z_n=z\in\BC\cup\set\infty$ 可统一表述为:

% \begin{block@}
% 	对 $z$ 的任意邻域 $U$, $\exists N$ 使得当 $n\ge N$ 时 $z_n\in U$.
% \end{block@}


% \begin{center}
% 	\begin{tikzpicture}
% 		\fill[cstfille1] (0,0) circle (1.2);
% 		\filldraw[cstcurve,dcolorb,fill=white] (0,0) circle (0.5);
% 		\draw[cstaxis] (-1.5,0)--(1.5,0);
% 		\draw[cstaxis] (0,-1.5)--(0,1.5);
% 	\end{tikzpicture}
% \end{center}

% 那么有没有一种看法使得 $\infty$ 的邻域和普通复数的邻域没有差异呢?
% 我们将介绍复球面的概念, 它是复数的一种几何表示且自然包含无穷远点 $\infty$.
% 这种思想是在黎曼研究多值复变函数时引入的.

% 取一个与复平面相切于原点 $z=0$ 的球面.
% 过 $O$ 做垂直于复平面的直线, 并与球面相交于另一点 $N$, 称之为北极.


% \begin{center}
% 	\begin{tikzpicture}
% 		\fill[cstfill] (-3.65,-0.804)--(-1.85,0.804)--(3.65,0.804)--(1.85,-0.804)--cycle;
% 		\filldraw[cstcurve,fill=black!10] (0,1) circle (1);
% 		\draw[cstdash] (0,1) circle (1 and 0.3);
% 		\draw[cstdash] (0,0)--(0,2);
% 		\fill[cstdot,dcolorc] (0,1) circle;
% 		\fill[cstdot,dcolorc] (0,2) circle;
% 		\draw[cstaxis] (0,0)--(2.5,0);
% 		\draw[cstaxis] (0,0)--(-0.8,-0.9);
% 		\draw
% 		(0,2.3) node[dcolorc] {$N$};
% 	\end{tikzpicture}
% \end{center}

% \begin{itemize}
% 	\item 对于平面上的任意一点 $z$, 连接北极 $N$ 和 $z$ 的直线一定与球面相交于除 $N$ 以外的唯一一个点 $Z$.
% 	\item 反之, 球面上除了北极外的任意一点 $Z$, 直线 $NZ$ 一定与复平面相交于唯一一点.
% \end{itemize}
% 这样, 球面上除北极外的所有点和全体复数建立了一一对应.


% \begin{center}
% 	\begin{tikzpicture}
% 		\fill[cstfill] (-3.65,-0.804)--(-1.85,0.804)--(3.65,0.804)--(1.85,-0.804)--cycle;
% 		\filldraw[cstcurve,fill=black!10] (0,1) circle (1);
% 		\draw[cstdash] (0,1) circle (1 and 0.3);
% 		\draw[cstdash,dcolorc] (0,0) circle (2 and 0.6);
% 		\draw[cstdash] (0,0)--(0,2);
% 		\draw[cstaxis] (0,0)--(2.5,0);
% 		\draw[cstaxis] (0,0)--(-0.8,-0.9);
% 		\draw[cstcurve,dcolora,cstarrowto] (0,2)--(1.65,-0.75);
% 		\fill[cstdot,dcolora] (0.6,1) circle;
% 		\draw[cstcurve,cstarrowto,dcolorb] (0,2)--(-1,0);
% 		\fill[cstdot,dcolorb] (-0.7,0.6) circle;
% 		\fill[cstdot,dcolorc] (0,2) circle;
% 		\draw
% 			(0,2.3) node[dcolorc] {$N$}
% 			(-0.3,0.3) node[dcolorb] {$Z_2$}
% 			(-1.4,0) node[dcolorb] {$z_2$}
% 			(1.3,1) node[dcolora] {$Z_1$}
% 			(1.9,-0.75) node[dcolora] {$z_1$};
% 	\end{tikzpicture}
% \end{center}

% 当 $|z|$ 越来越大时, 其对应球面上点也越来越接近 $N$.
% 如果我们在复平面上添加一个额外的"点"——\emph{无穷远点}, 记作 \emph{$\infty$}.
% 那么\emph{扩充复数集合 $\BC^*=\BC\cup\set\infty$} 就正好和球面上的点一一对应.
% 称这样的球面为\emph{复球面}, 称包含无穷远点的复平面为\emph{扩充复平面}(\emph{闭复平面}).

% \begin{center}
% 	\begin{tikzpicture}
% 		\fill[cstfill] (-3.65,-0.804)--(-1.85,0.804)--(3.65,0.804)--(1.85,-0.804)--cycle;
% 		\filldraw[cstcurve,fill=black!10] (0,1) circle (1);
% 		\draw[cstdash] (0,1) circle (1 and 0.3);
% 		\draw[cstdash,dcolorc] (0,0) circle (2 and 0.6);
% 		\draw[cstdash] (0,0)--(0,2);
% 		\draw[cstaxis] (0,0)--(2.5,0);
% 		\draw[cstaxis] (0,0)--(-0.8,-0.9);
% 		\draw[cstcurve,dcolora,cstarrowto] (0,2)--(1.65,-0.75);
% 		\fill[cstdot,dcolora] (0.6,1) circle;
% 		\draw[cstcurve,cstarrowto,dcolorb] (0,2)--(-1,0);
% 		\fill[cstdot,dcolorb] (-0.7,0.6) circle;
% 		\fill[cstdot,dcolorc] (0,2) circle;
% 		\draw
% 			(0,2.3) node[dcolorc] {$N$}
% 			(-0.3,0.3) node[dcolorb] {$Z_2$}
% 			(-1.4,0) node[dcolorb] {$z_2$}
% 			(1.5,1) node[dcolora] {$Z_1$}
% 			(1.9,-0.75) node[dcolora] {$z_1$};
% 	\end{tikzpicture}
% \end{center}

% 它和实数中 $\pm\infty$ 有什么联系呢?
% 选取上述图形的一个截面来看, 实轴可以和圆周去掉一点建立一一对应.
% 于是实数中的 $\pm\infty$ 在复球面上就是 $\infty$.


% \begin{center}
% 	\begin{tikzpicture}
% 		\filldraw[cstcurve,fill=black!10] (0,1) circle (1);
% 		\draw[cstdash] (0,0)--(0,2);
% 		\draw[cstaxis] (-2,0)--(2.5,0);
% 		\draw[cstcurve,cstarrowto,dcolora] (0,2)--(2.2,0);
% 		\fill[cstdot,dcolora] (1,1.1) circle;
% 		\draw[cstcurve,cstarrowto,dcolorb] (0,2)--(-1,0);
% 		\fill[cstdot,dcolorb] (-0.8,0.4) circle;
% 		\fill[cstdot,dcolorc] (0,2) circle;
% 		\draw
% 			(0,2.3) node[dcolorc] {$N$}
% 			(-0.4,0.5) node[dcolorb] {$X_2$}
% 			(-1,-0.2) node[dcolorb] {$x_2$}
% 			(1.4,1.2) node[dcolora] {$X_1$}
% 			(2.1,-0.2) node[dcolora] {$x_1$};
% 	\end{tikzpicture}
% \end{center}

% 朴素地看, 复球面上任意一点可以定义邻域的概念.
% 特别地, $\infty$ 的开邻域通过前面所说的对应关系, 可以对应到扩充复平面上 $\infty$ 的一个邻域.
% 所以在复球面上, 我们将普通复数和 $\infty$ 的开邻域可以视为相同的概念.

% \subsection{数列的极限}

% 下述定理保证了我们可以使用实数列的敛散性判定技巧.

% \begin{theorem}
% 	设 $z_n=x_n+y_ni,z=x+yi$, 则
% 	\[\lim_{n\to\infty}z_n=z\iff \lim_{n\to\infty}x_n=x,\lim_{n\to\infty}y_n=y.\]
% \end{theorem}

% \begin{proof}
% 	由三角不等式
% 	\[|x_n-x|,|y_n-y|\le|z_n-z|\le|x_n-x|+|y_n-y|\]
% 	易证.
% \end{proof}

% \begin{example}
% 	设 $z_n=\left(1+\dfrac1n\right)e^{\frac{\pi i}n}$. 数列 $\{z_n\}$ 是否收敛?
% \end{example}

% \begin{solution}
% 	由于
% 	\[x_n=\left(1+\frac1n\right)\cos\frac\pi n\to 1,\quad
% 	y_n=\left(1+\frac1n\right)\sin\frac\pi n\to 0.\]
% 	{因此 $\{z_n\}$ 收敛且 $\lim\limits_{n\to\infty}z_n=1$.}
% \end{solution}

% \subsection{函数的极限}

% \begin{definition*}
% 	设函数 $f(z)$ 在点 $z_0$ 的某个去心邻域内有定义.

% 	{如果存在复数 $A$ 使得对 $A$ 的任意邻域 $U(A,\varepsilon),\exists\delta>0$ 使得
% 		\[z\in\Uc(z_0,\delta)\implies f(z)\in U(A,\varepsilon),\]则称 $A$ 为 \emph{$f(z)$ 当 $z\to z_0$ 时的极限}, 记为 \emph{$\lim\limits_{z\to z_0}f(z)=A$} 或 \emph{$f(z)\to A (z\to z_0)$}.}
% \end{definition*}
% 此时我们称\emph{极限存在}.

% 对于 $z_0=\infty$ 或 $A=\infty$ 的情形, 也可以用上述定义统一描述.

% 不难看出, 变函数的极限和二元实函数的极限定义是类似的:
% 即 $z\to z_0$ 沿任一曲线趋向于 $z_0$ 的极限都是相同的.

% \begin{theorem}
% 	设 $f(z)=u(x,y)+iv(x,y),z_0=x_0+y_0i,A=u_0+v_0i$, 则
% 	\[\lim_{z\to z_0}f(z)=A\iff
% 	\lim_{\substack{x\to x_0\\y\to y_0}}u(x,y)=u_0,\quad
% 	\lim_{\substack{x\to x_0\\y\to y_0}}v(x,y)=v_0.\]
% \end{theorem}

% \begin{proof}
% 	由三角不等式
% 	\[|u-u_0|,|v-v_0|\le|f(z)-A|\le|u-u_0|+|v-v_0|\]
% 	易证.
% \end{proof}

% 由此可知极限的四则运算法则对于复变函数也是成立的.

% \begin{theorem}
% 	设 $\lim\limits_{z\to z_0}f(z)=A,\lim\limits_{z\to z_0}g(z)=B$, 则
% 	\begin{enumerate}
% 		\item $\lim\limits_{z\to z_0}(f\pm g)(z)=A\pm B$;
% 		\item $\lim\limits_{z\to z_0}(fg)(z)=AB$;
% 		\item 当 $B\neq 0$ 时, $\lim\limits_{z\to z_0}\left(\dfrac fg\right)(z)=\dfrac AB$.
% 	\end{enumerate}
% \end{theorem}

% 在学习了复变函数的导数后, 我们也可以使用等价无穷小替换、洛必达法则等工具来计算极限.

% \begin{example}
% 	证明当 $z\to0$ 时, 函数 $f(z)=\dfrac{\Re z}{|z|}$ 的极限不存在.
% \end{example}

% \begin{proof}
% 	令 $z=x+yi$, 则 $f(z)=\dfrac x{\sqrt{x^2+y^2}}$.
% 	{因此
% 		\[u(x,y)=\frac x{\sqrt{x^2+y^2}},\quad v(x,y)=0.\]}

% 	{当 $z$ 在实轴原点两侧分别趋向于 $0$ 时, $u(x,y)\to\pm1$.因此 $\lim\limits_{\substack{x\to 0\\y\to0}}u(x,y)$ 不存在,从而 $\lim\limits_{z\to z_0}f(z)$ 不存在.\qedhere}
% \end{proof}

% \subsection{函数的连续性}

% \begin{definition}
% 	\begin{itemize}
% 		\item 如果 $\lim\limits_{z\to z_0}f(z)=f(z_0)$, 则称 $f(z)$ 在 \emph{$z_0$ 处连续}.
% 		\item 如果 $f(z)$ 在区域 $D$ 内处处连续, 则称 $f(z)$ 在 \emph{$D$ 内连续}.
% 	\end{itemize}
% \end{definition}

% 根据前面的极限判定定理可知:
% \begin{theorem}
% 	函数 $f(z)=u(x,y)+iv(x,y)$ 在 $z_0=x_0+iy_0$ 处连续当且仅当 $u(x,y)$ 和 $v(x,y)$ 在 $(x_0,y_0)$ 处连续.
% \end{theorem}

% \begin{example}
% 	设 $f(z)=\ln(x^2+y^2)+i(x^2-y^2)$.
% 	{$u(x,y)=\ln(x^2+y^2)$ 除原点外处处连续, $v(x,y)=x^2-y^2$ 处处连续.因此 $f(z)$ 在 $z\neq0$ 处连续.}
% \end{example}

% \begin{theorem}
% 	\begin{itemize}
% 		\item 在 $z_0$ 处连续的两个函数 $f(z),g(z)$ 之和、差、积、商($g(z_0)\neq 0$) 在 $z_0$ 处仍然连续.
% 		\item 如果函数 $g(z)$ 在 $z_0$ 处连续, 函数 $f(w)$ 在 $g(z_0)$ 处连续, 则 $f(g(z))$ 在 $z_0$ 处连续.
% 	\end{itemize}
% \end{theorem}

% 显然 $f(z)=z$ 是处处连续的,
% 故多项式函数
% \[P(z)=a_0+a_1z+a_2z^2+\cdots+a_nz^n\]
% 也处处连续,
% 有理函数 $\dfrac{P(z)}{Q(z)}$ 在 $Q(z)$ 的零点以外处处连续.

% \begin{example}
% 	证明: 如果 $f(z)$ 在 $z_0$ 连续, 则 $\ov{f(z)}$ 在 $z_0$ 也连续.
% \end{example}

% \begin{proof}
% 	设 $f(z)=u(x,y)+iv(x,y),z_0=x_0+iy_0$.
% 	{那么 $u(x,y),v(x,y)$ 在 $(x_0,y_0)$ 连续.从而 $-v(x,y)$ 也在 $(x_0,y_0)$ 连续.所以 $\ov{f(z)}=u(x,y)-iv(x,y)$ 在 $(x_0,y_0)$ 连续.}

% 	{另一种看法是, 函数 $g(z)=\ov z=x-iy$ 处处连续,从而 $g(f(z))=\ov{f(z)}$ 在 $z_0$ 处连续.}
% \end{proof}

% 可以看出, 在极限和连续性上, 复变函数和两个二元实函数没有什么差别.
% 那么复变函数和多变量微积分的差异究竟是什么导致的呢?
% 归根到底就在于 $\BC$ 是一个域, 上面可以做除法.

% 这就导致了复变函数有\emph{导数}, 而不是像多变量实函数只有偏导数.
% 这种特性使得可导的复变函数具有整洁优美的性质, 我们将在下一章来逐步揭开它的神秘面纱.

% \chapter{解析函数}
% \section{解析函数的概念}

% \subsection{可导的函数}

% 由于 $\BC$ 和 $\BR$ 一样是域, 因此我们可以像一元实变函数一样去定义复变函数的导数和微分.

% \begin{definition}
% 	设 $w=f(z)$ 的定义域是区域 $D$, $z_0\in D$.
% 	如果极限
% 		\[\lim_{z\to z_0}\frac{f(z)-f(z_0)}{z-z_0}
% 		=\lim_{\Delta z\to 0}\frac{f(z_0+\Delta z)-f(z_0)}{\Delta z}\]
% 	存在,则称 \emph{$f(z)$ 在 $z_0$ 可导}.这个极限值称为 \emph{$f(z)$ 在 $z_0$ 的导数},记作
% 		\[f'(z_0)=\frac{\diff w}{\diff z}\big|_{z=z_0}
% 		=\lim_{\Delta z\to 0}\frac{f(z_0+\Delta z)-f(z_0)}{\Delta z}.\]
% 	如果 $f(z)$ 在区域 $D$ 内处处可导, 称 \emph{$f(z)$ 在 $D$ 内可导}.
% \end{definition}

% \begin{example}
% 	函数 $f(z)=x+2yi$ 在哪些点处可导?
% \end{example}

% \begin{solution}
% 	\begin{align*}
% 		f'(z)&=\lim_{\Delta z\to 0}\frac{f(z+\Delta z)-f(z)}{\Delta z}\\
% 		&{=\lim_{\Delta z\to 0}\frac{(x+\Delta x)+2(y+\Delta y)i-(x+2yi)}{\Delta z}}\\
% 		&{=\lim_{\Delta z\to 0}\frac{\Delta x+2\Delta y i}{\Delta x+\Delta yi}.}
% 	\end{align*}
% 	{当 $\Delta x=0, \Delta y\to 0$ 时, 上式$\to2$;当 $\Delta y=0, \Delta x\to 0$ 时, 上式$\to1$.因此该极限不存在, $f(z)$ 处处不可导.}
% \end{solution}

% 	\begin{exercise}
% 		函数 $f(z)=x-yi$ 在哪些点处可导? 
% 	\end{exercise}
% 	\begin{answer}
% 		处处不可导.
% 	\end{answer}
% \begin{example}
% 	求 $f(z)=z^2$ 的导数.
% \end{example}

% \begin{solution}
% 	\[
% 	f'(z)=\lim_{\Delta z\to 0}\frac{f(z+\Delta z)-f(z)}{\Delta z}
% 	{=\lim_{\Delta z\to 0}\frac{(z+\Delta z)^2-z^2}{\Delta z}}
% 	{=\lim_{\Delta z\to 0}(2z+\Delta z)=2z.}
% 	\]
% \end{solution}

% 和一元实变函数情形类似, 我们有如下求导法则:
% \begin{theorem}
% 	\begin{itemize}
% 		\item $(c)'=0$, 其中 $c$ 为复常数;
% 		\item $(z^n)'=nz^{n-1}$, 其中 $n$ 为整数;
% 		\item $(f\pm g)'=f'\pm g',\quad (cf)'=cf'$;
% 		\item $(fg)'=f'g+fg',\quad \left(\dfrac fg\right)'=\dfrac{f'g-fg'}{g^2}$;
% 		\item $[f(g(z))]'=f'[g(z)]\cdot g'(z)$;
% 		\item $g'(z)=\dfrac1{f'(w)}, g=f^{-1}, w=g(z)$.
% 	\end{itemize}
% \end{theorem}

% \begin{theorem}
% 	若 $f(z)$ 在 $z_0$ 可导, 则 $f(z)$ 在 $z_0$ 连续.
% \end{theorem}

% \begin{proof}
% 	该定理的证明和实变量情形完全相同.
% 	{设 \[\Delta w=f(z_0+\Delta z)-f(z_0),\]则
% 		\begin{align*}
% 		\lim_{\Delta z\to 0}\Delta w&=\lim_{\Delta z\to 0}\frac{\Delta w}{\Delta z}\cdot\Delta z\\
% 		&{=\lim_{\Delta z\to 0}\frac{\Delta w}{\Delta z}\cdot\lim_{\Delta z\to 0}\Delta z}
% 		{=f'(z_0)\cdot 0=0.}\qedhere
% 		\end{align*}}
% \end{proof}

% \subsection{可微的函数}

% 复变函数的微分也和一元实变函数情形类似.

% \begin{definition}
% 	如果存在常数 $A$ 使得函数 $w=f(z)$ 满足
% 	\[\Delta w=f(z_0+\Delta z)-f(z_0)=A\Delta z+o(\Delta z),\]
% 	其中 $o(\Delta z)$ 表示 $\Delta z$ 的高阶无穷小量,
% 	{则称 \emph{$f(z)$ 在 $z_0$ 处可微},称 $A\Delta z$ 为 \emph{$f(z)$ 在 $z_0$ 的微分}, 记作 $\diff w=A \Delta z$.}
% \end{definition}

% 和一元实变函数情形一样, 复变函数的可微和可导是等价的, 且 $\diff w=f'(z_0)\Delta z, \diff z=\Delta z$.
% 故 \emph{$\diff w=f'(z_0)\diff z,f'(z_0)=\dfrac{\diff w}{\diff z}$}.

% \subsection{解析的函数}

% \begin{definition}
% 	\begin{itemize}
% 		\item 若函数 $f(z)$ 在 $z_0$ 的一个邻域内处处可导, 则称 \emph{$f(z)$ 在 $z_0$ 解析}.
% 		\item 若 $f(z)$ 在区域 $D$ 内处处解析, 则称 $f(z)$ 在 $D$ 内解析, 或称 $f(z)$ 是 $D$ 内的一个\emph{解析函数}.
% 		\item 若 $f(z)$ 在 $z_0$ 不解析, 则称 $z_0$ 为 $f(z)$ 的一个\emph{奇点}.
% 	\end{itemize}
% \end{definition}

% 由于区域 $D$ 是一个开集, 其中的任意 $z_0\in D$ 均存在一个包含在 $D$ 的邻域. 
% 所以 \emph{$f(z)$ 在 $D$ 内解析和在 $D$ 内可导是等价的}.

% 如果 $f(z)$ 在 $z_0$ 解析, 则 $f(z)$ 在 $z_0$ 的一个邻域内处处可导, 从而在该邻域内解析.
% 因此 \emph{$f(z)$ 解析点全体是一个开集}.

% \begin{exercise}
% 	单选题: (2021年B卷) 函数 $f(z)$ 在点 $z_0$ 处解析是 $f(z)$ 在该点可导的\fillbrace{{A}}.
% 	\xx{充分条件}{必要条件}{充要条件}{既非充分也非必要条件}
% \end{exercise}

% \begin{answer}
% 	解析要求在 $z_0$ 的一个邻域内都可导才行.
% \end{answer}

% \begin{example}
% 	研究函数 $f(z)=|z|^2$ 的解析性.
% \end{example}

% \begin{solution*}
% 	由于
% 	\[
% 		\frac{f(z+\Delta z)-f(z)}{\Delta z}
% 		=\frac{(z+\Delta z)(\ov z+\ov{\Delta z})-z\ov z}{\Delta z}
% 		=\ov z+\ov{\Delta z}+z\frac{\Delta x-\Delta yi}{\Delta x+\Delta yi},
% 	\]

% 	{若 $z=0$, 则当 $\Delta z\to 0$ 时该极限为 $0$.}

% 	{若 $z\neq0$, 则当 $\Delta y=0,\Delta x\to 0$ 时该极限为 $\ov z+z$;当 $\Delta x=0,\Delta y\to 0$ 时该极限为 $\ov z-z$.因此此时极限不存在.}

% 	{故 $f(z)$ 仅在 $z=0$ 处可导, 从而处处不解析.}
% \end{solution*}

% \section{函数解析的充要条件}

% \subsection{柯西-黎曼方程}

% 通过对一些简单函数的分析, 我们会发现可导的函数往往可以直接表达为 $z$ 的函数的形式, 而不解析的往往包含 $x,y,\ov z$ 等内容.
% 这种现象并不是孤立的.
% 我们来研究二元实变量函数的可微性与复变函数可导的关系.

% 为了简便我们用 $u_x,u_y,v_x,v_y$ 等记号表示偏导数.

% 设 \emph{$f$ 在 $z$ 处可导}, $f'(z)=a+bi$,
% 则
% \[\Delta u+i\Delta v=\Delta f=(a+bi)(\Delta x+i\Delta y)+o(\Delta z).\]
% 展开可知
% \begin{align*}
% 	\Delta u&=a\Delta x-b\Delta y+o(\Delta z),\\
% 	\Delta v&=b\Delta x+a\Delta y+o(\Delta z).
% \end{align*}
% 由于 $o(\Delta z)=o(|\Delta z|)=o(\sqrt{x^2+y^2})$,
% 因此 
% \begin{block@}
% 	\begin{center}
% 		$u,v$ 可微且 $u_x=v_y=a,v_x=-u_y=b$.
% 	\end{center}
% \end{block@}

% 反过来, 假设 \emph{$u,v$ 可微且 $u_x=v_y, v_x=-u_y$}.
% 由全微分公式
% \begin{align*}
% 	\diff u&=u_x\diff x+u_y\diff y
% 	{=u_x\diff x-v_x\diff y,}\\
% 	{\diff v}&{=v_x\diff x+v_y\diff y}{=v_x\diff x+u_x\diff y,}\\
% 	{\diff f}&
% 	{=\diff (u+iv)=(u_x+i v_x)\diff x+(-v_x+i u_x)\diff y}\\
% 	&{=(u_x+i v_x)\diff(x+iy)}\\
% 	&{=(u_x+i v_x)\diff z=(v_y-i u_y)\diff z.}
% \end{align*}
% 故
% \begin{block@}
% 	\begin{center}
% 		$f(z)$ 在 $z$ 处可导, 且 $f'(z)=u_x+i v_x=v_y-i u_y$.
% 	\end{center}
% \end{block@}

% 由此我们得到
% \begin{alertblock}{柯西-黎曼方程 (C-R方程)}
% 	$f(z)$ 在 $z$ 可导当且仅当在 $z$ 点 $u,v$ 可微且满足C-R方程:
% 	\[u_x=v_y,\quad v_x=-u_y.\]
% 	此时
% 	\[f'(z)=u_x+iv_x=v_y-iu_y.\]
% \end{alertblock}

% \begin{center}
% 	\includegraphics[height=25mm]{../image/Cauchy.jpeg}
% 	\hspace{2cm}
% 	\includegraphics[height=25mm]{../image/Riemann.jpeg}
% \end{center}

% 注意到 $x=\dfrac12z+\dfrac12\ov z,y=-\dfrac i2z+\dfrac i2\ov z$.
% 仿照着二元实函数偏导数在变量替换下的变换规则, 我们定义 $f$ 对 $z$ 和 $\ov z$ 的偏导数为
% \[\left\{
% \begin{aligned}
% 	\frac{\partial f}{\partial z}&
% =\frac{\partial x}{\partial z}\frac{\partial f}{\partial x}
% 	+\frac{\partial y}{\partial z}\frac{\partial f}{\partial y}
% =\frac12\frac{\partial f}{\partial x}-\frac i2\frac{\partial f}{\partial y},\\
% 	\frac{\partial f}{\partial \ov z}&
% =\frac{\partial x}{\partial \ov z}\frac{\partial f}{\partial x}
% 	+\frac{\partial y}{\partial \ov z}\frac{\partial f}{\partial y}
% =\frac12\frac{\partial f}{\partial x}+\frac i2\frac{\partial f}{\partial y}.
% \end{aligned}\right.\]
% 如果把 $z,\ov z$ 看成独立变量, 那么当 $f$ 在 $z$ 处可导时,
% $\diff f=f'\diff z$.
% 当 $f$ 关于 $z,\ov z$ 可微时(即 $u,v$ 可微),
% \[\diff f=\frac{\partial f}{\partial z}\diff z+\frac{\partial f}{\partial \ov z}\diff\ov z.\]
% 所以 \emph{$f$ 在 $z$ 处可导当且仅当 $u,v$ 可微且 $\dfrac{\partial f}{\partial \ov z}=0$.}

% 由于二元函数的偏导数均连续蕴含可微, 因此我们有:

% \begin{theorem}
% 	\begin{itemize}
% 		\item 如果 $u_x,u_y,v_x,v_y$ 在 $z$ 处连续, 且满足C-R方程, 则 $f(z)$ 在 $z$ 可导.
% 		\item 如果 $u_x,u_y,v_x,v_y$ 在区域 $D$ 上处处连续, 且满足C-R方程, 则 $f(z)$ 在 $D$ 上可导(从而解析).
% 	\end{itemize}
% \end{theorem}

% \subsection{柯西-黎曼方程的应用}

% \begin{example}
% 	\enumnum1 函数 $f(z)=\ov z$ 在何处可导, 在何处解析?
% \end{example}

% \begin{solution}
% 	由 $u=x,v=-y$ 可知
% 	\begin{align*}
% 	u_x&=1,&u_y&=0,\\
% 	v_x&=0,&v_y&=-1.
% 	\end{align*}
% 	{因为 $u_x=1\neq v_y=-1$, 所以该函数处处不可导, 处处不解析.}
% \end{solution}
% 或由 $\dfrac{\partial f}{\partial \ov z}=1\neq0$ 看出.

% \begin{example}[续]
% 	\enumnum2 函数 $f(z)=z\Re z$ 在何处可导, 在何处解析?
% \end{example}

% \begin{solution}
% 	由 $f(z)=x^2+ixy,u=x^2,v=xy$
% 	{可知
% 	\begin{align*}
% 		u_x&=2x,&u_y&=0,\\
% 		v_x&=y, &v_y&=x.
% 	\end{align*}由 $2x=x,0=-y$ 可知只有 $x=y=0,z=0$ 满足C-R方程.因此该函数只在 $0$ 可导, 处处不解析且
% 		\[f'(0)=u_x(0)+iv_x(0)=0.\]}
% \end{solution}
% 或由 $f=\dfrac12 z(z+\ov z), \dfrac{\partial f}{\partial \ov z}=\dfrac12 z$ 看出.

% \begin{example}[续]
% 	\enumnum3 函数 $f(z)=e^x(\cos y+i\sin y)$ 在何处可导, 在何处解析?
% \end{example}

% \begin{solution}
% 	由 $u=e^x\cos y,v=e^x\sin y$
% 	{可知
% 	\begin{align*}
% 	u_x&=e^x\cos y,&u_y&=-e^x\sin y,\\
% 	v_x&=e^x\sin y,&v_y&=e^x\cos y.
% 	\end{align*}因此该函数处处可导, 处处解析, 且
% 	\[f'(z)=u_x+iv_x=e^x(\cos y+i\sin y)=f(z).\]}
% \end{solution}

% 实际上, 这个函数就是复变量的指数函数 $e^z$.

% \begin{exercise}
% 	单选题: (2022年A卷) 下面哪个函数在 $z=0$ 处不可导?~\fillbrace{{A}}
% 	\xx{$2x+3yi$}{$2x^2+3y^2i$}{$e^x\cos y+i e^x\sin y$}{$x^2-xyi$}
% \end{exercise}

% \begin{answer}
% 	根据C-R方程可知对于A, $u_x(0)=2\neq v_y(0)=3$.
% 	{对于BD, 各个偏导数在 $0$ 处取值都是 $0$.C则是处处都可导.}
% \end{answer}

% \begin{example}
% 	设函数 $f(z)=(x^2+axy+by^2)+i(cx^2+dxy+y^2)$ 在复平面内处处解析. 求实常数 $a,b,c,d$ 以及 $f'(z)$.
% \end{example}

% \begin{solution}
% 	由于

% 	\begin{align*}
% 		u_x&=2x+ay,&u_y=ax+2by,\\
% 		v_x&=2cx+dy,&v_y=dx+2y,
% 	\end{align*}
% 	{因此
% 		\[2x+ay=dx+2y,\quad ax+2by=-(2cx+dy),\]}

% 	{
% 		\[a=d=2,\quad b=c=-1,\]}

% 	{
% 		\[f'(z)=u_x+iv_x=2x+2y+i(-2x+2y)=(2-2i)z.\]}
% \end{solution}

% \begin{example}
% 	如果 $f'(z)$ 在区域 $D$ 内处处为零, 则 $f(z)$ 在 $D$ 内是一常数.
% \end{example}

% \begin{proof}
% 	由于 $f'(z)=u_x+iv_x=v_y-iu_y=0$,
% 	{因此 $u_x=v_x=u_y=v_y=0$, $u,v$ 均为常数,从而 $f(z)=u+iv$ 是常数.\qedhere}
% \end{proof}

% 类似地可以证明, 若 $f(z)$ 在 $D$ 内解析, 则下述条件等价:
% \begin{itemize}
% 	\item $f(z)$ 是一常数,
% 	\item $f'(z)=0$,
% 	\item $\arg{f(z)}$ 是一常数,
% 	\item $|f(z)|$ 是一常数,
% 	\item $\Re{f(z)}$ 是一常数,
% 	\item $\Im{f(z)}$ 是一常数,
% 	\item $v=u^2$,
% 	\item $u=v^2$.
% \end{itemize}

% \begin{example}
% 	如果 $f(z)$ 解析且 $f'(z)$ 处处非零, 则曲线族 $u(x,y)=c_1$ 和曲线族 $v(x,y)=c_2$ 互相正交.
% \end{example}

% \begin{proof}
% 	由于 $f'(z)=u_x-iu_y$, 因此 $u_x,u_y$ 不全为零.
% 	对 $u(x,y)=c_1$ 使用隐函数求导法则得 $u_x\diff x+u_y\diff y=0$,从而 $(u_y,-u_x)$ 是该曲线在 $z$ 处的非零切向量.

% 	同理 $(v_y,-v_x)$ 是 $v(x,y)=c_2$ 在 $z$ 处的非零切向量.由于
% 		\[u_yv_y+u_xv_x=u_yu_x-u_xu_y=0,\]
% 	因此二者正交.
% \end{proof}

% 当 $f'(z_0)\neq 0$ 时, 
% 经过 $z_0$ 的两条曲线 $C_1,C_2$ 的夹角和它们的像 $f(C_1),f(C_2)$ 在 $f(z_0)$ 处的夹角总是相同的.
% 这种性质被称为\emph{保角性}.

% 这是因为 $\diff f=f'(z_0)\diff z$.
% 局部来看 $f$ 把 $z_0$ 附近的点以 $z_0$ 为中心放缩 $f'(z_0)$ 倍并逆时针旋转 $\arg{f'(z_0)}$.
% 上述例子是该结论关于 $w$ 复平面上曲线族 $u=c_1,v=c_2$ 的一个特殊情形.

% 最后我们来看复数在求导中的一个应用.

% \begin{example}
% 	设 $f(z)=\dfrac1{1+z^2}$, 则它在除 $z=\pm i$ 外处处解析.
% 	{当 $z=x$ 为实数时,
% 		\begin{align*}
% 		\left(\dfrac1{1+x^2}\right)^{(n)}&=f^{(n)}(x)=\frac i2\left[\frac1{x+i}-\frac1{x-i}\right]^{(n)}\\
% 		&{=\frac i2\cdot(-1)^n n!\left[\frac1{(x+i)^{n+1}}-\frac1{(x-i)^{n+1}}\right]}\\
% 		&{=(-1)^{n+1}n!\Im\frac1{(x+i)^{n+1}}}\\
% 		&{=\frac{(-1)^nn!\sin[(n+1)\arccot x]}{(x^2+1)^{\frac{n+1}2}}.}
% 		\end{align*}}
% \end{example}

% \section{初等函数}

% \subsection{指数函数}

% 我们将实变函数中的初等函数推广到复变函数.
% 多项式函数和有理函数的解析性质已经介绍过, 这里不再重复.
% 现在我们来定义指数函数.

% 指数函数有多种等价的定义方式:
% \begin{enumerate}
% 	\item $\exp z=e^x(\cos y+i\sin y)$ (欧拉恒等式);
% 	\item $\exp z=\lim\limits_{n\to\infty}\left(1+\dfrac zn\right)^n$ (极限定义);
% 	\item $\exp z=1+z+\dfrac{z^2}{2!}+\dfrac{z^3}{3!}+\cdots
% 	=\lim\limits_{n\to\infty}\sum\limits_{k=0}^n\dfrac{z^k}{k!}$ (级数定义);
% 	\item $\exp z$ 是唯一的一个处处解析的函数, 使得当 $z=x\in\BR$ 时, $\exp z=e^x$ ($e^x$ 的解析延拓).
% \end{enumerate}

% 有些人会从 $e^x,\cos x,\sin x$ 的泰勒展开
% \begin{align*}
% 	e^x&=1+x+\frac{x^2}{2!}+\frac{x^3}{3!}+\cdots\\
% 	\cos x&=1-\frac{x^2}{2!}+\frac{x^4}{4!}+\cdots\\
% 	\sin x&=x-\frac{x^3}{3!}+\frac{x^5}{5!}\cdots
% \end{align*}
% 形式地带入得到欧拉恒等式 $e^{ix}=\cos x+i\sin x$.
% 事实上我们可以把它当做复指数函数的定义, 而不是欧拉恒等式的证明.
% 我们在学习了幂级数之后就可知\enumnum1和\enumnum3是等价的.

% 我们来证明\enumnum1和\enumnum2等价.
% \begin{align*}
% 	\lim_{n\to\infty}\abs{1+\frac zn}^n
% 	&=\lim_{n\to\infty}\left(1+\frac{2x}n+\frac{x^2+y^2}{n^2}\right)^{\frac n2}\quad
% 	{(1^\infty\ \text{型不定式})}\\
% 	&{=\exp\left[\lim_{n\to\infty}\frac n2
% 	\left(\frac{2x}n+\frac{x^2+y^2}{n^2}\right)\right]=e^x.}
% \end{align*}
% 不妨设 $n>\abs{z}$, 这样 $1+\dfrac zn$ 落在右半平面,
% \[\lim_{n\to\infty} n\arg{\left(1+\frac zn\right)}
% =\lim_{n\to\infty} n\arctan \frac y{n+x}
% {=\lim_{n\to\infty}\frac{ny}{n+x}=y.}\]
% 故 $\exp z=e^x(\cos y+i\sin y)$.

% \begin{alertblock}{指数函数}
% 定义指数函数
% 	\[\exp z:=e^x(\cos y+i\sin y).\]
% \end{alertblock}
% 我们已知 $\exp z$ 是一个处处解析的函数, 且 $(\exp z)'=\exp z$.
% 不难看出
% \begin{itemize}
% 	\item $\exp z\neq 0$;
% 	\item $\exp(z_1+z_2)=\exp z_1\cdot \exp z_2$;
% 	\item $\exp(z+2k\pi i)=\exp z$, 即 $\exp z$ 周期为 $2\pi i$;
% 	\item $\exp z_1=\exp z_2$ 当且仅当 $z_1=z_2+2k\pi i,k\in\BZ$.
% \end{itemize}
% 为了方便, 我们也记 \emph{$e^z=\exp z$}.

% 指数函数将直线族 $\Re z=c$ 映为圆周族 $\abs{w}=e^c$, 
% 将直线族 $\Im z=c$ 映为射线族 $\Arg w=c$.

% \begin{example}
% 	函数 $f(z)=e^{z/6}$ 的周期是\fillblank{{$12\pi i$}}.
% \end{example}

% \begin{solution}
% 	设 $f(z_1)=f(z_2)$, 则 $e^{z_1/6}=e^{z_2/6}$.
% 	{因此存在 $k\in\BZ$ 使得
% 		\[\frac{z_1}6=\frac{z_2}6+2k\pi i,\]从而 $z_1-z_2=12k\pi i$.所以 $f(z)$ 的周期是 $12\pi i$.}
% \end{solution}

% 一般地, $\exp(az+b)$ 的周期是 $\dfrac{2\pi i}a$ (或写成 $-\dfrac{2\pi i}a$), $a\neq 0$.

% \subsection{对数函数}

% 对数函数定义为指数函数的反函数.
% 设 $z\neq 0$, 满足方程 $e^w=z$ 的 $w=f(z)$ 被称为\emph{对数函数}, 记作 $w=\Ln z$.

% 为什么我们用大写的 $\Ln$ 呢? 
% 在复变函数中, 很多函数是多值函数.
% 为了便于研究, 我们会固定它的一个单值分支.
% 我们将多值的这个开头字母大写, 而对应的单值的则是开头字母小写.
% 例如 $\Arg z$ 和 $\arg z$.

% 设 $e^w=z=re^{i\theta}=e^{\ln r+i\theta}$,
% 则
% \[w=\ln r+i\theta+2k\pi i,\quad k\in\BZ.\]
% \begin{alertblock}{对数函数}
% 	\begin{enumerate}
% 		\item 定义对数函数
% 			\[\Ln z=\ln\abs{z}+i\Arg z.\]
% 			它是一个多值函数.
% 		\item 定义对数函数主值
% 			\[\ln z=\ln\abs{z}+i\arg z.\]

% 	\end{enumerate}
% \end{alertblock}

% 对于每一个 $k$, $\ln z+2k\pi i$ 都给出了 $\Ln z$ 的一个单值分支.
% 特别地, 当 $z=x>0$ 是正实数时, $\ln z$ 就是实变的对数函数.

% \begin{example}
% 	求 $\Ln 2,\Ln(-1)$ 以及它们的主值.
% \end{example}

% \begin{solution}
% 	\begin{enumerate}
% 		\item $\Ln2=\ln2+2k\pi i, k\in\BZ$,
% 		{主值就是 $\ln 2$.}
% 		\item $\Ln(-1)=\ln1+i\Arg(-1)=(2k+1)\pi i, k\in\BZ$,
% 		{主值是 $\pi i$.}
% 	\end{enumerate}
% \end{solution}

% \begin{example}
% 求 $\Ln(-2+3i),\Ln(3-\sqrt3 i)$.
% \end{example}

% \begin{solution}
% 	\begin{enumerate}
% 		\item $\Ln(-2+3i)=\ln\abs{-2+3i}+i\Arg(-2+3i)$

% 		{$\qquad\qquad\quad\displaystyle=\frac 12\ln 13+\left(-\arctan\frac 32+\pi+2k\pi\right)i,\quad k\in\BZ$.}
% 		\item $\Ln(3-\sqrt3i)=\ln\abs{3+\sqrt 3i}+i\Arg(3-\sqrt 3i)$

% 		{$\displaystyle=\ln 2\sqrt 3+\left(-\frac\pi6+2k\pi\right)i
% 		=\ln 2\sqrt 3+\left(2k-\frac16\right)\pi i,\quad k\in\BZ$.}
% 		% \item $\Ln(-3)=\ln(-3)+i\Arg(-3)$
% 		% {$=\ln3+(2k+1)\pi i,\quad k\in\BZ.$}
% 	\end{enumerate}
% \end{solution}

% \begin{example}
% 	解方程 $e^z-1-\sqrt 3i=0$.
% \end{example}

% \begin{solution}
% 	由于 $1+\sqrt 3 i=2e^{\frac{\pi i}3}$,
% 	{因此
% 	\[z=\Ln(1+\sqrt 3i)=\ln 2+\left(2k+\frac13\right)\pi i,\quad k\in\BZ.\]}
% \end{solution}

% \begin{exercise}
% 	求 $\ln(-1-\sqrt3 i)=$\fillblank[2cm][3mm]{{$\ln 2-\dfrac{2\pi i}3$}}.
% \end{exercise}

% 对数函数与其主值的关系是
% \[\Ln z=\ln z+\Ln 1=\ln z+2k\pi i,\quad k\in\BZ.\]

% 根据辐角以及主辐角的相应等式, 我们有
% \[\Ln(z_1\cdot z_2)=\Ln z_1+\Ln z_2,\quad
% \Ln\frac{z_1}{z_2}=\Ln z_1-\Ln z_2,\]
% \[\Ln \sqrt[n]z=\dfrac1n\Ln z.\]
% 而当 $\abs{n}\ge 2$ 时, \emph{$\Ln z^n=n\Ln z$ 不成立}.
% 以上等式换成 $\ln z$ 均不一定成立.


% 设 $x$ 是正实数, 
% 则
% \[\ln (-x)=\ln x+\pi i,\quad
% \lim_{y\to0^-}\ln (-x+yi)=\ln x-\pi i,\]
% 因此 $\ln z$ 在负实轴和零处不连续.

% 而在其它地方 $-\pi<\arg z<\pi$, $\ln z$ 是 $e^z$ 在区域 $-\pi<\Im z<\pi$ 上的单值反函数, 
% 从而 \emph{$(\ln z)'=\dfrac 1z$}, \emph{$\ln z$ 在除负实轴和零处的区域解析}.

% 也可以通过C-R方程来得到 $\ln z$ 的解析性和导数: 当 $x>0$ 时,
% \[\ln z=\half \ln(x^2+y^2)+i\arctan \frac yx,\]
% \[u_x=v_y=\frac x{x^2+y^2},\qquad v_x=-u_y=-\frac y{x^2+y^2},\]
% \[(\ln z)'=(x-yi)/(x^2+y^2)=\frac 1z.\]
% 其它情形可取虚部为 $\arccot\dfrac xy$ 或 $\arccot\dfrac xy-\pi$ 类似证明.

% \subsection{幂函数}

% \begin{alertblock}{幂函数}
% 	\begin{enumerate}
% 		\item 设 $a\neq 0$, $z\neq 0$, 定义幂函数
% 		\[w=z^a=e^{a\Ln z}
% 		=\exp\bigl[a\ln\abs{z}+ia(\arg z+2k\pi)\bigr],\quad k\in\BZ.\]
% 		\item 它的主值为
% 		\[w=e^{a\ln z}=\exp\bigl(a\ln\abs{z}+ia\arg z\bigr).\]
% 	\end{enumerate}
% \end{alertblock}

% 根据 $a$ 的不同, 这个函数有着不同的性质.

% 当 $a$ 为整数时, 因为 $e^{2ak\pi i}=1$, 所以 $w=z^a$ 是单值的.
% 此时 $z^a$ 就是我们之前定义的乘幂.

% 当 $a$ 是非负整数时, $z^a$ 在复平面上解析;
% 当 $a$ 是负整数时, $z^a$ 在 $\BC-\set0$ 上解析.

% 当 $a=\dfrac pq$ 为分数, $p,q$ 为互质的整数且 $q>1$ 时,
% \[z^{\frac pq}=\abs{z}^{\frac pq}\exp\left[\frac{ip(\arg z+2k\pi)}q\right],\quad k=0,1,\dots,q-1\]
% 具有 $q$ 个值.
% 去掉负实轴和 $0$ 之后, 它的主值 $w=\exp(a\ln z)$ 是处处解析的.
% 事实上它就是 $\sqrt[q]{z^p}=(\sqrt[q]z)^p$.
% \begin{center}
% 	\begin{tikzpicture}
% 		\draw[draw=white,cstfille1](0,0) circle (1.3);
% 		\draw[cstaxis](-2,0)--(2,0);
% 		\draw[cstaxis](0,-1.5)--(0,1.8);
% 		\draw (1.8,-0.2) node {$x$};
% 		\draw (-0.2,1.6) node {$y$};
% 		\draw (-0.2,-0.2) node {$O$};
% 		\draw[cstcurve,dcolorb] (0,0)--(-2,0);

% 		\draw[draw=white,cstfille,pattern color=dcolorc](5,0) -- ({5+cos(40)},{sin(40)}) arc (40:-40:1)--(5,0);
% 		\draw[cstaxis](3,0)--(7,0);
% 		\draw[cstaxis](5,-1.5)--(5,1.8);
% 		\draw (7,-0.2) node {$u$};
% 		\draw (4.8,1.6) node {$v$};
% 		\draw (4.8,-0.2) node {$O$};

% 		\draw[cstdash,cstarrowto,dcolorc] (1.7,0.3)to [bend left] (4.5,0.3);
% 		\draw (3,1.2) node[dcolorc] {$w=z^{2/9}$};
% 	\end{tikzpicture}
% \end{center}


% 对于其它的 $a$, $z^a$ 具有无穷多个值.
% 这是因为此时当 $k\neq0$ 时, $2k\pi a i$ 不可能是 $2\pi i$ 的整数倍. 
% 从而不同的 $k$ 得到的是不同的值.
% 去掉负实轴和 $0$ 之后,
% 它的主值 $w=\exp(a\ln z)$ 也是处处解析的.

% \begin{center}
% 	\begin{tabular}{|c|c|c|}\hline
% 		$a$& $z^a$ 的值& $z^a$ 的解析区域\\\hline
% 		&&$n\ge0$ 时处处解析\\
% 		\multirow{-2}*{整数 $n$}&\multirow{-2}*{单值}&$n<0$ 时除零点外解析\\\hline
% 		分数 $p/q$&$q$ 值&除负实轴和零点外解析\\\hline
% 		无理数或虚数&无穷多值&除负实轴和零点外解析\\\hline
% 	\end{tabular}
% \end{center}

% \begin{example}
% 	求 $1^{\sqrt 2}$ 和 $i^i$.
% \end{example}
% \begin{solution}
% 	\begin{enumerate}
% 		\item $1^{\sqrt2}=e^{\sqrt2\Ln1}$
% 			{$=e^{\sqrt 2\cdot 2k\pi i}$}
% 			{$=\cos(2\sqrt 2k\pi)+i\sin(2\sqrt 2k\pi), k\in\BZ$.}
% 		\item $i^i=e^{i\Ln i}$
% 			{$\displaystyle=\exp\left[i\cdot\left(2k+\half\right)\pi i\right]$}
% 			{$\displaystyle=\exp\left(-2k\pi-\half\pi\right)$, $k\in\BZ$.}
% 	\end{enumerate}
% \end{solution}
% \begin{exercise}
% 	填空题: (2021年A卷) $3^i$ 的主辐角是\fillblank{{$\ln 3$}}.
% \end{exercise}

% 幂函数与其主值有如下关系:
% \[z^a=e^{a\ln z}\cdot 1^a
% =e^{a\ln z}\cdot e^{2ak\pi i},\quad k\in\BZ.\]

% 对于幂函数的主值,
% \[(z^a)'=\left(e^{a\ln z}\right)'=\frac{ae^{a\ln z}}z=az^{a-1}.\]

% 一般而言, $z^a\cdot z^b=z^{a+b}$ 和 $(z^a)^b=z^{ab}$ 都是不成立的.

% 最后, 注意 $e^a$ 作为指数函数 $f(z)=e^z$ 在 $a$ 处的值和作为 $g(z)=z^a$ 在 $e$ 处的值是\emph{不同}的.
% 因为后者在 $a\not\in\BZ$ 时总是多值的.
% 前者实际上是后者的主值.
% 为避免混淆, 以后我们总\emph{默认 $e^a$ 表示指数函数 $\exp a$}.

% \subsection{三角函数和反三角函数}

% 我们知道
% \[\cos x=\frac{e^{ix}+e^{-ix}}2,\quad
% \sin x=\frac{e^{ix}-e^{-ix}}{2i}\]
% 对于任意实数 $x$ 成立,
% 我们将其推广到复数情形.

% \begin{alertblock}{余弦和正弦函数}
% 	定义余弦和正弦函数
% 	\[\displaystyle\cos z=\frac{e^{iz}+e^{-iz}}2,\quad
% 	\sin z=\frac{e^{iz}-e^{-iz}}{2i}.\]
% \end{alertblock}

% 那么欧拉恒等式 \emph{$e^{iz}=\cos z+i\sin z$ 对任意复数 $z$ 均成立}.

% 不难得到
% \[
% 	\cos(iy)=\dfrac{e^y+e^{-y}}2,\qquad
% 	{\sin(iy)=i\dfrac{e^y-e^{-y}}2.}
% \]
% 当 $y\to\infty$ 时, $\cos(iy)$ 和 $\sin(iy)$ 都 $\to\infty$.
% 因此 \emph{$\sin z$ 和 $\cos z$ 并不有界}. 
% 这和实变情形完全不同.

% 容易看出 $\cos z$ 和 $\sin z$ 的零点都是实数.
% 于是我们可类似定义其它三角函数
% \begin{align*}
% 	\tan z&=\frac{\sin z}{\cos z},z\neq\left(k+\half\right)\pi,&
% 	\cot z&=\frac{\cos z}{\sin z},z\neq k\pi,\\
% 	\sec z&=\frac{1}{\cos z},z\neq\left(k+\half\right)\pi,&
% 	\csc z&=\frac{1}{\sin z},z\neq k\pi.
% \end{align*}

% 这些三角函数的奇偶性, 周期性和导数与实变情形类似,
% \[(\cos z)'=-\sin z,\quad
% (\sin z)'=\cos z,\]
% 且在定义域范围内是处处解析的.

% 三角函数的各种恒等式在复数情形也仍然成立,
% 例如
% \begin{itemize}
% 	\item $\cos(z_1\pm z_2)=\cos z_1 \cos z_2\mp \sin z_1 \sin z_2$,
% 	\item $\sin(z_1\pm z_2)=\sin z_1 \cos z_2\pm\cos z_1 \sin z_2$,
% 	\item $\sin^2z+\cos^2z=1$.
% \end{itemize}

% 类似的, 我们可以定义双曲函数:
% \[\ch z=\frac{e^z+e^{-z}}2=\cos iz,\]
% \[\sh z=\frac{e^z-e^{-z}}2=-i\sin iz,\]
% \[\tanh z=\frac{e^z-e^{-z}}{e^z+e^{-z}}
% =-i\tan iz,\quad z\neq \left(k+\half\right)\pi i.\]
% 它们的奇偶性和导数与实变情形类似, 在定义域范围内是处处解析的.

% $\ch z,\sh z$ 的周期是 $2\pi i$, $\tanh z$ 的周期是 $\pi i$.

% 设 $z=\cos w=\dfrac{e^{iw}+e^{-iw}}2$,
% 则
% \[e^{2iw}-2ze^{iw}+1=0,\quad
% {e^{iw}=z+\sqrt{z^2-1}\ \text{(双值)}.}\]
% 因此\emph{反余弦函数}为
% \[w=\Arccos z=-i\Ln(z+\sqrt{z^2-1}).\]
% 显然它是多值的.
% 同理, 我们有:
% \begin{itemize}
% 	\item 反正弦函数 $\Arcsin z=-i\Ln(iz+\sqrt{1-z^2})$;
% 	\item 反正切函数 $\Arctan z=-\dfrac i2\Ln\dfrac{1+iz}{1-iz}, z\neq \pm i$;
% 	\item 反双曲余弦函数 $\Arch z=\Ln(z+\sqrt{z^2-1})$;
% 	\item 反双曲正弦函数 $\Arsh z=\Ln(z+\sqrt{z^2+1})$;
% 	\item 反双曲正切函数 $\Arth z=\dfrac12\Ln\dfrac{1+z}{1-z}, z\neq \pm1$.
% \end{itemize}

% \begin{example}
% 	解方程 $\sin z=2$.
% \end{example}

% \begin{solution}
% 由于 $\sin z=\dfrac{e^{iz}-e^{-iz}}{2i}=2$,
% {我们有
% \[e^{2iz}-4ie^{iz}-1=0.\]
% }{于是 $e^{iz}=(2\pm\sqrt 3)i$,
% }{
% 	\[z=-i\Ln[(2\pm\sqrt 3)i]=\left(2k+\half\right)\pi\pm i\ln(2+\sqrt3),\quad k\in\BZ.\]}
% \end{solution}

% \begin{proofblock}{另解}
% 由 $\sin z=2$ 可知
% \[\cos z=\sqrt{1-\sin^2 z}=\pm\sqrt 3i.\]
% {于是 $e^{iz}=\cos z+i\sin z=(2\pm\sqrt 3)i$,
% }{
% 	\[z=-i\Ln[(2\pm\sqrt 3)i]=\left(2k+\half\right)\pi\pm i\ln(2+\sqrt3),\quad k\in\BZ.\]}
% \end{proofblock}
% 我们总有形式
% \begin{align*}
% 	\Arcsin z&=(2k+\half)\pi\pm \theta,\\
% 	\Arccos z&=2k\pi\pm \theta,\\
% 	\Arctan z&=k\pi+\theta.
% \end{align*}

% \chapter{复变函数的积分}
% \section{复变函数积分的概念}

% \subsection{复变函数积分的定义}

% 设 $C$ 是平面上一条光滑或逐段光滑的连续曲线,
% 也就是说它的参数方程 $z=z(t),a\le t\le b$ 除去有限个点之外都有非零导数.

% 固定它的一个方向, 称为\emph{正方向}, 则我们得到一条\emph{有向曲线}.
% 和这条曲线方向相反的记作 $C^-$, 它的方向被称为该曲线\emph{负方向}.

% 对于闭路, 它的\emph{正方向总是指逆时针方向}, 负方向总是指顺时针方向.
% 以后我们不加说明的话\emph{默认是正方向}.


% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\draw[cstaxis](-3.5,0)--(3.5,0);
% 		\draw[cstaxis](0,-0.5)--(0,2.5);
% 		\draw[cstcurve,dcolorb,smooth,domain=-35:125] plot ({1.4+1.3*cos(\x)}, {1.1+1.3*sin(\x)});
% 		\draw (3.4,0.3) node[dcolorb] {$A=z(a)$};
% 		\draw (0.8,1.9) node[dcolorb] {$B=z(b)$};
% 		\fill[cstdot,dcolorb] ({1.4+1.3*cos(-35)}, {1.1+1.3*sin(-35)}) circle;
% 		\fill[cstdot,dcolorb] ({1.4+1.3*cos(125)}, {1.1+1.3*sin(125)}) circle;
% 		\draw[cstcurve,dcolorb,smooth,domain=40:45,cstarrow1to] plot ({1.4+1.3*cos(\x)}, {1.1+1.3*sin(\x)});
% 		\draw[cstcurve,dcolora,smooth,domain=-65:30,cstarrow1to] plot ({-1.4+0.7*cos(\x)}, {1.4+0.7*sin(\x)});
% 		\draw[cstcurve,dcolora,smooth,domain=25:120,cstarrow1to] plot ({-1.4+0.7*cos(\x)}, {1.4+0.7*sin(\x)});
% 		\draw[cstcurve,dcolora,smooth,domain=115:210,cstarrow1to] plot ({-1.4+0.7*cos(\x)}, {1.4+0.7*sin(\x)});
% 		\draw[cstcurve,dcolora,smooth,domain=205:300,cstarrow1to] plot ({-1.4+0.7*cos(\x)}, {1.4+0.7*sin(\x)});
% 	\end{tikzpicture}
% \end{center}

% 所谓的复变函数积分, 本质上仍然是第二类曲线积分.
% 设复变函数 $w=f(z)=u(x,y)+iv(x,y)$ 定义在区域 $D$ 内, 有向曲线 $C$ 包含在 $D$ 中.
% 形式地展开
% 	\[f(z)\diff z=(u+iv)(\!\diff x+i\diff y)=(u\diff x-v\diff y)+i(u\diff y+v\diff x).\]
% \begin{definition}
% 	如果下述右侧两个线积分均存在, 则定义
% 	\[\int_C f(z)\diff z=\int_C(u\diff x-v\diff y)+i\int_C(v\diff x+u\diff y)\]
% 	为\emph{函数 $f(z)$ 沿曲线 $C$ 的积分}.
% \end{definition}

% 当然, 我们也可以像线积分那样通过分割来定义.
% 在曲线 $C$ 上依次选择分点 $z_0=A,z_1,\dots,z_n=B$.
% 然后在每一段弧上任取 $\zeta_k\in\warc{z_{k-1}z_k}$ 并作和式
% \[S_n=\sum_{k=1}^n f(\zeta_k)\Delta z_k,\quad \Delta z_k=z_k-z_{k-1}.\]
% 然后称 $n\to\infty$, 分割的弧长 $\ra 0$ 时 $S_n$ 的极限为复变函数积分.
% 这二者是等价的.


% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\draw[cstcurve,dcolorc,smooth,domain=0:360] plot ({0.015*\x},{0.6*sin(\x)});
% 		\draw[cstcurve,dcolorc,smooth,domain=195:200,cstarrowto] plot ({0.015*\x},{0.6*sin(\x)});
% 		\fill[cstdot,dcolorc] (0,0) circle;
% 		\fill[cstdot,dcolorb]({0.015*32},{0.6*sin(32)}) circle;
% 		\fill[cstdot,dcolora]({0.015*64},{0.6*sin(64)}) circle;
% 		\fill[cstdot,dcolorb]({0.015*96},{0.6*sin(96)}) circle;
% 		\fill[cstdot,dcolora]({0.015*128},{0.6*sin(128)}) circle;
% 		\fill[cstdot,dcolorb]({0.015*160},{0.6*sin(160)}) circle;
% 		\fill[cstdot,dcolora]({0.015*232},{0.6*sin(232)}) circle;
% 		\fill[cstdot,dcolorb]({0.015*264},{0.6*sin(264)}) circle;
% 		\fill[cstdot,dcolora]({0.015*296},{0.6*sin(296)}) circle;
% 		\fill[cstdot,dcolorb]({0.015*328},{0.6*sin(328)}) circle;
% 		\fill[cstdot,dcolorc] ({0.015*360},0) circle;
% 		\draw
% 		({0.015*32},{0.6*sin(32)-0.3}) node[dcolorb] {$\zeta_1$}
% 		({0.015*64},{0.6*sin(64)+0.3}) node[dcolora] {$z_1$}
% 		({0.015*96},{0.6*sin(96)-0.3}) node[dcolorb] {$\zeta_2$}
% 		({0.015*128},{0.6*sin(128)+0.3}) node[dcolora] {$z_2$}
% 		({0.015*160},{0.6*sin(160)-0.3}) node[dcolorb] {$\zeta_3$}
% 		({0.015*232},{0.6*sin(232)+0.3}) node[dcolora] {$z_{n-2}$}
% 		({0.015*264},{0.6*sin(264)-0.3}) node[dcolorb] {$\zeta_{n-1}$}
% 		({0.015*296},{0.6*sin(296)+0.3}) node[dcolora] {$z_{n-1}$}
% 		({0.015*328},{0.6*sin(328)-0.3}) node[dcolorb] {$\zeta_n$}
% 		({0.015*180},{0.6*sin(180)+0.5}) node[dcolora] {$\ddots$}
% 		(-0.3,0) node[dcolorc] {$A$}
% 		({0.015*360+0.3},0) node[dcolorc] {$B$};
% 	\end{tikzpicture}
% \end{center}

% 如果 $C$ 是闭曲线, 则该积分记为 \emph{$\displaystyle\oint_Cf(z)\diff z$}.
% 此时该积分不依赖端点的选取.

% 如果 $C$ 是实轴上的区间 $[a,b]$ 且 $f(z)=u(x)$, 
% 则
% \[\int_Cf(z)\diff z=\int_a^bf(z)\diff z=\int_a^b u(x)\diff x\]
% 就是黎曼积分.

% 根据线积分的存在性条件可知:
% \begin{theorem}
% 如果 $f(z)$ 在 $D$ 内连续, $C$ 是光滑曲线, 则 $\displaystyle\int_Cf(z)\diff z$ 总存在.
% \end{theorem}

% \subsection{复变函数积分的计算法}

% 线积分中诸如变量替换等技巧可以照搬过来使用.
% 设
% \[C:z(t)=x(t)+iy(t),\quad a\le t\le b\]
% 是一条光滑有向曲线, 且正方向为 $t$ 增加的方向.
% 则 $\diff z=z'(t)\diff t$,

% \begin{alertblock}{复变函数积分的一般计算方法}
% 	\begin{equation}\tag{A}
% 		\int_Cf(z)\diff z=\int_a^b f(z)z'(t)\diff t.
% 	\end{equation}
% \end{alertblock}
% \noindent 如果 $C$ 的正方向是从 $z(b)$ 到 $z(a)$, 则需要交换右侧积分的上下限.

% 如果 $C$ 是逐段光滑的, 则相应的积分就是各段的积分之和.
% 以后我们\emph{只考虑逐段光滑曲线上的连续函数的积分}.

% \begin{example}
% 	求 $\displaystyle\int_Cz\diff z$, 其中 $C$ 是从原点到点 $3+4i$ 的直线段.
% \end{example}

% \begin{solution}
% 	由于 $z=(3+4i)t,0\le t\le 1$,
% 	{因此
% 	\[
% 		\int_Cz\diff z=\int_0^1(3+4i)t\cdot(3+4i)\diff t
% 		{=(3+4i)^2\int_0^1t\diff t}
% 		{=\half (3+4i)^2=-\frac72+12i.}
% 	\]}
% \end{solution}

% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\draw[cstaxis](0,0)--(3,0);
% 		\draw[cstaxis](0,0)--(0,2);
% 		\draw[cstcurve,dcolora,cstarrowto](0,0)--(1.5,2);
% 		\draw
% 			(2.5,1.2) node[dcolora,align=center] {$z=(3+4i)t$\\$0\le t\le 1$};
% 	\end{tikzpicture}
% \end{center}

% \begin{example}
% 	求 $\displaystyle\int_Cz\diff z$, 其中 $C$ 是抛物线 $y=\dfrac49x^2$ 上从原点到点 $3+4i$ 的曲线段.
% \end{example}

% \begin{solution}
% 	由于 $z=t+\dfrac49it^2,0\le t\le 3$,
% 	{因此
% 	\begin{flalign*}
% 		\int_Cz\diff z&=\int_0^3\left(t+\frac{4}9it^2\right)\cdot\left(1+\frac89it\right)\diff t&\\
% 		&{=\int_0^3\left(t+\frac43it^2-\frac{32}{81}t^3\right)\diff t}&\\
% 		&{=\left(\half t^2+\frac49it^3-\frac8{81}t^4\right)\Big|_0^3}
% 		{=-\frac72+12i.}&
% 	\end{flalign*}}
% \end{solution}


% \begin{tikzpicture}[overlay]\begin{tikzpicture}[framed,xshift=-80mm,yshift=-5mm]
% 	\draw[cstaxis](0,0)--(3,0);
% 	\draw[cstaxis](0,0)--(0,2.5);
% 	\draw[cstcurve,dcolora,domain=0:1.5,cstarrowto] plot({\x},{8*\x*\x/9});
% 	\draw
% 		(2.8,2) node[dcolora,align=center] {$z=t+\dfrac49it^2$\\[1mm]$0\le t\le 3$};
% \end{tikzpicture}\end{tikzpicture}

% \begin{example}
% 	求 $\displaystyle\int_C\Re z\diff z$, 其中 $C$ 是从原点到点 $1+i$ 的直线段.
% \end{example}

% \begin{solution}
% 	由于 $z=(1+i)t,0\le t\le 1$,
% 	{因此 $\Re z=t$,
% 		\[
% 			\int_C\Re z\diff z=\int_0^1t\cdot(1+i)\diff t
% 			{=(1+i)\int_0^1t\diff t}
% 			{=\frac{1+i}2.}
% 		\]}
% \end{solution}

% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\draw[cstaxis](0,0)--(3,0);
% 		\draw[cstaxis](0,0)--(0,2);
% 		\draw[cstcurve,dcolora,cstarrowto](0,0)--(2,2);
% 		\draw
% 			(2.4,0.9) node[dcolora,align=center] {$z=(1+i)t$\\$0\le t\le 1$};
% 	\end{tikzpicture}
% \end{center}

% \begin{example}
% 	求 $\displaystyle\int_C\Re z\diff z$, 其中 $C$ 是从原点到点 $i$ 再到 $1+i$ 的折线段.
% \end{example}
% \begin{solution}
% 	{第一段 $z=it,0\le t\le 1, \Re z=0$,}

% 	{第二段 $z=t+i$, $0\le t\le 1$, $\Re z=t$.因此
% 		$\displaystyle\int_C\Re z\diff z=\int_0^1 t\diff t=\frac12$.}

% 	\begin{center}
% 		\begin{tikzpicture}[framed]
% 			\draw[cstaxis](0,0)--(2.5,0);
% 			\draw[cstaxis](0,0)--(0,2);
% 			\draw[cstcurve,cstarrowto,dcolora](0,0)--(0,1.5);
% 			\draw[cstcurve,cstarrowto,dcolorb](0,1.5)--(1.5,1.5);
% 			\draw
% 				(-1.1,1.2) node[dcolora,align=center] {$z=it$\\$0\le t\le 1$}
% 				(2.5,1.5) node[dcolorb,align=center] {$z=t+i$\\$0\le t\le 1$};
% 		\end{tikzpicture}
% 	\end{center}
% \end{solution}

% 可以看出, 即便起点和终点相同, 沿不同路径 $f(z)=\Re z$ 的积分也可能不同.
% 而 $f(z)=z$ 的积分则只和起点和终点位置有关, 与路径无关.
% 原因在于 $f(z)=z$ 是处处解析的, 我们以后会详加解释.

% \begin{exercise}
% 	求 $\displaystyle\int_C\Im z\diff z=$\fillblank[3cm][2mm]{{$-\dfrac12+\dfrac i2$}}, 其中 $C$ 是从原点沿 $y=x$ 到点 $1+i$ 再到 $i$ 的折线段.
% 	\begin{center}
% 		\begin{tikzpicture}[scale=.8,framed]
% 			\draw[cstaxis](0,0)--(2.5,0);
% 			\draw[cstaxis](0,0)--(0,2.5);
% 			\draw[cstcurve,cstarrowto,dcolora](0,0)--(2,2);
% 			\draw[cstcurve,cstarrowto,dcolorb](2,2)--(0,2);
% 		\end{tikzpicture}
% 	\end{center}
% \end{exercise}

% \begin{example}
% 	求 $\displaystyle\oint_{|z-z_0|=r}\frac{\diff z}{(z-z_0)^{n+1}}$, 其中 $n$ 为整数.
% \end{example}
% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\draw[cstcurve,dcolorb] ({1.3*cos(120)},{1.3*sin(120)})coordinate (C) -- (0,0)coordinate (B) --(1.3,0)coordinate (A) pic [draw,dcolorb,"$\theta$",angle eccentricity=1.7,angle radius=3mm] {angle};
% 		\fill[cstdot,dcolorb](0,0) circle;
% 		\draw[cstcurve,dcolora,cstarrow1from]({1.3*cos(45)},{1.3*sin(45)}) arc (45:-320:1.3);
% 		\draw
% 			(-0.5,0.5) node[dcolorb] {$r$}
% 			(0,-0.3) node[dcolorb] {$z_0$};
% 	\end{tikzpicture}
% \end{center}
% \begin{solution}
% 	$C: |z-z_0|=r$ 的参数方程为 $z=z_0+re^{i\theta},0\le \theta\le 2\pi$.
% 	{于是 $\diff z=ire^{i\theta}\diff \theta$.}
% \end{solution}

% \begin{solutionc}
% 	\[
% 		\oint_C\frac{\diff z}{(z-z_0)^{n+1}}
% 		=\int_0^{2\pi}i(re^{i\theta})^{-n}\diff\theta
% 		{=ir^{-n}\int_0^{2\pi}e^{-in\theta}\diff\theta.}
% 	\]
% 	{当 $n=0$ 时, 该积分值为 $2\pi i$.}


% 	{当 $n\neq 0$ 时, 该积分值 $=\dfrac{ir^{-n}}{-in}e^{-in\theta}\big|_0^{2\pi}=0$.}
% \end{solutionc}
% 所以
% \begin{alertblock@}
% 	\[\oint_{|z-z_0|=r}\frac{\diff z}{(z-z_0)^{n+1}}=\begin{cases}2\pi i,&n=0;\\0,&n\neq 0.\end{cases}\]
% \end{alertblock@}

% 这个积分以后经常用到, 它的特点是积分值与圆周的圆心和半径都无关.

% \begin{theorem}
% 	\begin{enumerate}
% 		\item $\displaystyle\int_Cf(z)\diff z=-\displaystyle\int_{C^-}f(z)\diff z$.
% 		\item $\displaystyle\int_Ckf(z)\diff z=k\displaystyle\int_Cf(z)\diff z$.
% 		\item $\displaystyle\int_C[f(z)\pm g(z)]\diff z
% 		=\displaystyle\int_Cf(z)\diff z\pm\displaystyle\int_Cg(z)\diff z$.
% 			\begin{tikzpicture}[overlay,xshift=0cm,yshift=1.2cm]
% 				\draw[decorate,thick,decoration={brace,amplitude=5},dcolorb] (0,1.3)--(0,-1.3);
% 				\draw (1.2,0) node[dcolorb] {线性性质};
% 			\end{tikzpicture}
% 		\item (\emph{长大不等式}) 设 $C$ 的长度为 $L$, $f(z)$ 在 $C$ 上满足 $|f(z)|\le M$, 则
% 		\[\abs{\int_Cf(z)\diff z}\le\int_C|f(z)|\diff s\le ML.\]
% 	\end{enumerate}
% \end{theorem}

% \begin{proof}
% 	我们来证明下\enumnum4.
% 	{由
% 		\[\abs{\sum_{k=1}^n f(\zeta_k)\Delta z_k}
% 		\le\sum_{k=1}^n|f(\zeta_k)\Delta z_k|
% 		\le\sum_{k=1}^n|f(\zeta_k)|\Delta s_k
% 		\le M\sum_{k=1}^n\Delta s_k\]可知
% 		\[\abs{\int_Cf(z)\diff z}\le\int_C|f(z)|\diff s\le ML.\qedhere\]}
% \end{proof}

% 长大不等式常常用于证明等式: 估算一个积分和一个具体的数值之差不超过任意给定的 $\varepsilon$, 从而得到二者相等.

% 注意到: 如果被积函数 $f(z)$ 在 $C$ 上的点都连续, 那么 $|f(z)|$ 是 $C$ 的参变量 $t\in[a,b]$ 的连续函数, 从而有界, 即存在 $M$ 使得 $|f(z)|\le M,\forall z\in C$.

% \begin{example}
% 	设 $f(z)$ 在 $z\neq a$ 处连续, 且 $\lim\limits_{z\to a}(z-a)f(z)=k$, 则

% 	\[\lim_{r\to0}\oint_{|z-a|=r}f(z)\diff z=2\pi ik.\]
% \end{example}

% \begin{proof}
% 	$\forall \varepsilon>0,\exists\delta>0$ 使得当 $|z-a|<\delta$ 时, $|(z-a)f(z)-k|\le\varepsilon$.
% 	{当 $0<r<\delta$ 时,

% 	\begin{align*}
% 	&\peq\abs{\oint_{|z-a|=r}f(z)\diff z-2\pi i k}
% 	=\abs{\oint_{|z-a|=r}\left[f(z)-\frac k{z-a}\right]\diff z}\\
% 	&{=\abs{\oint_{|z-a|=r}\frac{(z-a)f(z)-k}{z-a}\diff z}}
% 	{\le \frac{\varepsilon}r\cdot 2\pi r=2\pi\varepsilon.}
% 	\end{align*}}
% 	{由于 $\varepsilon$ 是任意的, 因此命题得证.}
% \end{proof}

% \section{柯西-古萨基本定理和复合闭路定理}

% \subsection{柯西-古萨基本定理}

% 观察下方的两条曲线 $C_1,C_2$.
% 设 $C=C_1^-+C_2$.
% 可以看出
% \[\int_{C_1}f(z)\diff z=\int_{C_2}f(z)\diff z\iff
% \oint_Cf(z)\diff z=\int_{C_2}f(z)\diff z-\int_{C_1}f(z)\diff z=0.\]
% 所以 $f(z)$ 的积分只与起点终点有关 $\iff f(z)$ 绕任意闭路的积分为零.


% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\draw
% 			(-0.2,-0.2) node[dcolorb] {$z_0$}
% 			(2.2,2.2) node[dcolorb] {$z$}
% 			(0.2,1.8) node[dcolora] {$C_1$}
% 			(1.8,0.3) node[dcolorc] {$C_2$};
% 		\draw[cstcurve,dcolorc] (2,2) arc(0:-90:2);
% 		\draw[cstcurve,dcolorc,cstarrow1to] ({2*cos(-50)},{2+2*sin(-50)}) arc(-50:-45:2);
% 		\draw[cstcurve,dcolora] (0,0) arc(180:90:2);
% 		\draw[cstcurve,dcolora,cstarrow1to] ({2+2*cos(140)},{2*sin(140)}) arc(140:135:2);
% 		\draw[cstcurve,dcolorb,cstarrow1from] ({1+0.3*cos(135)},{1+0.3*sin(135)}) arc(135:-110:0.3);
% 	\end{tikzpicture}
% \end{center}

% 上一节中我们计算了 $f(z)=z,\Re z,\dfrac1{z-z_0}$ 的积分.
% 其中
% \begin{itemize}
% 	\item $f(z)=z$ 处处解析, 积分只与起点终点有关 (闭路积分为零);
% 	\item $f(z)=\dfrac1{z-z_0}$ 有奇点 $z_0$, 沿绕 $z_0$ 闭路的积分非零;
% 	\item $f(z)=\Re z$ 处处不解析, 积分与路径有关 (闭路积分非零).
% \end{itemize}
% 由此可见函数沿闭路积分为零,
% 与函数在闭路内部是否解析有关.

% 设 $C$ 是一条闭路, $D$ 是其内部区域.
% 设 \emph{$f(z)$ 在闭区域 $\ov D=D\cup C$ 上解析},
% 即存在区域 $B\supseteq\ov D$ 使得 $f(z)$ 在 $B$ 上解析.

% 为了简便假设 $f'(z)$ 连续,
% 则
% \[\oint_Cf(z)\diff z=\oint_C(u\diff x-v\diff y)
% +i\oint_C(v\diff x+u\diff y).\]
% 由格林公式和C-R方程可知
% \[\oint_Cf(z)\diff z=-\iint_D(v_x+u_y)\diff x\diff y
% +i\iint_D(u_x-v_y)\diff x\diff y=0.\]
% 也可以从
% \[\oint_Cf(z)\diff z=-\iint_D\frac{\partial f}{\partial \ov z}\diff z\diff \ov z=2i\iint_D\frac{\partial f}{\partial \ov z}\diff x\diff y=0\]
% 看出.

% \begin{alertblock}{柯西-古萨基本定理}
% 设 $f(z)$ 在闭路 $C$ 上连续, $C$ 内部解析, 则 $\displaystyle\oint_Cf(z)\diff z=0$.
% \end{alertblock}

% \begin{corollary}
% 设 $f(z)$ 在单连通域 $D$ 内解析, $C$ 是 $D$ 内一条闭合曲线(可以不是闭路), 则 $\displaystyle\oint_Cf(z)\diff z=0$.
% \end{corollary}

% 这是因为即使不是简单曲线也可以拆分为一些简单曲线.

% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\draw[cstcurve,dcolora,smooth,domain=-45:-15] plot({3*sqrt(cos(2*\x))*cos(\x)},{3*sqrt(cos(2*\x))*sin(\x)});
% 		\draw[cstcurve,dcolora,smooth,domain=-20:45,cstarrow1from] plot({3*sqrt(cos(2*\x))*cos(\x)},{3*sqrt(cos(2*\x))*sin(\x)});
% 		\draw[cstcurve,dcolora,smooth,domain=-45:-15] plot({-2*sqrt(cos(2*\x))*cos(\x)},{2*sqrt(cos(2*\x))*sin(\x)});
% 		\draw[cstcurve,dcolora,smooth,domain=-20:45,cstarrow1from] plot({-2*sqrt(cos(2*\x))*cos(\x)},{2*sqrt(cos(2*\x))*sin(\x)});
% 		\draw[cstcurve,dcolorb,cstarrow1from,ultra thick] (1.05,0.35) arc (135:-135:0.5);
% 		\draw[cstcurve,dcolorc,cstarrow1from,ultra thick] (-0.75,-0.25) arc (315:45:0.3535);
% 	\end{tikzpicture}
% \end{center}

% \begin{example}
% 	求 $\displaystyle\oint_{|z|=1}\frac1{2z-3}\diff z$.
% \end{example}

% \begin{solution}
% 	由于 $\dfrac1{2z-3}$ 在 $|z|\le 1$ 上解析,
% 	{因此由柯西-古萨基本定理 $\displaystyle \oint_{|z|=1}\frac1{2z-3}\diff z=0$.}
% \end{solution}

% \begin{exercise}
% 	\begin{enumerate}
% 		\item $\displaystyle\oint_{|z-2|=1}\frac1{z^2+z}\diff z=$\fillblank{{$0$}}.
% 		\item 求 $\displaystyle\oint_{|z|=2}\dfrac{\sin z}{|z|}\diff z=$\fillblank{{$0$}}.
% 	\end{enumerate}
% \end{exercise}

% \begin{example}
% 	求 $\displaystyle\oint_C\frac1{z(z^2+1)}\diff z$, 其中 $C:|z-i|=\half $.
% \end{example}

% \begin{solution}
% 	注意到 $\dfrac1{z(z^2+1)}=\dfrac1z-\dfrac12\left(\dfrac1{z+i}+\dfrac1{z-i}\right)$.
% 	{由于 $\dfrac1z,\dfrac1{z+i}$ 在 $|z-i|\le\dfrac12$ 上解析,因此由柯西-古萨基本定理
% 		\[\oint_C\frac1z\diff z
% 		=\oint_C\frac1{z+i}\diff z=0,\]
% 		\[\oint_C\frac1{z(z^2+1)}\diff z
% 		=-\half\oint_C\frac1{z-i}\diff z=-\pi i.\]}
% \end{solution}

% \subsection{复合闭路定理}

% 设 $C_0,C_1,\dots,C_n$ 是 $n+1$ 条简单闭曲线, $C_1,\dots,C_n$ 每一条都包含在其它闭路的外部, 而且它们都包含在 $C_0$ 的内部.
% 这样它们围成了一个多连通区域 $D$, 它的边界称为一个\emph{复合闭路} \[C=C_0+C_1^-+\cdots+C_n^-.\]
% 沿着 $C$ 前进的点, $D$ 总在它的左侧,所以这就是它的正方向.

% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\fill[cstcurve,cstfill] (0,0) circle(2.5 and 1.5);
% 		\fill[cstcurve,white] (1,0) circle(0.6);
% 		\fill[cstcurve,white] (-1,0) circle(0.6);
% 		\draw[cstcurve,dcolora] (0,0) circle(2.5 and 1.5);
% 		\draw[cstcurve,dcolora] (1,0) circle(0.6);
% 		\draw[cstcurve,dcolora] (-1,0) circle(0.6);
% 		\draw[cstcurve,dcolora,domain=85:90,cstarrow1to] plot ({2.5*cos(\x)}, {1.5*sin(\x)});
% 		\draw[cstcurve,dcolora,domain=135:140,cstarrow1from] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});
% 		\draw[cstcurve,dcolora,domain=135:140,cstarrow1from] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});
% 		\draw
% 			(2,1.3) node[dcolora] {$C_0$}
% 			(-1,0.85) node[dcolora] {$C_1^{-}$}
% 			(1,0.85) node[dcolora] {$C_2^{-}$};
% 	\end{tikzpicture}
% \end{center}

% \begin{alertblock}{复合闭路定理}
% 	设 $f(z)$ 在复合闭路 $C=C_0+C_1^-+\cdots+C_n^-$ 及其所围成的多连通区域内解析, 则
% 	\[\oint_{C_0}f(z)\diff z=
% 	\oint_{C_1}f(z)\diff z+\cdots+\oint_{C_n}f(z)\diff z.\]
% \end{alertblock}
% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\fill[cstcurve,cstfill] (0,0) circle(2.5 and 1.5);
% 		\fill[cstcurve,white] (1,0) circle(0.6);
% 		\fill[cstcurve,white] (-1,0) circle(0.6);
% 		\draw[cstcurve,dcolora] (0,0) circle(2.5 and 1.5);
% 		\draw[cstcurve,dcolora] (1,0) circle(0.6);
% 		\draw[cstcurve,dcolora] (-1,0) circle(0.6);
% 		\draw[cstcurve,dcolora,domain=85:90,cstarrow1to] plot ({2.5*cos(\x)}, {1.5*sin(\x)});
% 		\draw[cstcurve,dcolora,domain=135:140,cstarrow1from] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});
% 		\draw[cstcurve,dcolora,domain=135:140,cstarrow1from] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});
% 		\draw
% 			(2,1.3) node[dcolora] {$C_0$}
% 			(-1,0.85) node[dcolora] {$C_1^{-}$}
% 			(1,0.85) node[dcolora] {$C_2^{-}$};
% 	\end{tikzpicture}
% \end{center}

% \begin{proof}
% 	以曲线 $\gamma_1,\gamma_2,\dots,\gamma_{n+1}$ 把 $C_0,C_1,\dots,C_n$ 连接起来, 则它们把区域 $D$ 分成了两个单连通域 $D_1,D_2$.
% 	{对 $D_1$ 和 $D_2$ 的边界应用柯西积分定理并相加, 则 $\gamma_i$ 对应的部分正好相互抵消,因此
% 		\[\oint_{C_0}f(z)\diff z-
% 	\oint_{C_1}f(z)\diff z-\cdots-\oint_{C_n}f(z)\diff z=0.\]于是定理得证.\qedhere}


% 	\begin{center}
% 		\begin{tikzpicture}[framed,scale=.9]
% 			\fill[cstcurve,cstfill] (0,0) circle(2.5 and 1.5);
% 			\fill[cstcurve,white] (1,0) circle(0.6);
% 			\fill[cstcurve,white] (-1,0) circle(0.6);

% 			\draw[cstcurve,dcolora,domain=0:90,cstarrow1to] plot ({2.5*cos(\x)}, {1.5*sin(\x)});
% 			\draw[cstcurve,dcolora,domain=85:180] plot ({2.5*cos(\x)}, {1.5*sin(\x)});
% 			\draw[cstcurve,dcolorb,domain=180:270,cstarrow1to] plot ({2.5*cos(\x)}, {1.5*sin(\x)});
% 			\draw[cstcurve,dcolorb,domain=265:360] plot ({2.5*cos(\x)}, {1.5*sin(\x)});

% 			\draw[cstcurve,dcolora,domain=0:140] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});
% 			\draw[cstcurve,dcolora,domain=135:180,cstarrow1from] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});
% 			\draw[cstcurve,dcolorb,domain=180:320] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});
% 			\draw[cstcurve,dcolorb,domain=315:360,cstarrow1from] plot ({1+0.6*cos(\x)}, {0.6*sin(\x)});

% 			\draw[cstcurve,dcolora,domain=0:140] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});
% 			\draw[cstcurve,dcolora,domain=135:180,cstarrow1from] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});
% 			\draw[cstcurve,dcolorb,domain=180:320] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});
% 			\draw[cstcurve,dcolorb,domain=315:360,cstarrow1from] plot ({-1+0.6*cos(\x)}, {0.6*sin(\x)});

% 			\draw
% 				(2,1.3) node[dcolora] {$C_0$}
% 				(-1,0.85) node[dcolora] {$C_1^-$}
% 				(1,0.85) node[dcolora] {$C_2^-$}
% 				(-2,-0.3) node {$\gamma_1$}
% 				(0,-0.3) node {$\gamma_2$}
% 				(2,-0.3) node {$\gamma_3$};
% 			\draw[cstcurve] (-2.5,0)--(-1.6,0);
% 			\draw[cstcurve] (-0.4,0)--(0.4,0);
% 			\draw[cstcurve] (1.6,0)--(2.5,0);
% 			\draw[cstcurve,thick,dcolora] (-2.5,0.025)--(-1.6,0.025);
% 			\draw[cstcurve,thick,dcolorb] (-2.5,-0.025)--(-1.6,-0.025);
% 			\draw[cstcurve,thick,dcolora] (-0.4,0.025)--(0.4,0.025);
% 			\draw[cstcurve,thick,dcolorb] (-0.4,-0.025)--(0.4,-0.025);
% 			\draw[cstcurve,thick,dcolora] (1.6,0.025)--(2.5,0.025);
% 			\draw[cstcurve,thick,dcolorb] (1.6,-0.025)--(2.5,-0.025);
% 		\end{tikzpicture}
% 	\end{center}
% \end{proof}

% 在实际应用中, 如果被积函数 $f(z)$ 在闭路 $C$ 的内部有有限多个奇点 $z_1,\dots,z_k$.
% 那么我们可以在 $C$ 内部构造闭路 $C_1,\dots,C_k$, 使得每个 $C_j$ 内部只包含一个奇点 $z_j$.
% 这样, 内部含多个奇点的情形就可以化成内部只含一个奇点的情形. 最后将这些闭路上的积分相加即可.

% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\draw[cstcurve,dcolora] (0,0) circle(2.2 and 1.2);
% 		\draw[cstcurve,dcolorb] (1,0) circle(0.4);
% 		\draw[cstcurve,dcolorb] (0,0) circle(0.4);
% 		\draw[cstcurve,dcolorb] (-1,0) circle(0.4);
% 		\fill[cstdot,dcolorb] (1,0) circle;
% 		\fill[cstdot,dcolorb] (0,0) circle;
% 		\fill[cstdot,dcolorb] (-1,0) circle;
% 		\draw
% 			(-1,-0.25) node[dcolorb] {$z_1$}
% 			(0,-0.25) node[dcolorb] {$z_2$}
% 			(1,-0.25) node[dcolorb] {$z_3$}
% 			(1.8,1.1) node[dcolora] {$C_0$}
% 			(-1,0.65) node[dcolorb] {$C_1$}
% 			(0,0.65) node[dcolorb] {$C_2$}
% 			(1,0.65) node[dcolorb] {$C_3$};
% 	\end{tikzpicture}
% \end{center}

% 此外, 从复合闭路定理还可以看出, 在计算积分 $\displaystyle \oint_C f(z)\diff z$ 时, $C$ 的具体形状无关紧要, 只要其内部奇点不变, $C$ 可以任意变形.
% 因为我们总可以选择一个包含这些奇点的闭路 $C'$, 使得 $C'$ 包含在 $C$ 及其变形后的闭路内部. 这样它们的积分自然都和 $C'$ 上的积分相同.

% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\draw[cstcurve,dcolora] (0,0) circle(2.2 and 1.2);
% 		\draw[cstcurve,dcolorc] (0,0) circle(1.2 and 2.2);
% 		\draw[cstcurve,dcolorb] (0,0) circle(1);
% 		\fill[cstdot,dcolorb] (.7,0.2) circle;
% 		\fill[cstdot,dcolorb] (0,-0.4) circle;
% 		\fill[cstdot,dcolorb] (-.5,0.1) circle;
% 		\draw
% 			(1.8,1.1) node[dcolora] {$C_1$}
% 			(-1.1,1.8) node[dcolorc] {$C_2$}
% 			(-.4,0.65) node[dcolorb] {$C'$};
% 	\end{tikzpicture}
% \end{center}

% \begin{example}
% 	证明对于任意闭路 $C$, $\displaystyle\int_C(z-a)^n\diff z=0$, $n\neq -1$ 为整数.
% \end{example}

% \begin{proof}
% 	{如果 $a$ 不在 $C$ 的内部,则 $(z-a)^n$ 在 $C$ 及其内部解析.由柯西积分定理, $\displaystyle\int_C(z-a)^n\diff z=0$.}

% 	{如果 $a$ 在 $C$ 的内部, 则在 $C$ 的内部取一个以 $a$ 为圆心的圆周 $C_1$.由复合闭路定理以及上一节的结论
% 		\[\int_C(z-a)^n\diff z=\int_{C_1}(z-a)^n\diff z=0.\qedhere\]}
% \end{proof}

% 同理, 由复合闭路定理和上一节的结论可知当 $a$ 在 $C$ 的内部且 $n=-1$ 时积分为 $2\pi i$.
% \begin{alertblock@}
% 	当 $a$ 在 $C$ 的内部时,
% 	\[\oint_C\frac{\diff z}{(z-a)^{n+1}}=\begin{cases}2\pi i,&n=0;\\0,&n\neq 0.\end{cases}\]
% \end{alertblock@}

% \begin{example}
% 	求 $\displaystyle\int_\Gamma\frac{2z-1}{z^2-z}\diff z$, 其中 $\Gamma$ 是由 $2\pm i,-2\pm i$ 形成的矩形闭路.
% 	\begin{center}
% 		\begin{tikzpicture}[framed]
% 			\draw[cstaxis] (-2.5,0)--(2.5,0);
% 			\draw[cstaxis] (0,-1.5)--(0,1.5);
% 			\draw[cstcurve,cstarrow1to,dcolora] (-1,-0.7)--(-0.5,-0.7);
% 			\draw[cstcurve,cstarrow1to,dcolorb] (-0.4,0) arc(180:225:0.4);
% 			\draw[cstcurve,cstarrow1to,dcolorb] (0.6,0) arc(180:225:0.4);
% 			\draw[cstcurve,dcolorb] (0,0) circle (0.4);
% 			\draw[cstcurve,dcolorb] (1,0) circle (0.4);
% 			\fill[cstdot,dcolorc] (1,0) circle;
% 			\fill[cstdot,dcolorc] (0,0) circle;
% 			\draw[cstcurve,dcolora] (-2,-0.7) rectangle (2,0.7);
% 			\draw
% 				(-0.6,0.4) node[dcolorb] {$C_1$}
% 				(1.6,0.4) node[dcolorb] {$C_2$}
% 				(-1,-0.5) node[dcolora] {$\Gamma$};
% 		\end{tikzpicture}
% 	\end{center}
% \end{example}

% \begin{solution}
% 	函数 $\dfrac{2z-1}{z^2-z}$ 在 $\Gamma$ 内有两个奇点 $z=0,1$.
% 	{设 $C_1,C_2$ 如图所示,由复合闭路定理
% 		\begin{align*}
% 			&\peq\oint_\Gamma\frac{2z-1}{z^2-z}\diff z
% 			=\oint_{C_1}\frac{2z-1}{z^2-z}\diff z+\oint_{C_2}\frac{2z-1}{z^2-z}\diff z\\
% 			&{=\oint_{C_1}\frac1z\diff z+\oint_{C_1}\frac1{z-1}\diff z
% 			+\oint_{C_2}\frac1z\diff z+\oint_{C_2}\frac1{z-1}\diff z}\\
% 			&{=2\pi i+0+0+2\pi i=4\pi i.}
% 		\end{align*}}
% \end{solution}

% \begin{example}
% 	求 $\displaystyle\int_\Gamma\frac{e^z}z\diff z$, 其中 $\Gamma=C_1+C_2^-$, $C_1:|z|=2, C_2:|z|=1$.

% 	\begin{center}
% 		\begin{tikzpicture}[scale=.8,framed]
% 			\filldraw[cstcurve,dcolora,cstfill] (0,0) circle (1.5);
% 			\draw[cstcurve,dcolora,cstarrow1from] (-1.06,1.06) arc(135:90:1.5);
% 			\filldraw[cstcurve,dcolorb,fill=white] (0,0) circle (0.75);
% 			\draw[cstcurve,dcolorb,cstarrow1to] (-0.75,0) arc(180:130:0.75);
% 			\draw
% 				(-1.6,0.8) node[dcolora] {$C_1$}
% 				(0.8,-0.7) node[dcolorb] {$C_2^-$};
% 			\draw[cstaxis] (-1.8,0)--(1.8,0);
% 			\draw[cstaxis] (0,-1.8)--(0,1.8);
% 		\end{tikzpicture}
% 	\end{center}
% \end{example}
% \begin{solution}
% 	函数 $\dfrac{e^z}z$ 在 $C_1,C_2$ 围城的圆环域内解析.
% 	{由复合闭路定理可知 $\displaystyle\int_\Gamma\frac{e^z}z\diff z=0$.}
% \end{solution}

% \section{原函数和不定积分}

% \subsection{原函数}

% 设 $f(z)$ 在单连通域 $D$ 内解析, $C$ 是 $D$ 内一条起于 $z_0$ 终于 $z$ 的曲线.
% 由柯西-古萨基本定理可知, 积分 $\displaystyle\int_Cf(\zeta)\diff \zeta$ 与路径无关, 只与 $z_0,z$ 有关.
% 因此我们也将其记为 $\displaystyle\int_{z_0}^zf(\zeta)\diff\zeta$.

% 对于任意固定的 $z_0\in D$, 函数
% \[F(z)=\int_{z_0}^zf(\zeta)\diff\zeta\]
% 定义了一个单值函数.

% \begin{theorem}
% 	$F(z)$ 是 $D$ 内的解析函数, 且 $F'(z)=f(z)$.
% \end{theorem}

% \begin{proofs}
% 	\begin{center}
% 		\begin{tikzpicture}
% 			\fill[cstcurve,dcolora,rounded corners=0.5cm,cstfill] (-2.5,-0.8) rectangle (2,1);
% 			\draw[cstcurve,dcolora] (0,0) circle(0.7);
% 			\draw[cstcurve,dcolorc] (-2,0)to [bend left](0,0);
% 			\draw[cstcurve,dcolorc] (0,0)--(0.4,0.4);
% 			\fill[cstdot,dcolorc] (-2,0) circle;
% 			\fill[cstdot,dcolorc] (0,0) circle;
% 			\fill[cstdot,dcolorc] (0.4,0.4) circle;
% 			\draw
% 				(-2,-0.3) node[dcolorc] {$z_0$}
% 				(0,-0.3) node[dcolorc] {$z$}
% 				(1.1,0.7) node[dcolorc] {$z+\Delta z$};
% 		\end{tikzpicture}
% 	\end{center}

% 	以 $z$ 为中心作一包含在 $D$ 内的圆 $K$,
% 	{取 $|\Delta z|$ 小于 $K$ 的半径.那么
% 	\[F(z+\Delta z)-F(z)=\int_{z_0}^{z+\Delta z}f(\zeta)\diff\zeta-\int_{z_0}^zf(\zeta)\diff\zeta
% 	{=\int_z^{z+\Delta z}f(\zeta)\diff\zeta.}\]}

% 	{容易知道
% 	\[\int_z^{z+\Delta z}f(z)\diff\zeta=f(z)\int_z^{z+\Delta z}\diff\zeta=f(z)\Delta z.\]我们需要比较上述两个积分, 其中 $z$ 到 $z+\Delta z$ 取直线.}
% \end{proofs}

% \begin{proofe}
% 	由于 $f(z)$ 解析, 因此连续.
% 	{$\forall\varepsilon>0,\exists\delta>0$ 使得当 $|\zeta-z|<\delta$ 时, $z$ 落在 $K$ 中且 $|f(\zeta)-f(z)|<\varepsilon$.当 $|\Delta z|<\delta$ 时, 由长大不等式
% 		\begin{align*}
% 		\abs{\frac{F(z+\Delta z)-F(z)}{\Delta z}-f(z)}
% 		&{=\abs{\int_z^{z+\Delta z}\frac{f(\zeta)-f(z)}{\Delta z}\diff \zeta}}\\
% 		&{\le\frac{\varepsilon}{|\Delta z|}\cdot|\Delta z|=\varepsilon.}
% 		\end{align*}由于 $\varepsilon$ 是任意的, 因此
% 	\[f(z)=\lim_{\Delta z\to 0}\frac{F(z+\Delta z)-F(z)}{\Delta z}=F'(z).\qedhere\]}
% \end{proofe}

% \subsection{牛顿-莱布尼兹定理}

% \begin{alertblock}{牛顿-莱布尼兹定理}
% 	设 $f(z)$ 在单连通区域 $D$ 上解析, $z_1$ 至 $z_2$ 的积分路径落在 $D$ 内, 则
% 	\begin{equation}\tag{B}
% 		\int_{z_1}^{z_2}f(z)\diff z=F(z_1)-F(z_2),\quad\text{其中}\quad F'(z)=f(z).
% 	\end{equation}
% \end{alertblock}

% 如果 $D$ 上的解析函数 $G(z)$ 满足 $G'(z)=f(z)$, 则称 $G(z)$ 是 $f(z)$ 的一个\emph{原函数}.
% 由于导函数为 $0$ 的解析函数只能是常值函数,
% 因此 $\displaystyle G(z)=\int_{z_0}^zf(z)\diff z+C$.
% 我们称之为 $f(z)$ 的\emph{不定积分}, 记为 \emph{$\displaystyle\int f(z)\diff z$}.

% 复变函数和实变函数的牛顿-莱布尼兹定理的差异在哪呢?
% 复变情形要求是\emph{单连通区域上解析函数}, 实变情形要求是\emph{闭区间上连续函数}.

% \begin{example}
% 	求 $\displaystyle\int_{z_0}^{z_1}z\diff z$.
% \end{example}

% \begin{solution}
% 	由于 $f(z)=z$ 处处解析,
% 	{且 $\displaystyle\int z\diff z=\half  z^2+C$,因此
% 	\[\int_{z_0}^{z_1}z\diff z=\half z^2\big|_{z_0}^{z_1}=\half (z_1^2-z_0^2).\]}
% \end{solution}
% 因此之前的例子中 $\displaystyle\int_0^{3+4i}z\diff z=-\frac72+12i$, 无论从 $0$ 到 $3+4i$ 的路径如何.

% \begin{example}
% 	求 $\displaystyle\int_0^{\pi i}z\cos z^2\diff z$.
% \end{example}

% \begin{solution}
% 	由于 $f(z)=z\cos z^2$ 处处解析,
% 	{且
% 	\[\int z\cos z^2\diff z=\half\int \cos z^2\diff z^2=\half\sin z^2+C,\]因此
% 	\[\int_0^{\pi i}z\cos z^2\diff z=\half\sin z^2\big|_0^{\pi i}=-\half\sin \pi^2.\]}
% \end{solution}

% 这里我们使用了\emph{凑微分法}.

% \begin{example}
% 	求 $\displaystyle\int_0^i z\cos z\diff z$.
% \end{example}

% \begin{solution}
% 	由于 $f(z)=z\cos z$ 处处解析,
% 	{且
% 		\[\int z\cos z\diff z
% 		=\int z\diff(\sin z)
% 		=z\sin z-\int \sin z\diff z
% 		{=z\sin z+\cos z+C,}\]因此
% 		\[\int_0^i z\cos z\diff z
% 		=(z\sin z+\cos z)\big|_0^i
% 		{=i\sin i+\cos i-1=e^{-1}-1.}
% 		\]}
% \end{solution}

% 这里我们使用了\emph{分部积分法}.

% \begin{example}
% 	求 $\displaystyle\int_1^{1+i} z e^z\diff z$.
% \end{example}

% \begin{solution}
% 	由于 $f(z)=ze^z$ 处处解析,
% 	{且
% 	\[\int z e^z\diff z=\int z\diff e^z=ze^z-\int e^z\diff z=(z-1)e^z+c,\]因此

% 		\begin{align*}
% 		\int_1^{1+i} z e^z\diff z&=(z-1)e^z\big|_1^{1+i}\\
% 		&{=ie^{1+i}=e(-\sin 1+i\cos 1).}
% 		\end{align*}}
% \end{solution}

% \begin{exercise}
% 	求 $\displaystyle\int_0^1 z\sin z\diff z=$\fillblank[4cm]{{$\sin 1-\cos 1$}}.
% \end{exercise}
% \begin{example}
% 	求 $\displaystyle\int_C(2z^2+8z+1)\diff z$, 其中 $C$ 是摆线
% 	$\displaystyle\begin{cases}
% 	x=a(\theta-\sin\theta),& \\ y=a(1-\cos\theta),
% 	\end{cases} 0\le \theta\le 2\pi.$

% 	\begin{center}
% 		\begin{tikzpicture}[framed]
% 			\draw[cstaxis](0,0)--(5,0);
% 			\draw[cstaxis](0,0)--(0,1.8);
% 			\draw[cstcurve,dcolora,smooth,domain=0:360] plot ({0.7*(pi/180*\x-sin(\x))}, {0.7*(1-cos(\x))});
% 			\draw[cstcurve,dcolorb] (0,0.7) circle (0.7);
% 			\fill[cstdot,dcolora] (0,0) circle;
% 			\draw[cstcurve,dcolorb] ({0.7*(pi/180*60)},0.7) circle (0.7);
% 			\fill[cstdot,dcolora] ({0.7*(pi/180*60-sin(60))},{0.7*(1-cos(60))}) circle;
% 			\draw[cstcurve,dcolorb] ({0.7*(pi/180*120)},0.7) circle (0.7);
% 			\fill[cstdot,dcolora] ({0.7*(pi/180*120-sin(120))},{0.7*(1-cos(120))}) circle;
% 			\draw[cstcurve,dcolorb] ({0.7*(pi/180*180)},0.7) circle (0.7);
% 			\fill[cstdot,dcolora] ({0.7*(pi/180*180-sin(180))},{0.7*(1-cos(180))}) circle;
% 			\draw[cstcurve,dcolorb] ({0.7*(pi/180*240)},0.7) circle (0.7);
% 			\fill[cstdot,dcolora] ({0.7*(pi/180*240-sin(240))},{0.7*(1-cos(240))}) circle;
% 			\draw[cstcurve,dcolorb] ({0.7*(pi/180*300)},0.7) circle (0.7);
% 			\fill[cstdot,dcolora] ({0.7*(pi/180*300-sin(300))},{0.7*(1-cos(300))}) circle;
% 			\draw[cstcurve,dcolorb] ({0.7*(pi/180*360)},0.7) circle (0.7);
% 			\fill[cstdot,dcolora] ({0.7*(pi/180*360-sin(360))},{0.7*(1-cos(360))}) circle;
% 		\end{tikzpicture}
% 	\end{center}
% \end{example}

% \begin{solution}
% 	由于 $f(z)=2z^2+8z+1$ 处处解析,
% 	{因此
% 		\begin{align*}
% 		&\peq\int_C(2z^2+8z+1)\diff z=\int_0^{2\pi a}(2z^2+8z+1)\diff z\\
% 		&{=\left(\frac23z^3+4z^2+z\right)\bigg|_0^{2\pi a}=\frac{16}3\pi^3a^3+16\pi^2a^2+2\pi a.}
% 		\end{align*}}
% \end{solution}

% \begin{example}
% 	设 $C$ 为沿着 $|z|=1$ 从 $1$ 到 $i$ 的逆时针圆弧, 求 $\displaystyle\int_C\frac{\ln(z+1)}{z+1}\diff z$.
% \end{example}

% \begin{solution}
% 	函数 $f(z)=\dfrac{\ln(z+1)}{z+1}$ 在 $\Re z\le -1$ 外的单连通区域解析.

% 	{
% 		\[\int\frac{\ln(z+1)}{z+1}\diff z
% 		=\int\ln(z+1)\diff[\ln(z+1)]=\half\ln^2(z+1)+c.\]因此

% 		\begin{align*}
% 		&\peq\int_C\frac{\ln(z+1)}{z+1}\diff z=\half\ln^2(z+1)\big|_1^i
% 		{=\half\left[\ln^2(1+i)-\ln^22\right]}\\
% 		&{=\half\left[\left(\ln\sqrt2+\frac\pi4i\right)^2-\ln^22\right]
% 		=-\frac{\pi^2}{32}-\frac38\ln^22+\frac{\pi\ln2}{8}i.}
% 		\end{align*}}
% \end{solution}

% \section{柯西积分公式}

% \subsection{柯西积分公式}

% 柯西积分定理是解析函数理论的基础, 但在很多情形下它由柯西积分公式表现.

% \begin{alertblock}{柯西积分公式}
% 	设
% 	\begin{itemize}
% 		\item 函数 $f(z)$ 在闭路或复合闭路 $C$ 及其内部 $D$ 解析,
% 		\item $z_0\in D$,
% 	\end{itemize}
% 	则
% 		\[f(z_0)=\frac1{2\pi i}\oint_C\frac{f(z)}{z-z_0}\diff z.\]
% \end{alertblock}

% 如果 $z_0\notin D$, 由柯西-古萨基本定理, 右侧的积分是 $0$.

% 解析函数可以用一个积分
% \[f(z)=\frac1{2\pi i}\oint_C\frac{f(\zeta)}{\zeta-z}\diff\zeta,\quad z\in D\]
% 来表示, 这是研究解析函数理论的强有力工具.

% 解析函数在闭路 $C$ 内部的取值完全由它在 $C$ 上的值所确定. 这也是解析函数的特征之一.
% 特别地, 解析函数在圆心处的值等于它在圆周上的平均值.
% 设 $z=z_0+Re^{i\theta}$, 则 $\diff z=iRe^{i\theta}\diff\theta$,
% \[f(z_0)=\frac1{2\pi i}\oint_C\frac{f(z)}{z-z_0}\diff z=\frac1{2\pi}\int_0^{2\pi}f(z_0+Re^{i\theta})\diff\theta.\]

% \begin{proof}
% 	由连续性可知, $\forall\varepsilon>0,\exists\delta>0$ 使得当 $|z-z_0|\le\delta$ 时, $z\in D$ 且 $|f(z)-f(z_0)|<\varepsilon$.
% 	{设 $\Gamma:|z-z_0|=\delta$,则
% 		\begin{align*}
% 		&\peq\abs{\oint_C\frac{f(z)}{z-z_0}\diff z-2\pi i f(z_0)}
% 		\xeq{\text{复合闭路定理}}\abs{\oint_\Gamma\frac{f(z)}{z-z_0}\diff z-2\pi i f(z_0)}\\
% 		&{=\abs{\oint_\Gamma\frac{f(z)}{z-z_0}\diff z-\oint_\Gamma\frac{f(z_0)}{z-z_0}\diff z}
% 		=\abs{\oint_\Gamma\frac{f(z)-f(z_0)}{z-z_0}\diff z}}\\
% 		&{\le \frac\varepsilon \delta\cdot 2\pi \delta=2\pi \varepsilon.}
% 		\end{align*}由 $\varepsilon$ 的任意性可知 
% 		$\displaystyle\oint_C\frac{f(z)}{z-z_0}\diff z=2\pi i f(z_0)$.\qedhere}
% \end{proof}

% 从柯西积分公式可以看出, 被积函数分子解析而分母形如 $z-z_0$ 时, 绕闭路的积分可以使用该公式计算.

% \begin{example}
% 	求 $\displaystyle\oint_{|z|=4}\frac{\sin z}z\diff z$.
% \end{example}

% \begin{solution}
% 	函数 $\sin z$ 处处解析.
% 	{取 $f(z)=\sin z, z_0=0$ 并应用柯西积分公式得
% 		\[\oint_{|z|=4}\frac{\sin z}z\diff z
% 		=2\pi i \sin z|_{z=0}=0.\]}
% \end{solution}

% \begin{example}
% 	求 $\displaystyle\oint_{|z|=2}\frac{e^z}{z-1}\diff z$.
% \end{example}

% \begin{solution}
% 	由于函数 $e^z$ 处处解析,
% 	{取 $f(z)=e^z, z_0=1$ 并应用柯西积分公式得
% 		\[\oint_{|z|=2}\frac{e^z}{z-1}\diff z
% 		=2\pi i e^z|_{z=1}=2\pi ei.\]}
% \end{solution}

% \begin{exercise}
% 	求 $\displaystyle\oint_{|z|=2\pi}\frac{\cos z}{z-\pi}\diff z=$\fillblank{{$-2\pi i$}}.
% \end{exercise}

% \begin{example}
% 	设 $f(z)=\displaystyle\oint_{|\zeta|=\sqrt3}\frac{3\zeta^2+7\zeta+1}{\zeta-z}\diff \zeta$, 求 $f'(1+i)$.
% \end{example}

% \begin{solution}
% 	当 $|z|<\sqrt3$ 时,由柯西积分公式得
% 	\[
% 		f(z)=\oint_{|\zeta|=\sqrt3}\frac{3\zeta^2+7\zeta+1}{\zeta-z}\diff \zeta
% 		{=2\pi i(3\zeta^2+7\zeta+1)|_{\zeta=z}=2\pi i(3z^2+7z+1).}
% 	\]
% 	{因此 $f'(z)=2\pi i(6z+7)$,
% 		\[f'(1+i)=2\pi i(13+6i)=-12\pi+26\pi i.\]}
% \end{solution}
% 注意当 $|z|>\sqrt3$ 时, $f(z)\equiv0$.

% \begin{example}
% 	求 $\displaystyle\oint_{|z|=3}\frac{e^z}{z(z^2-1)}\diff z$.
% \end{example}

% \begin{solution}
% 	被积函数的奇点为 $0,\pm1$.
% 	设 $C_1,C_2,C_3$ 分别为绕 $0,1,-1$ 的分离圆周.由复合闭路定理和柯西积分公式
% 		\begin{flalign*}
% 		&\peq\oint_{|z|=3}\frac{e^z}{z(z^2-1)}\diff z
% 		=\oint_{C_1+C_2+C_3}\frac{e^z}{z(z^2-1)}\diff z&&\\
% 		&{=2\pi i\left[\frac{e^z}{z^2-1}\bigg|_{z=0}+\frac{e^z}{z(z+1)}\bigg|_{z=1}+\frac{e^z}{z(z-1)}\bigg|_{z=-1}\right]}&&\\
% 		&{=2\pi i\left(-1+\frac e2+\frac{e^{-1}}2\right)=\pi i(e+e^{-1}-2).&&}
% 		\end{flalign*}
% 	\begin{tikzpicture}[overlay]\begin{tikzpicture}[scale=.7,framed,xshift=-120mm,yshift=-30mm]
% 		\draw[cstaxis] (-2.1,0)--(2.1,0);
% 		\draw[cstaxis] (0,-2)--(0,2.1);
% 		\draw[cstcurve,dcolorb] (0,0) circle (1.8);
% 		\draw[cstcurve,dcolora] (1.2,0) circle(0.5);
% 		\draw[cstcurve,dcolora] (-1.2,0) circle(0.5);
% 		\draw[cstcurve,dcolora] (0,0) circle(0.5);
% 		\fill[cstdot,dcolorb] (0,0) circle;
% 		\fill[cstdot,dcolorb] (1.2,0) circle;
% 		\fill[cstdot,dcolorb] (-1.2,0) circle;
% 		\draw
% 			(1.6,1.6) node[dcolorb] {$C$}
% 			(-0.4,0.8) node[dcolora] {$C_1$}
% 			(1.2,-.8) node[dcolora] {$C_2$}
% 			(-1.2,-.8) node[dcolora] {$C_3$};
% 	\end{tikzpicture}\end{tikzpicture}
% \end{solution}

% \subsection{高阶导数的柯西积分公式}

% 解析函数可以由它的积分所表示.
% 不仅如此, 通过积分表示, 还可以说明\emph{解析函数是任意阶可导的}.

% \begin{alertblock}{柯西积分公式}
% 	设函数 $f(z)$ 在闭路或复合闭路 $C$ 及其内部 $D$ 解析, 则对任意 $z_0\in D$,
% 	\[f^{(n)}(z_0)=\frac{n!}{2\pi i}\oint_C\frac{f(z)}{(z-z_0)^{n+1}}\diff z.\]
% \end{alertblock}

% 假如 $f(z)$ 有泰勒展开
% \[f(z)=f(z_0)+f'(z_0)(z-z_0)+\cdots+\frac{f^{(n)}(z_0)}{n!}(z-z_0)^n+\cdots\]
% 那么由 $\displaystyle\oint_C \frac{\diff z}{(z-z_0)^n}$ 的性质可知上述公式右侧应当为 $f^{(n)}(z_0)$.

% \begin{proofs*}
% 	先证明 $n=1$ 的情形.
% 	{设 $\delta$ 为 $z_0$ 到 $C$ 的最短距离.当 $|h|<\delta$ 时, $z_0+h\in D$.由柯西积分公式,
% 		\[f(z_0)=\frac1{2\pi i}\oint_C\frac{f(z)}{z-z_0}\diff z,\ 
% 		f(z_0+h)=\frac1{2\pi i}\oint_C\frac{f(z)}{z-z_0-h}\diff z.\]两式相减得到
% 		\[\frac{f(z_0+h)-f(z_0)}h=\frac1{2\pi i}\emph{\oint_C\frac{f(z)}{(z-z_0)(z-z_0-h)}\diff z}.\]当 $h\to 0$ 时, 左边的极限是 $f'(z_0)$.因此我们只需要证明右边的极限等于 
% 		$\displaystyle\frac1{2\pi i}\emph{\oint_C\frac{f(z)}{(z-z_0)^2}\diff z}$.}
% \end{proofs*}

% \begin{proofe*}
% 	二者之差 $=\displaystyle\frac1{2\pi i}\oint_C\frac{h f(z)}{(z-z_0)^2(z-z_0-h)}\diff z$.
% 	{由于 $f(z)$ 在 $C$ 上连续, 故存在 $M$ 使得 $|f(z)|\le M$.注意到 $z\in C$, $|z-z_0|\ge \delta$, $|z-z_0-h|\ge\delta-|h|$.由长大不等式,
% 		\[\abs{\oint_C\frac{h f(z)}{(z-z_0)^2(z-z_0-h)}\diff z}\le\frac{M|h|}{\delta^2(\delta-|h|)}\cdot L,\]
% 	其中 $L$ 是闭路 $C$ 的长度.当 $h\to0$ 时, 它的极限为 $0$, 因此 $n=1$ 情形得证.}

% 	{对于一般的 $n$, 我们通过归纳法将 $f^{(n)}(z_0)$ 和 $f^{(n)}(z_0+h)$ 表达为积分形式.比较 $\dfrac{f^{(n)}(z_0+h)-f^{(n)}(z_0)}h$ 与积分公式右侧之差, 并利用长大不等式证明 $h\to 0$ 时, 差趋于零.具体过程省略.\qedhere}
% \end{proofe*}

% \emph{柯西积分公式不是用来计算高阶导数的, 而是用高阶导数来计算积分的.}

% \begin{example}
% 	求 $\displaystyle\oint_{|z|=2}\frac{\cos(\pi z)}{(z-1)^5}\diff z.$
% \end{example}

% \begin{solution}
% 	由于 $\cos(\pi z)$ 处处解析,
% 	{因此由柯西积分公式,
% 		\[
% 		\oint_{|z|=2}\frac{\cos(\pi z)}{(z-1)^5}\diff z
% 		=\frac{2\pi i}{4!}[\cos(\pi z)]^{(4)}\big|_{z=1}
% 		{=\frac{2\pi i}{24}\cdot \pi^4\cos \pi=-\frac{\pi^5 i}{12}.}
% 		\]}
% \end{solution}

% \begin{example}
% 	求 $\displaystyle\oint_{|z|=2}\frac{e^z}{(z^2+1)^2}\diff z.$
% \end{example}

% \begin{solution}
% 	$\dfrac{e^z}{(z^2+1)^2}$ 在 $|z|<2$ 的奇点为 $z=\pm i$.
% 	{取 $C_1,C_2$ 为以 $i,-i$ 为圆心的分离圆周.由复合闭路定理,
% 		\[\oint_{|z|=2}\frac{e^z}{(z^2+1)^2}\diff z
% 		=\oint_{C_1}\frac{e^z}{(z^2+1)^2}\diff z
% 		+\oint_{C_2}\frac{e^z}{(z^2+1)^2}\diff z.\]}
% \end{solution}

% \begin{solutionc}
% 	由柯西积分公式,
% 		\begin{align*}
% 		&\peq\oint_{C_1}\frac{e^z}{(z^2+1)^2}\diff z
% 		=\frac{2\pi i}{1}\left[\frac{e^z}{(z+i)^2}\right]'\Big|_{z=i}\\
% 		&{=2\pi i\left[\frac{e^z}{(z+i)^2}-\frac{2e^z}{(z+i)^3}\right]\Big|_{z=i}
% 		=\frac{(1-i)e^i\pi}2.}
% 		\end{align*}

% 	{类似地, $\displaystyle\oint_{C_2}\frac{e^z}{(z^2+1)^2}\diff z=\frac{-(1+i)e^{-i}\pi}2$.故
% 		\[\oint_{|z|=2}\frac{e^z}{(z^2+1)^2}\diff z
% 		=\frac{(1-i)e^i\pi}2+\frac{-(1+i)e^{-i}\pi}2
% 		=\pi i(\sin1-\cos1).\]}
% \end{solutionc}

% \begin{example}
% 	求 $\displaystyle\oint_{|z|=1}z^ne^z\diff z$, 其中 $n$ 是整数.
% \end{example}

% \begin{solution}
% 	当 $n\ge 0$ 时, $z^ne^z$ 处处解析.
% 	{由柯西-古萨基本定理, 
% 		\[\oint_{|z|=1}z^ne^z\diff z=0.\]当 $n\le-1$ 时, $e^z$ 处处解析.由柯西积分公式,
% 		\[\oint_{|z|=1}z^ne^z\diff z
% 		=\frac{2\pi i}{(-n-1)!}(e^z)^{(-n-1)}\big|_{z=0}
% 		=\frac{2\pi i}{(-n-1)!}.\]}
% \end{solution}

% \begin{example}
% 	求 $\displaystyle\oint_{|z-3|=2}\frac1{(z-2)^2z^3}\diff z$ 和 $\displaystyle\oint_{|z-1|=2}\frac1{(z-2)^2z^3}\diff z$.
% \end{example}

% \begin{solution}
% 	\enumnum1 $\dfrac1{(z-2)^2z^3}$ 在 $|z-3|<2$ 的奇点为 $z=2$.
% 	{由柯西积分公式,
% 		\[\oint_{|z-3|=2}\frac1{(z-2)^2z^3}\diff z
% 		=\frac{2\pi i}{1!}\left(\frac1{z^3}\right)'\bigg|_{z=2}
% 		=-\frac{3\pi i}8.\]}
% \end{solution}

% \begin{solutionc}
% 	\enumnum2 $\dfrac1{(z-2)^2z^3}$ 在 $|z-1|<3$ 的奇点为 $z=0,2$.
% 	{取 $C_1,C_2$ 分别为以 $0$ 和 $2$ 为圆心的分离圆周.由复合闭路定理和柯西积分公式,
% 		\begin{align*}
% 		&\peq\oint_{|z-1|=3}\frac1{(z-2)^2z^3}\diff z=\oint_{C_1}\frac1{(z-2)^2z^3}\diff z+\oint_{C_2}\frac1{(z-2)^2z^3}\diff z\\
% 		&{=\frac{2\pi i}{2!}\left[\frac1{(z-2)^2}\right]''\Big|_{z=0}+\frac{2\pi i}{1!}\left(\frac1{z^3}\right)'\Big|_{z=2}=0.}
% 		\end{align*}}
% \end{solutionc}

% \begin{exercise}
% 	$\displaystyle\oint_{|z-2i|=3}\frac1{z^2(z-i)}\diff z=$\fillblank{{$0$}}.
% \end{exercise}

% \begin{example}[莫累拉定理]
% 	设 $f(z)$ 在单连通域 $D$ 内连续, 且对于 $D$ 中任意闭路 $C$ 都有 $\displaystyle\oint_Cf(z)\diff z=0$, 则 $f(z)$ 在 $D$ 内解析.
% \end{example}

% 该定理可视作柯西-古萨基本定理的逆定理.

% \begin{proof}
% 	由题设可知 $f(z)$ 的积分与路径无关.
% 	{固定 $z_0\in D$, 则
% 		\[F(z)=\int_{z_0}^zf(z)\diff z\]
% 	定义了 $D$ 内的一个函数.类似于原函数的证明可知 $F'(z)=f(z)$.故 $f(z)$ 作为解析函数 $F(z)$ 的导数也是解析的.\qedhere}
% \end{proof}

% 高阶柯西积分公式说明解析函数的导数与实函数的导数有何不同?
% 高阶柯西积分公式说明, 函数 $f(z)$ 只要在区域 $D$ 中处处可导, 它就一定无限次可导, 并且各阶导数仍然在 $D$ 中解析.
% \emph{这一点与实变量函数有本质的区别.}

% 同时我们也可以看出, 如果一个二元实函数 $u(x,y)$ 是一个解析函数的实部或虚部, 则 $u$ 也是具有任意阶偏导数.
% 这便引出了调和函数的概念.

% \section{解析函数与调和函数的关系}

% \subsection{调和函数}

% 调和函数是一类重要的二元实变函数, 它和解析函数有着紧密的联系.
% 为了简便, 我们用 $u_{xx},u_{yy}$ 来表示二阶偏导数.

% \begin{definition}
% 	如果二元实变函数 $u(x,y)$ 在区域 $D$ 内有二阶连续偏导数, 且满足拉普拉斯方程
% 	\[\Delta u:=u_{xx}+u_{yy}=0,\]
% 	则称 $u(x,y)$ 是 $D$ 内的\emph{调和函数}.
% \end{definition}

% \begin{theorem}
% 	区域 $D$ 内解析函数 $f(z)$ 的实部和虚部都是调和函数.
% \end{theorem}

% \begin{proof}
% 	设 $f(z)=u(x,y)+iv(x,y)$, 则 $u,v$ 存在偏导数且
% 		\[f'(z)=u_x+iv_x=v_y-iu_y.\]
% 	{由于 $f(z)$ 任意阶可导, 因此 $u,v$ 存在任意阶偏导数.由C-R方程 $u_x=v_y,u_y=-v_x$可知
% 		\[\Delta u=u_{xx}+u_{yy}=v_{yx}-v_{xy}=0,\]}

% 	{
% 		\[\Delta v=v_{xx}+v_{yy}=-u_{yx}+u_{xy}=0.\qedhere\]}
% \end{proof}

% \subsection{共轭调和函数}

% 反过来, 调和函数是否一定是某个解析函数的实部或虚部呢?
% 对于单连通的情形, 答案是肯定的.

% 如果 $u+iv$ 是区域 $D$ 内的解析函数, 则我们称 $v$ 是 $u$ 的\emph{共轭调和函数}.
% 换言之 $u_x=v_y,u_y=-v_x$.
% 显然 $-u$ 是 $v$ 的共轭调和函数.
% \begin{theorem}
% 	设 $u(x,y)$ 是单连通域 $D$ 内的调和函数, 则线积分
% 	\[v(x,y)=\int_{(x_0,y_0)}^{(x,y)}-u_y\diff x+u_x\diff y+C\]
% 	是 $u$ 的共轭调和函数.
% \end{theorem}
% 由此可知, 区域 $D$ 上的调和函数在 $z\in D$ 的一个邻域内是一解析函数的实部, 从而在该邻域内具有任意阶连续偏导数.
% 而 $z$ 的任取的, 因此调和函数总具有任意阶连续偏导数.

% 如果 $D$ 是多连通区域, 则未必存在共轭调和函数.
% 例如 $\ln(x^2+y^2)$ 是复平面去掉原点上的调和函数, 但它并不是某个解析函数的实部.
% 事实上, 它是 $2\Ln z$ 的实部.

% 在实际计算中, 我们\emph{一般不用线积分}来得到共轭调和函数, 而是采用下述两种办法:
% \begin{alertblock}{偏积分法}
% 	通过 $v_y=u_x$ 解得 $v=\varphi(x,y)+\psi(x)$, 其中 $\psi(x)$ 待定.
% 	{再代入 $u_y=-v_x$ 中解出 $\psi(x)$.}
% \end{alertblock}
% \begin{alertblock}{不定积分法}
% 	对 $f'(z)=u_x-iu_y=v_y+iv_x$ 求不定积分得到 $f(z)$.
% \end{alertblock}

% \begin{example}
% 	证明 $u(x,y)=y^3-3x^2y$ 是调和函数, 并求其共轭调和函数以及由它们构成的解析函数.
% \end{example}

% \begin{solution*}
% 	由 $u_x=-6xy,u_y=3y^2-3x^2$ 可知 $u_{xx}+u_{yy}=-6y+6y=0$,
% 	{故 $u$ 是调和函数.}

% 	{由 $v_y=u_x=-6xy$ 得 $v=-3xy^2+\psi(x)$.}

% 	{由 $v_x=-u_y=3x^2-3y^2$ 得 $\psi'(x)=3x^2$,$\psi(x)=x^3+C$.}

% 	{故 $v(x,y)=-3xy^2+x^3+C$,
% 	\[
% 		f(z)=u+iv=y^3-3x^2y+i(-3xy^2+x^3+C)
% 		{=i(x+iy)^3+iC=i(z^3+C).}
% 	\]}
% \end{solution*}

% 当解析函数 $f(z)$ 为 $x,y$ 的多项式形式时, 将 $m$ 次齐次的项放一起, 则 $x^m$ 的系数就是 $f(z)$ 中 $z^m$ 的系数.

% 在上例中我们也可由另一种方法计算得到:
% \[f'(z)=u_x-iu_y=-6xy-i(3y^2-3x^2)=3iz^2.\]
% 因此 $f(z)=iz^3+C$.

% \begin{example}
% 	求解析函数 $f(z)$ 使得它的虚部为
% 	\[v(x,y)=e^x(y\cos y+x\sin y)+x+y.\]
% \end{example}

% \begin{solution}
% 	由 $u_x=v_y=e^x(\cos y-y\sin y+x\cos y)+1$ 得
% 	\[u=e^x(x\cos y-y\sin y)+x+\psi(y).\]
% 	{由 $u_y=-v_x=-e^x(y\cos y+x\sin y+\sin y)-1$ 得
% 	\[\psi'(y)=-1,\quad\psi(y)=-y+C.\]}
% \end{solution}

% \begin{solutionc}
% 	故

% 	\begin{align*}
% 		f(z)&=u+iv\\
% 		&=e^x(x\cos y-y\sin y)+x-y+C
% 		+i\bigl[e^x(y\cos y+x\sin y)+x+y\bigr]\\
% 		&{=ze^z+(1+i)z+C,\quad C\in\BR.}
% 	\end{align*}
% \end{solutionc}
% 这里, 我们只需看 $e^x\cos y$ 的系数 $x+iy=z$, 即 $f(z)$ 中 $e^z$ 的系数.

% 也可由
% \begin{align*}
% 	f'(z)&=v_y+iv_x\\
% 	&=e^x(\cos y-y\sin y+x\cos y)+1
% 	+i\bigl[e^x(y\cos y+x\sin y+\sin y)+1\bigr]\\
% 	&{=(z+1)e^z+1+i.}
% \end{align*}
% 得 $f(z)=ze^z+(1+i)z+C$.
% \begin{exercise}
% 	证明 $u(x,y)=x^3-6x^2y-3xy^2+2y^3$ 是调和函数并求它的共轭调和函数.
% \end{exercise}

% \begin{answer}
% 	$v(x,y)=2x^3+3x^2y-6xy^2-y^3+C$.
% \end{answer}
% 显然 $u+iv=(1+2i)z^3+iC$.

% \chapter{级数}
% \section{复数项级数}

% \subsection{复数项级数}

% 复数域上的级数与实数域上的级数并无本质差别.

% \begin{definition}
% 	\begin{itemize}
% 		\item 设 $\{z_n\}_{n\ge1}$ 是复数列. 表达式 $\suml_{n=1}^\infty z_n$ 称为复数项\emph{无穷级数}.
% 		\item 称 $s_n:=z_1+z_2+\cdots+z_n$ 为该级数的\emph{部分和}.
% 		\item 如果部分和数列 $\set{s_n}_{n\ge 1}$ 极限存在, 则称 $\suml_{n=1}^\infty z_n$ \emph{收敛}, 并记 $\suml_{n=1}^\infty z_n=\lim\limits_{n\to\infty}s_n$ 为它的\emph{和}. 否则称该级数\emph{发散}.
% 	\end{itemize}
% \end{definition}

% 如果 $\suml_{n=1}^\infty z_n=A$ 收敛, 则 $z_n=s_n-s_{n-1}\to A-A=0$.
% 因此 \emph{$z_n\to0$ 是 $\suml_{n=1}^\infty z_n$ 收敛的必要条件}.

% \begin{theorem}
% 	$\suml_{n=1}^\infty z_n=a+bi$ 当且仅当 $\suml_{n=1}^\infty x_n=a,\suml_{n=1}^\infty y_n=b$.
% \end{theorem}

% \begin{proof}
% 	设部分和
% 	\[\sigma_n=x_1+x_2+\cdots+x_n,\quad
% 		\tau_n=y_1+y_2+\cdots+y_n.\]
% 	{则
% 		\[s_n=z_1+z_2+\cdots+z_n=\sigma_n+i\tau_n.\]由复数列的敛散性判定条件可知
% 		\[\lim_{n\to\infty}s_n=a+bi\iff	\lim_{n\to\infty}\sigma_n=a,\quad \lim_{n\to\infty}\tau_n=b.\]于是命题得证.\qedhere}
% \end{proof}

% \begin{theorem}
% 	如果实数项级数
% 	\[\sum_{n=1}^\infty|z_n|=|z_1|+|z_2|+\cdots\]
% 	收敛, 则 $\suml_{n=1}^\infty z_n$ 也收敛, 且 $\abs{\suml_{n=1}^\infty z_n}\le\suml_{n=1}^\infty |z_n|$.
% \end{theorem}

% \begin{proof}
% 	因为 $|x_n|,|y_n|\le|z_n|$, 由比较判别法可知实数项级数 $\suml_{n=1}^\infty x_n$, $\suml_{n=1}^\infty y_n$ 绝对收敛, 从而收敛.
% 	{故 $\suml_{n=1}^\infty z_n$ 也收敛.}

% 	{由三角不等式可知
% 		$\displaystyle\abs{\sum_{k=1}^n z_k}\le \sum_{k=1}^n|z_k|$.两边同时取极限即得级数的不等式关系
% 		\[\abs{\sum_{n=1}^\infty z_n}=\abs{\lim_{n\to\infty}\sum_{k=1}^n z_k}=
% 		\lim_{n\to\infty}\abs{\sum_{k=1}^n z_k}\le\lim_{n\to\infty}\sum_{k=1}^n|z_k|=\sum_{n=1}^\infty |z_n|,\]其中第二个等式是因为绝对值函数 $|z|$ 连续.\qedhere}
% \end{proof}

% \subsection{绝对收敛和条件收敛}

% \begin{definition}
% 		\begin{enumerate}
% 		\item 如果级数 $\suml_{n=1}^\infty |z_n|$ 收敛, 则称 $\suml_{n=1}^\infty z_n$ \emph{绝对收敛}.
% 		\item 称收敛但不绝对收敛的级数\emph{条件收敛}.
% 	\end{enumerate}
% \end{definition}

% \begin{theorem}
% 	$\suml_{n=1}^\infty z_n$ 绝对收敛当且仅当它的实部和虚部级数都绝对收敛.
% \end{theorem}

% \begin{proof}
% 	必要性由前一定理的证明已经知道,
% 	{充分性由 $|z_n|\le|x_n|+|y_n|$ 可得.\qedhere}
% \end{proof}

% \begin{tikzpicture}[overlay]
% 	\draw[decorate,decoration={brace,amplitude=8},thick,dcolora] (2.56,-4.25)--(2.56,-1.33);
% 	\draw[decorate,decoration={brace,amplitude=8},thick,dcolorb] (4.52,-0.34)--(10.33,-0.34);
% 	\draw (7.57,0.2) node[dcolorb] {实部级数}
% 	(1.9,-3) node[align=center,dcolora] {虚\\部\\级\\数};
% \end{tikzpicture}
% \begin{center}
% 	\begin{tabular}{|c|c|c|c|}
% 		\hline
% 		&~~发散~~&条件收敛&绝对收敛\\\hline
% 		发散&发散&发散&发散\\\hline
% 		条件收敛&发散&\cellcolor{lightg} 条件收敛
% 			&\cellcolor{lightg} 条件收敛\\\hline
% 		绝对收敛&发散&\cellcolor{lightg}条件收敛
% 			&\cellcolor{lightr}绝对收敛\\\hline
% 	\end{tabular}
% \end{center}

% 绝对收敛的复级数各项可以任意重排次序而不改变其绝对收敛性, 且不改变其和.

% 一般的级数重排有限项不改变其敛散性与和, 但如果重排无限项则可能会改变其敛散性与和.

% \begin{thinking}
% 	什么时候 $\abs{\suml_{n=1}^\infty z_n}=\suml_{n=1}^\infty|z_n|$?
% \end{thinking}

% \begin{answer}
% 	当且仅当非零的 $z_n$ 的辐角全都相同时成立.
% \end{answer}

% \begin{example}
% 	级数 $\displaystyle\sum_{n=1}^\infty\frac{1+i^n}n$ 发散、条件收敛、还是绝对收敛?
% \end{example}

% \begin{solution}
% 	由于实部级数
% 	\[\sum_{n=1}^\infty x_n=
% 	1+\frac13+\frac24+\frac15+\frac17+\frac28+\cdots>\sum_{n=1}^\infty\frac1{2n-1}\]
% 	发散, 所以该级数发散.
% \end{solution}

% 它的虚部级数是一个交错级数, 从而是条件收敛的.

% \begin{example}
% 	级数 $\displaystyle\sum_{n=1}^\infty\dfrac{i^n}n$ 发散、条件收敛、还是绝对收敛?
% \end{example}

% \begin{solution}
% 	因为它的实部和虚部级数
% 	\[\sum_{n=1}^\infty x_n=-\half +\frac14+\frac16-\frac18+\cdots\]
% {
% 	\[\sum_{n=1}^\infty y_n=1-\frac13+\frac15-\frac17+\cdots\]
% 	均条件收敛,
% }{所以原级数条件收敛.}
% \end{solution}

% \begin{exercise}
% 	级数 $\displaystyle\sum_{n=1}^\infty\left[\frac{(-1)^n}n+\frac i{2^n}\right]$ 发散、条件收敛、还是绝对收敛?
% \end{exercise}

% \begin{answer}
% 	实部级数条件收敛, 虚部级数绝对收敛, 所以该级数条件收敛.
% \end{answer}

% 由正项级数的判别法可以得到:
% 设
% \begin{enumerate}
% 	\item \emph{达朗贝尔判别法(比值法)}: $\lambda=\displaystyle\lim_{n\to\infty}\abs{\frac{z_{n+1}}{z_n}}$ (假设存在);
% 	\item \emph{柯西判别法(根式法)}: $\lambda=\displaystyle\lim_{n\to\infty}\sqrt[n]{\abs{z_n}}$ (假设存在);
% 	\item \emph{柯西-阿达马判别法}: $\lambda=\displaystyle\ov{\lim_{n\to\infty}}\sqrt[n]{\abs{z_n}}$ (子数列中极限的最大值).
% \end{enumerate}

% \begin{itemize}
% 	\item 当 $\lambda<1$ 时, $\suml_{n=0}^\infty z_n$ 绝对收敛.
% 	\item 当 $\lambda>1$ 时, $\suml_{n=0}^\infty z_n$ 发散.
% 	\item 当 $\lambda=1$ 时, 无法使用该方法判断敛散性.
% \end{itemize}
% 其证明是通过将该级数与相应的等比级数做比较得到的.

% \begin{example}
% 	级数 $\displaystyle\sum_{n=0}^\infty\frac{(8i)^n}{n!}$ 发散、条件收敛、还是绝对收敛?
% \end{example}

% \begin{solution}
% 	因为 $\displaystyle\lim_{n\to\infty}\abs{\frac{z_{n+1}}{z_n}}=\lim_{n\to\infty}\abs{\dfrac{8}{n+1}}=0$, 所以该级数绝对收敛.
% \end{solution}

% 实际上, 它的实部和虚部级数分别为
% \[1-\frac{8^2}{2!}+\frac{8^4}{4!}-\cdots=\cos 8,\quad
% 8-\frac{8^3}{3!}+\frac{8^5}{5!}-\cdots=\sin 8,\]
% 因此
% \[\sum_{n=0}^\infty\frac{(8i)^n}{n!}=\cos 8+i\sin 8=e^{8i}.\]

% \section{幂级数}

% \subsection{幂级数的收敛域}

% 复变函数级数与实变量函数级数也是类似的.

% \begin{definition}
% 	\begin{itemize}
% 		\item 设 $\{f_n(z)\}_{n\ge 1}$ 是一个复变函数列, 其中每一项都在区域 $D$ 上有定义.
% 		表达式 $\suml_{n=1}^\infty f_n(z)$ 称为\emph{复变函数项级数}.
% 		\item 对于 $z_0\in D$, 如果级数 $\suml_{n=1}^\infty f_n(z_0)$ 收敛, 则称 \emph{$\suml_{n=1}^\infty f_n(z)$ 在 $z_0$ 处收敛}, 相应级数的值称为它的\emph{和}.
% 		\item 如果 $\suml_{n=1}^\infty f_n(z)$ 在 $D$ 上处处收敛, 则它的和是一个函数, 称为\emph{和函数}.
% 		\item 称形如 $\suml_{n=0}^\infty c_n(z-a)^n$ 的函数项级数为\emph{幂级数}.
% 	\end{itemize}
% \end{definition}

% 我们只需要考虑 $a=0$ 情形的幂级数, 因为二者的收敛范围与和函数只是差一个平移.

% \begin{block}{阿贝尔定理}
% 	\begin{enumerate}
% 		\item 如果 $\suml_{n=0}^\infty c_nz^n$ 在 $z_0\neq 0$ 处收敛, 那么对任意 $|z|<|z_0|$ 的 $z$, 该级数必绝对收敛.
% 		\item 如果 $\suml_{n=0}^\infty c_nz^n$ 在 $z_0\neq 0$ 处发散, 那么对任意 $|z|>|z_0|$ 的 $z$, 该级数必发散.
% 	\end{enumerate}
% \end{block}

% \begin{proof}
% 	{\enumnum1 因为级数收敛, 所以 $\lim\limits_{n\to\infty}c_n z_0^n=0$.故存在 $M$ 使得 $|c_nz_0^n|<M$.对于 $|z|<|z_0|$,
% 		\[\sum_{n=0}^\infty|c_nz^n|=\sum_{n=0}^\infty|c_nz_0^n|\cdot\abs{\frac z{z_0}}^n
% 		{\le M\sum_{n=0}^\infty\abs{\frac z{z_0}}^n
% 		=\frac{M}{1-\abs{\dfrac z{z_0}}}.}\]所以级数在 $z$ 处绝对收敛.\enumnum2是\enumnum1的逆否命题.\qedhere}
% \end{proof}

% 设 $R$ 是实幂级数 $\suml_{n=0}^\infty|c_n|x^n$ 的收敛半径.
% \begin{itemize}
% 	\item 如果 $R=+\infty$, 由阿贝尔定理可知 $\suml_{n=0}^\infty c_nz^n$ 处处绝对收敛.
% 	\item 如果 $0<R<+\infty$, 那么 $\suml_{n=0}^\infty c_nz^n$ 在 $|z|<R$ 上绝对收敛, 在 $|z|>R$ 上发散.
% 	\item 如果 $R=0$, 那么 $\suml_{n=0}^\infty c_nz^n$ 仅在 $z=0$ 处收敛, 对任意 $z\neq 0$ 都发散.
% \end{itemize}
% 我们称 $R$ 为该幂级数的\emph{收敛半径}.

% \begin{center}
% 	\begin{tikzpicture}
% 		\filldraw[cstcurve,dcolora,cstfill] (0,0) circle (1.2);
% 		\fill[cstdot] (0,0) circle;
% 		\draw[cstcurve,cstarrowto] (0,0)--(0.96,0.72);
% 		\draw[cstcurve,cstarrowto] (-0.96,0.72)--(-2,0.72);
% 		\draw
% 			(0.6,0.1) node {$R$}
% 			(0,-0.4) node[dcolorb] {绝对收敛}
% 			(2.5,-0.4) node[dcolorb] {发散}
% 			(-3,0.72) node[dcolora] {都有可能};
% 	\end{tikzpicture}
% \end{center}

% \begin{example}
% 	求幂级数 $\suml_{n=0}^\infty z^n=1+z+z^2+\cdots$ 的收敛半径与和函数.
% \end{example}

% \begin{solution}
% 	如果幂级数收敛, 则由 $z^n\to0$ 可知 $|z|<1$.
% 	{当 $|z|<1$ 时, 和函数为
% 		\[\lim_{n\to\infty}s_n=\lim_{n\to\infty}\frac{1-z^{n+1}}{1-z}=\frac1{1-z}.\]因此收敛半径为 $1$.}
% \end{solution}

% \subsection{收敛半径的计算}

% 由正项级数的相应判别法容易得到公式 $R=\dfrac1r$, 其中
% \begin{enumerate}
% 	\item \emph{达朗贝尔公式(比值法)}: $r=\displaystyle\lim_{n\to\infty}\abs{\frac{c_{n+1}}{c_n}}$ (假设存在);
% 	\item \emph{柯西公式(根式法)}: $r=\displaystyle\lim_{n\to\infty}\sqrt[n]{|c_n|}$ (假设存在);
% 	\item \emph{柯西-阿达马公式}: $r=\displaystyle\ov{\lim_{n\to\infty}} \sqrt[n]{|c_n|}$.
% \end{enumerate}
% 如果 $r=0$ 或 $+\infty$, 则 $R=+\infty$ 或 $0$.

% \begin{example}
% 	求幂级数 $\displaystyle\sum_{n=1}^\infty\frac{(z-1)^n}n$ 的收敛半径, 并讨论 $z=0,2$ 的情形.
% \end{example}

% \begin{solution}
% 	由 $\displaystyle\lim_{n\to\infty}\abs{\frac{c_{n+1}}{c_n}}=\lim_{n\to\infty}\frac n{n+1}=1$ 可知收敛半径为 $1$.

% 	{当 $z=2$ 时, $\displaystyle\sum_{n=1}^\infty\frac{(z-1)^n}n=\sum_{n=1}^\infty\frac1n$ 发散.}

% 	{当 $z=0$ 时, $\displaystyle\sum_{n=1}^\infty\frac{(z-1)^n}n=\sum_{n=1}^\infty\frac{(-1)^n}n$ 收敛.}
% \end{solution}

% 事实上, \emph{收敛圆周上既可能处处收敛, 也可能处处发散, 也可能既有收敛的点也有发散的点}.

% \begin{example}
% 	求幂级数 $\suml_{n=0}^\infty\cos(in)z^n$ 的收敛半径.
% \end{example}

% \begin{solution}
% 	我们有 $c_n=\cos(in)=\dfrac{e^n+e^{-n}}2$.
% 	{由
% 		\[\lim_{n\to\infty}\abs{\frac{c_{n+1}}{c_n}}=\lim_{n\to\infty}\frac{e^{n+1}+e^{-n-1}}{e^n+e^{-n}}=e\lim_{n\to\infty}\frac{1+e^{-2n-2}}{1+e^{-2n}}=e\]
% 	可知收敛半径为 $\dfrac1e$.}
% \end{solution}

% \begin{exercise}
% 	幂级数 $\suml_{n=0}^\infty(1+i)^nz^n$ 的收敛半径为\fillblank[2cm][2mm]{{$\dfrac{\sqrt2}2$}}.
% \end{exercise}

% % 
% % 
% % \begin{example}
% % 求幂级数 $\displaystyle\sum_{n=1}^\infty\frac{z^n}{n^p}$ 的收敛半径并讨论在收敛圆周上的情形, 其中 $p\in\BR$.
% % \end{example}
% % 
% % \begin{solution}
% % 由 $\displaystyle\lim_{n\to\infty}\abs{\frac{c_{n+1}}{c_n}}=\lim_{n\to\infty}\left(\frac n{n+1}\right)^p=1$ 可知收敛半径为 $1$.
% % {设 $|z|=1$.
% % \begin{itemize}
% % \item 若 $p>1$, $\displaystyle\sum_{n=1}^\infty\abs{\frac{z^n}{n^p}}=\sum_{n=1}^\infty\frac1{n^p}$ 收敛,
% % {原级数在收敛圆周上处处绝对收敛.}
% % \item 若 $p\le 0$, $\abs{\dfrac{z^n}{n^p}}=\dfrac1{n^p}\not\to0$,
% % {原级数在收敛圆周上处处发散.}
% % \end{itemize}}
% % \end{solution}
% % \end{frame}

% % 
% % 
% % 回忆\emph{狄利克雷判别法}: 若 $\set{a_n}_{n\ge 1}$ 部分和有界, 实数项数列 $\set{b_n}_{n\ge 1}$ 单调趋于 $0$, 则 $\suml_{n=1}^\infty a_nb_n$ 收敛.

% % 
% % \begin{solutionc}
% % \begin{itemize}
% % \item 若 $0<p\le1$, $\displaystyle\sum_{n=1}^\infty\frac1{n^p}$ 发散, 
% % {而在收敛圆周上其它点 $z\neq1$ 处,
% % \[|z+z^2+\cdots+z^n|=\abs{\frac{z(1-z^n)}{1-z}}
% % \le\frac{2}{|1-z|}\]
% % 有界, 数列 $\set{n^{-p}}_{n\ge 1}$ 单调趋于 $0$,}
% % {因此 $\displaystyle\sum_{n=1}^\infty\frac{z^n}{n^p}$ 收敛.}
% % {故该级数在 $z=1$ 发散, 在收敛圆周上其它点收敛.}
% % \end{itemize}
% % \end{solutionc}
% % \end{frame}

% \subsection{幂级数的运算性质}

% \begin{theorem}
% 	设幂级数
% 	\[f(z)=\sum_{n=0}^\infty a_nz^n,|z|<R_1,\quad
% 	g(z)=\sum_{n=0}^\infty b_nz^n,|z|<R_2.\]
% 	{那么当 $|z|<R=\min\{R_1,R_2\}$ 时,
% 	\[(f\pm g)(z)=\sum_{n=0}^\infty (a_n\pm b_n)z^n,\quad
% 	(fg)(z)=\sum_{n=0}^\infty\left(\sum_{k=0}^na_kb_{n-k}\right)z^n.\]}
% \end{theorem}

% 当 $f,g$ 的收敛半径相同时, $f\pm g$ 或 $fg$ 的收敛半径可以比 $f,g$ 的大.

% \begin{theorem}
% 	设幂级数
% 	\[f(z)=\sum_{n=0}^\infty a_nz^n,|z|<R,\]
% 	设函数 $\varphi(z)$ 在 $|z|<r$ 上解析且 $|\varphi(z)|<R$, 
% 	{那么当 $|z|<r$ 时,
% 	\[f[\varphi(z)]=\sum_{n=0}^\infty a_n[\varphi(z)]^n.\]}
% \end{theorem}

% \begin{theorem}
% 	设幂级数 $\suml_{n=0}^\infty c_nz^n$ 的收敛半径为 $R$, 则在 $|z|<R$ 上:
% 	\begin{enumerate}
% 		\item 它的和函数 $f(z)=\suml_{n=0}^\infty c_nz^n$ 解析,
% 		\item $f'(z)=\suml_{n=1}^\infty nc_nz^{n-1}$,
% 		\item $\displaystyle\int_0^zf(z)\diff z=\sum_{n=0}^\infty \frac{c_n}{n+1}z^{n+1}$.
% 	\end{enumerate}
% \end{theorem}

% 也就是说, \emph{在收敛圆内, 幂级数的和函数解析, 且可以逐项求导, 逐项积分}.

% 由于和函数在 $|z|>R$ 上没有定义, 因此我们不能谈和函数在 $|z|=R$ 上的解析性.

% 如果函数 $g(z)$ 在该幂级数收敛的点处和 $f(z)$ 均相同, 则 $g(z)$ \emph{一定在收敛圆周上有奇点}.
% 这是因为一旦 $g(z)$ 在收敛圆周上处处解析, 该和函数就可以在一个半径更大的圆域上作泰勒展开.

% \begin{example}
% 	把函数 $\dfrac1{z-b}$ 表成形如 $\suml_{n=0}^\infty c_n(z-a)^n$ 的幂级数, 其中 $a\neq b$.
% \end{example}

% \begin{solution}
% 	\[\frac1{z-b}=\frac1{(z-a)-(b-a)}
% 	{=\frac1{a-b}\cdot\frac1{1-\dfrac{z-a}{b-a}}.}\]
% 	{当 $|z-a|<|b-a|$ 时,$\displaystyle\frac1{z-b}=\frac1{a-b}\sum_{n=0}^\infty\left(\frac{z-a}{b-a}\right)^n$,即
% 	\[\frac1{z-b}=-\sum_{n=0}^\infty\frac{(z-a)^n}{(b-a)^{n+1}},\quad|z-a|<|b-a|.\]}
% \end{solution}

% \begin{example}
% 	求幂级数 $\suml_{n=1}^\infty(2^n-1)z^{n-1}$ 的收敛半径与和函数.
% \end{example}

% \begin{solution}
% 	由 $\displaystyle\lim_{n\to\infty}\abs{\frac{c_{n+1}}{c_n}}=\lim_{n\to\infty}\frac{2^{n+1}-1}{2^n-1}=2$ 可知收敛半径为 $\dfrac12$.
% 	{当 $|z|<\dfrac12$ 时, $|2z|<1$.}
% 	{从而
% 	\begin{align*}
% 	\sum_{n=1}^\infty(2^n-1)z^{n-1}&=\sum_{n=1}^\infty 2^n z^{n-1}-\sum_{n=1}^\infty z^{n-1}\\
% 	&{=\frac2{1-2z}-\frac1{1-z}=\frac1{(1-2z)(1-z)}.}
% 	\end{align*}}
% \end{solution}

% \begin{example}
% 	求幂级数 $\suml_{n=0}^\infty(n+1)z^n$ 的收敛半径与和函数.
% \end{example}

% \begin{solution}
% 	由 $\displaystyle\lim_{n\to\infty}\abs{\frac{c_{n+1}}{c_n}}=\lim_{n\to\infty}\frac{n+1}n=1$ 可知收敛半径为 $1$.
% {当 $|z|<1$ 时,
% 	\[\int_0^z\sum_{n=0}^\infty(n+1)z^n\diff z=\sum_{n=0}^\infty z^{n+1}=\frac z{1-z}=-1-\frac1{z-1},\]
% }{因此
% 	\[\sum_{n=0}^\infty(n+1)z^n=\left(-\frac1{z-1}\right)'=\frac1{(z-1)^2},\quad |z|<1.\]}
% \end{solution}

% 通过对
% \[1+\lambda z+\lambda^2 z^2+\cdots=\dfrac1{1-\lambda z}\]
% 两边求 $k$ 阶导数可得
% \[\sum_{n=0}^{\infty}(n+k)\cdots(n+2)(n+1)\lambda^n z^n=\frac{k!}{(1-\lambda z)^{k+1}}.\]
% 因此如果 $p(n)$ 是次数为 $m-1$ 的多项式, 那么
% \[\sum_{n=0}^\infty p(n)\lambda^n z^n=\frac{P(z)}{(1-\lambda z)^{m}},\]
% 其中 $P$ 是多项式.

% 一般地, 如果幂级数的系数形如
% \[c_n=p_1(n)\lambda_1^n+\cdots+p_k(n)\lambda_k^n,\]
% 则和函数一定是形如
% \[\sum_{n=0}^{\infty}c_nz^n
% =\frac{P(z)}{(1-\lambda_1z)^{m_1}\cdots(1-\lambda_kz)^{m_k}}\]
% 的有理函数,	其中 $m_j=\deg p_j+1$.
% 反过来这样的分式展开成幂级数的系数也一定有上述形式, 至多有有限多项例外.
% 这可以帮助我们进行计算的验证.
% \begin{exercise}
% 	求幂级数 $\suml_{n=1}^\infty\dfrac{z^n}n$ 的收敛半径与和函数.
% \end{exercise}

% \begin{answer}
% 	收敛半径为 $1$, 和函数为 $-\ln(1-z)$.
% \end{answer}

% \begin{example}
% 	求 $\displaystyle\oint_{|z|=\half }\left(\sum_{n=-1}^\infty z^n\right)\diff z$.
% \end{example}

% \begin{solution}
% 	由于 $\suml_{n=0}^\infty z^n$ 在 $|z|<1$ 收敛,
% {它的和函数解析.
% }{因此
% 	\begin{align*}
% 	\oint_{|z|=\half }\left(\sum_{n=-1}^\infty z^n\right)\diff z
% 	&=\oint_{|z|=\half }\frac1z\diff z+\oint_{|z|=\half }\left(\sum_{n=0}^\infty z^n\right)\diff z\\
% 	&{=2\pi i+0=2\pi i.}
% \end{align*}}
% \end{solution}

% \section{泰勒级数}

% \subsection{泰勒展开的形式与性质}

% 我们知道, 幂级数在它的收敛域内的和函数是一个解析函数.
% 反过来, 解析函数是不是也一定可以在一点展开成幂级数呢? 也就是说是否存在\emph{泰勒级数}展开?

% 在实变函数中我们知道, 一个函数即使在一点附近无限次可导, 它的泰勒级数也未必收敛到原函数.
% 例如
% \[f(x)=\begin{cases}
% e^{-x^{-2}},&x\neq 0,\\
% 0,&x=0.\end{cases}\]
% 它处处可导, 但是它在 $0$ 处的各阶导数都是 $0$.
% 因此它的泰勒级数是 $0$, 余项恒为 $f(x)$.
% 除 $0$ 外它的泰勒级数均不收敛到原函数.

% 而即使是泰勒级数能收敛到原函数的情形, 它成立的范围也很难从函数本身读出.
% 例如
% \[\dfrac1{1+x}=1-x+x^2-x^3+\cdots,\quad|x|<1.\]
% 这可以从 $x=-1$ 是奇点看出.
% 而
% \[\dfrac1{1+x^2}=1-x^2+x^4-x^6+\cdots,\quad|x|<1\]
% 却并没有奇点.
% 为什么它的麦克劳林级数成立的开区间也是 $(-1,1)$?
% 这个问题在本节可以得到回答.

% 设函数 $f(z)$ 在区域 $D$ 解析, $z_0\in D$.
% 设 $|z-z_0|$ 小于 $z_0$ 到 $D$ 边界的距离 $d$,
% 则存在 $|z-z_0|<r<d$.
% 设 $K:|\zeta-z_0|=r$, 则 $K$ 和它的内部包含在 $D$ 中.
% 由于 $\abs{\dfrac{z-z_0}{\zeta-z_0}}<1$, 因此
% \[\frac1{\zeta-z}=\frac1{\zeta-z_0}\cdot\frac1{1-\dfrac{z-z_0}{\zeta-z_0}}=\sum_{n=0}^\infty\frac{(z-z_0)^n}{(\zeta-z_0)^{n+1}}.\]


% \begin{center}
% 	\begin{tikzpicture}
% 		\filldraw[cstcurve,dcolora,smooth,cstfill] plot coordinates {(-2.25,0) (-1.5,-0.75) (0,-1.5) (1.05,-1.5) (1.35,0) (0,1.2) (-1.5,1.2) (-2.25,0)};
% 		\draw[cstdash,dcolorc] (0,0) circle (1);
% 		\draw[cstcurve,dcolorb] (0,0) circle (0.8);
% 		\fill[cstdot,dcolora] (0,0) circle;
% 		\fill[cstdot,dcolorc] (0.4,0.4) circle;
% 		\fill[cstdot] (0.6,-0.5) circle;
% 		\draw[cstcurve,cstarrowto,dcolora] (0,0)--(-0.48,-0.64);
% 		\draw
% 			(-0.25,0) node[dcolora] {$z_0$}
% 			(0.2,0.4) node[dcolorc] {$z$}
% 			(0,-0.5) node[dcolora] {$r$}
% 			(0.4,-0.3) node {$\zeta$};
% 	\end{tikzpicture}
% \end{center}

% 故
% \begin{align*}
% 	f(z)&=\frac1{2\pi i}\oint_K \frac{f(\zeta)}{\zeta-z}\diff\zeta
% 	{=\frac1{2\pi i}\oint_K f(\zeta)\sum_{n=0}^\infty\frac{(z-z_0)^n}{(\zeta-z_0)^{n+1}}\diff\zeta}\\
% 	&{=
% 	\sum_{n=0}^{N-1}\left[\frac1{2\pi i}\oint_K\frac{f(\zeta)\diff\zeta}{(\zeta-z_0)^{n+1}}\right](z-z_0)^n+R_N(z),}\\
% 	&{=
% 	\sum_{n=0}^{N-1}\frac{f^{(n)}(z_0)}{n!}(z-z_0)^n+R_N(z),}
% \end{align*}
% 其中
% \begin{align*}
% 	R_N(z)&=\frac1{2\pi i}\oint_Kf(\zeta)\left[\sum_{n=N}^\infty\frac{(z-z_0)^n}{(\zeta-z_0)^{n+1}}\right]\diff\zeta\\
% 	&=\frac1{2\pi i}\oint_K\frac{f(\zeta)}{\zeta-z}\cdot\left(\frac{z-z_0}{\zeta-z_0}\right)^N\diff\zeta.
% \end{align*}

% 由于 $f(\zeta)$ 在 $D\supseteq K$ 上解析, 从而在 $K$ 上连续且有界.
% 设 $|f(\zeta)|\le M,\zeta\in K$,
% 那么
% \begin{align*}
% 	|R_N(z)|&\le\frac 1{2\pi}\oint_K\abs{\frac{f(\zeta)}{\zeta-z}\cdot\left(\frac{z-z_0}{\zeta-z_0}\right)^N}\diff s\\
% 	&{\le\frac 1{2\pi}\cdot \frac M{r-|z-z_0|}\cdot\abs{\frac{z-z_0}{\zeta-z_0}}^N\cdot 2\pi r\to 0\quad (N\to\infty).}
% \end{align*}
% 故
% \[f(z)=\sum_{n=0}^\infty\frac{f^{(n)}(z_0)}{n!}(z-z_0)^n,\quad |z-z_0|<d.\]

% 由于幂级数在收敛半径内的和函数是解析的, 因此解析函数的泰勒展开成立的圆域不包含奇点.
% 由此可知, 解析函数在 $z_0$ 处\emph{泰勒展开成立的圆域的最大半径是 $z_0$ 到最近奇点的距离}.

% 需要注意的是, 泰勒级数的收敛半径是有可能比这个半径更大的,
% 而且泰勒展开等式也可能在这个圆域之外的点成立.
% 例如 
% \[f(z)=\begin{cases}
% 	e^z,&z\neq 1;\\
% 	0,&z=1
% \end{cases}\]
% 的麦克劳林展开为 $f(z)=\suml_{n=0}^\infty \dfrac{z^n}{n!},\quad |z|<1$.

% 现在我们来看 $f(z)=\dfrac1{1+z^2}$.
% 它的奇点为 $\pm i$, 所以它的麦克劳林展开成立的半径是 $1$.
% 这就解释了为什么函数 $f(x)=\dfrac1{1+x^2}$ 的麦克劳林展开成立的开区间是 $(-1,1)$.

% \subsection{泰勒展开的计算方法}

% 若 $f(z)$ 在 $z_0$ 附近展开为 $\suml_{n=0}^\infty c_n(z-z_0)^n$,
% 则由幂级数的逐项求导性质可知
% \[f^{(n)}(z_0)=\sum_{k=n}^\infty c_k k(k-1)\cdots(k-n+1)(z-z_0)^{k-n}\Big|_{z=z_0}=n!c_n.\]
% 所以\emph{解析函数的幂级数展开是唯一的}.

% 因此解析函数的泰勒展开不仅可以\emph{直接求出各阶导数得到}, 也可以\emph{利用幂级数的运算法则得到}.

% \begin{example}
% 	由于 $(e^z)^{(n)}(0)=e^z|_{z=0}=1$, 因此
% 	\[e^z=1+z+\frac{z^2}{2!}+\frac{z^3}{3!}+\cdots=\sum_{n=0}^\infty\frac{z^n}{n!},\quad\forall z.\]
% \end{example}

% \begin{example}
% 	由于 $\displaystyle(\cos z)^{(n)}=\cos\left(z+\dfrac{n\pi}2\right)$,
% 		\[(\cos z)^{(2n+1)}(0)=0,\quad (\cos z)^{(2n)}(0)=(-1)^n,\]
% 	因此
% 		\[\cos z=1-\frac{z^2}{2!}+\frac{z^4}{4!}-\frac{z^6}{6!}+\cdots=\sum_{n=0}^\infty(-1)^n\frac{z^{2n}}{(2n)!},\quad\forall z.\]
% \end{example}

% \begin{example}
% 	由 $e^z$ 的泰勒展开可得
% 	\begin{align*}
% 		\sin z&=\frac{e^{iz}-e^{-iz}}{2i}
% 		{=\sum_{n=0}^\infty\frac{(iz)^n-(-iz)^n}{2i\cdot n!}}\\
% 		&=z-\frac{z^3}{3!}+\frac{z^5}{5!}-\cdots
% 		=\sum_{n=0}^\infty(-1)^n\frac{z^{2n+1}}{(2n+1)!},\quad\forall z.
% 	\end{align*}
% 		这里, 因为 $\sin z$ 是奇函数, 所以它的麦克劳林展开只有奇数幂次项, 没有偶数幂次项.
% \end{example}

% \begin{example}
% 求对数函数的主值 $\ln(1+z)$ 的麦克劳林展开.
% \end{example}
% \begin{solution}
% 由于 $\ln(1+z)$ 在去掉射线 $z=x\le-1$ 的区域内解析,
% {因此它在 $|z|<1$ 内解析,
% }{且
% 	\[[\ln(1+z)]'=\frac1{1+z}=\sum_{n=0}^\infty(-1)^nz^n,\quad|z|<1.\]
% }{逐项积分得到
% \begin{align*}
% \ln(1+z)&=\int_0^z\frac1{1+\zeta}\diff\zeta
% 	{=\int_0^z\sum_{n=0}^\infty(-1)^n\zeta^n\diff\zeta}\\
% &{=\sum_{n=0}^\infty\frac{(-1)^nz^{n+1}}{n+1}}
% 	{=\sum_{n=1}^\infty\frac{(-1)^{n+1}z^n}{n},\quad|z|<1.}
% \end{align*}}
% \end{solution}

% \begin{example}
% 	函数 $f(z)=(1+z)^\alpha$ 的主值为 $\exp\bigl[\alpha\ln(1+z)\bigr]$. 它在去掉射线 $z=x\le -1$ 的区域内解析. 由于
% 	\begin{align*}
% 		f^{(n)}(0)&=\alpha(\alpha-1)\cdots(\alpha-n+1)\exp\bigl[(\alpha-n)\ln(1+z)\bigr]\Big|_{z=0}\\
% 		&=\alpha(\alpha-1)\cdots(\alpha-n+1).
% 	\end{align*}
% 	因此
% 	\begin{align*}
% 		(1+z)^\alpha&=1+\alpha z+\frac{\alpha(\alpha-1)}2z^2+\frac{\alpha(\alpha-1)(\alpha-2)}{3!}z^3+\cdots\\
% 		&=\sum_{n=0}^\infty\frac{\alpha(\alpha-1)\cdots(\alpha-n+1)}{n!}z^n,\quad |z|<1.
% 	\end{align*}
% \end{example}

% 当 $\alpha=n$ 是正整数时, 上述麦克劳林展开的 $>n$ 幂次项系数为零, 
% 从而
% 	\[(1+z)^n=\sum_{k=0}^n \mathrm{C}_n^k z^k,\]
% 此即牛顿二项式展开.

% \begin{example}
% 	将 $\dfrac1{(1+z)^2}$ 展开成 $z$ 的幂级数.
% \end{example}

% \begin{solution}
% 	由幂函数展开可知当 $|z|<1$ 时,
% 	\[(1+z)^{-2}=\sum_{n=0}^\infty \frac{(-2)(-3)\cdots(-1-n)}{n!}z^n
% 	{=\sum_{n=0}^\infty (-1)^n(n+1)z^n.}\]
% \end{solution}

% \begin{proofblock}{另解}
% 	由于 $\dfrac1{(1+z)^2}$ 的奇点为 $z=-1$, 因此它在 $|z|<1$ 内解析.
% 	{由于
% 		\[\frac1{1+z}=1-z+z^2-z^3+\cdots=\sum_{n=0}^\infty (-1)^nz^n,\]因此
% 		\[
% 		\frac1{(1+z)^2}=-\left(\frac1{1+z}\right)'
% 		{=-\sum_{n=1}^\infty(-1)^n nz^{n-1}}
% 		{=\sum_{n=0}^\infty(-1)^n (n+1)z^n,\quad |z|<1.}
% 		\]
% 	}
% \end{proofblock}
% 一般地, 我们有
% \[\frac1{(1-\lambda z)^k}=\sum_{n=0}^\infty(n+k-1)\cdots(n+2)(n+1)z^n,\ |z|<\frac1{|\lambda|}.\]

% \begin{example}
% 	求 $\dfrac1{3z-2}$ 的麦克劳林展开.
% \end{example}

% \begin{solution}
% 	由于 $\dfrac1{3z-2}$ 的奇点为 $z=\dfrac23$, 因此它在 $|z|<\dfrac23$ 内解析.
% 	{此时
% 	\begin{align*}
% 		\frac1{3z-2}&=-\half\cdot\frac1{1-\dfrac{3z}2}
% 			{=-\half\sum_{n=0}^\infty\left(\frac{3z}2\right)^n}\\
% 		&{=-\sum_{n=0}^\infty\frac{3^n}{2^{n+1}}z^n,\quad|z|<\frac23.}
% 	\end{align*}}
% \end{solution}

% \begin{exercise}
% 	求 $\dfrac1{1-3z+2z^2}$ 的麦克劳林展开.
% \end{exercise}

% \begin{answer}
% \[
% 	\frac1{1-3z+2z^2}=\frac{2}{1-2z}-\frac1{1-z}
% 	=\sum_{n=0}^\infty(2^{n+1}-1)z^n,\quad |z|<\half .
% \]
% \end{answer}

% 有理函数展开为真分式形式若用待定系数法总略显繁琐, 我们现介绍一种方法.
% 设
% \[f(z)=\dfrac{1}{(z-1)(z-2)(z+2)}=\frac{a}{z-1}+\frac{b}{z-2}+\frac{c}{z+2},\]
% \[a=\frac1{2\pi i} \oint_{|z-1|=0.1}f(z)\diff z=\dfrac{1}{(z-2)(z+2)}\Big|_{z=1}=-\frac13.\]
% 类似可得 $b=\dfrac14,c=\dfrac1{12}$.

% 对于分母有重根的情形, 例如
% \[f(z)=\dfrac{1}{(z-1)^2(z-2)^3}=\frac{a}{z-1}+\frac{b}{(z-1)^2}+\frac{c}{z-2}+\frac{d}{(z-2)^2}+\frac{e}{(z-2)^3},\]
% \[a=\frac1{2\pi i} \oint_{|z-1|=0.1}f(z)\diff z=\left(\dfrac{1}{(z-2)^3}\right)'\Big|_{z=1}=-3,\]
% \[b=\frac1{2\pi i} \oint_{|z-1|=0.1}(z-1)f(z)\diff z=\dfrac{1}{(z-2)^3}\Big|_{z=1}=-1.\]
% 类似可得 $c=3,d=-2,e=1$, 只是我们需要计算高阶导数.
% 因此
% \[f(z)=\sum_{n=0}^\infty\left(3-(n+1)+\frac{-\frac32-\frac12(n+1)-\frac18(n+2)(n+1)}{2^n}\right)z^n,\quad |z|<1.\]

% \section{洛朗级数}

% \subsection{双边幂级数}

% 如果解析函数 $f(z)$ 在 $z_0$ 处解析, 那么在 $z_0$ 处可以展开成泰勒级数.
% 如果 $f(z)$ 在 $z_0$ 处不解析呢?
% 此时 $f(z)$ 一定不能展开成 $z-z_0$ 的幂级数,
% 然而它却可能可以展开为\emph{双边幂级数}
% 	\[\sum_{n=-\infty}^\infty c_n(z-z_0)^n
% 		=\underbrace{\sum_{n=1}^\infty c_{-n}(z-z_0)^{-n}}_{\text{\normalsize 负幂次部分}}
% 		+\underbrace{\sum_{n=0}^\infty c_n(z-z_0)^n}_{\text{\normalsize 非负幂次部分}}.\]
% 例如
% 	\[\frac1{z^2(1-z)}=\frac1{z^2}+\frac1z+1+z+z^2+\cdots,\quad 0<|z|<1.\]

% 为了保证双边幂级数的收敛范围有一个好的性质以便于我们使用, 我们对它的敛散性作如下定义:
% \begin{definition}
% 	如果双边幂级数的非负幂次部分和负幂次部分作为函数项级数都收敛, 则我们称这个双边幂级数\emph{收敛}. 否则我们称之为\emph{发散}.
% \end{definition}

% 注意双边幂级数的敛散性不能像幂级数那样通过部分和形成的数列的极限来定义,
% 因为使用不同的部分和选取方式会影响到极限的数值.

% 设 $\suml_{n=0}^\infty c_n(z-z_0)^n$ 的收敛半径为 $R_2$, 则它在 $|z-z_0|<R_2$ 内收敛, 在 $|z-z_0|>R_2$ 内发散.

% 对于负幂次部分, 令 $\zeta=\frac1{z-z_0}$, 那么负幂次部分是 $\zeta$ 的一个幂级数 $\suml_{n=1}^\infty c_{-n}\zeta^n$.
% 设该幂级数的收敛半径为 $R$, 则它在 $|\zeta|<R$ 内收敛, 在 $|\zeta|>R$ 内发散.
% 设 $R_1:=\frac1R$, 则 $\suml_{n=1}^\infty c_{-n}(z-z_0)^{-n}$ 在 $|z-z_0|>R_1$ 内收敛, 在 $|z-z_0|<R_1$ 内发散.

% \begin{enumerate}
% 	\item 如果 $R_1>R_2$, 则该双边幂级数处处不收敛.
% 	\item 如果 $R_1=R_2$, 则该双边幂级数只在圆周 $|z-z_0|=R_1$ 上可能有收敛的点.
% 		此时没有收敛域.
% 	\item 如果 $R_1<R_2$, 则该双边幂级数在 $R_1<|z-z_0|<R_2$ 内收敛, 在 $|z-z_0|<R_1$ 或 $>R_2$ 内发散, 在圆周 $|z-z_0|=R_1$ 或 $R_2$ 上既可能发散也可能收敛.
% \end{enumerate}

% 因此\emph{双边幂级数的收敛域为圆环域 $R_1<|z-z_0|<R_2$}.

% 当 $R_1=0$ 或 $R_2=+\infty$ 时, 圆环域的形状会有所不同.
% \begin{center}
% 	\begin{tikzpicture}
% 		\filldraw[cstcurve,draw=dcolora,cstfill] (0,0) circle (1.5);
% 		\filldraw[cstdote,draw=dcolora] (0,0) circle;
% 		\draw[dcolorb,cstarrowto,thick] (0.048,0.036)--(1.2,0.9);
% 		\draw
% 			(0.7,0.2) node[dcolorb] {$R_2$}
% 			(-0.3,0) node[dcolora] {$z_0$}
% 			(0,-2) node {$0<|z-z_0|<R_2$};

% 		\fill[cstfille] (2.5,-1.5) rectangle (5.5,1.5);
% 		\filldraw[cstcurve,fill=white,draw=dcolora] (4,0) circle (1); 
% 		\fill[cstdot,dcolorb] (4,0) circle;
% 		\draw[dcolorb,cstarrowto,thick] (4,0)--(4.6,-0.8);
% 		\draw
% 			(4.1,-0.6) node[dcolorb] {$R_1$}
% 			(3.7,0) node[dcolora] {$z_0$}
% 			(4,-2) node {$R_1<|z-z_0|<+\infty$};

% 		\fill[cstfille] (6.5,-1.5) rectangle (9.5,1.5);
% 		\filldraw[cstdote,draw=dcolora] (8,0) circle;
% 		\draw
% 			(7.7,0) node[dcolora] {$z_0$}
% 			(8,-2) node {$0<|z-z_0|<+\infty$};
% 	\end{tikzpicture}
% \end{center}

% 双边幂级数的非负幂次部分和负幂次部分在收敛圆环域内都收敛,
% 因此它们的和函数都解析($\zeta=\dfrac1{z-z_0}$ 关于 $z$ 解析), 且可以逐项求导、逐项积分.
% 从而\emph{双边幂级数的和函数也是解析的, 且可以逐项求导、逐项积分}.

% \begin{example}
% 	求双边幂级数 $\displaystyle\sum_{n=1}^\infty\frac{2^n}{z^n}+\sum_{n=0}^\infty\frac{z^n}{(2+i)^n}$ 的收敛域与和函数.
% \end{example}

% \begin{solution}
% 	非负幂次部分收敛域为 $|z|<|2+i|=\sqrt5$, 负幂次部分收敛域为 $|z|>|2|=2$.
% 	{因此该双边幂级数的收敛域为 $2<|z|<\sqrt5$.此时
% 		\[\sum_{n=1}^\infty\frac{2^n}{z^n}+\sum_{n=0}^\infty\frac{z^n}{(2+i)^n}
% 		=\frac{\dfrac 2z}{1-\dfrac 2z}+\frac1{1-\dfrac z{2+i}}
% 		=\frac{-iz}{(z-2)(z-2-i)}.\]}
% \end{solution}

% \subsection{洛朗展开的形式}

% 反过来, 在圆环域内解析的函数也一定能展开为双边幂级数, 被称为\emph{洛朗级数}.

% 例如 $f(z)=\dfrac1{z(1-z)}$ 在 $z=0,1$ 以外解析.
% 在圆环域 $0<|z|<1$ 内,
% \[f(z)=\frac1z+\frac1{1-z}=\frac1z+1+z+z^2+z^3+\cdots\]
% 在圆环域 $1<|z|<+\infty$ 内,
% \[f(z)=\frac1z-\frac1z\cdot\frac1{1-\dfrac1z}=-\frac1{z^2}-\frac1{z^3}-\frac1{z^4}-\cdots\]

% 现在我们来证明洛朗级数的存在性并得到洛朗展开式.
% 设 $f(z)$ 在圆环域 $R_1<|z-z_0|<R_2$ 内解析.
% 设
% 	\[K_1:|z-z_0|=r,\quad K_2:|z-z_0|=R,\quad R_1<r<R<R_2.\]
% 是该圆环域内的两个圆周. 
% 对于 $r<|z-z_0|<R$, 由柯西积分公式,
% \[f(z)=\frac1{2\pi i}
% 	\oint_{K_2}\frac{f(\zeta)}{\zeta-z}\diff\zeta
% 	-\frac1{2\pi i}\oint_{K_1}\frac{f(\zeta)}{\zeta-z}\diff\zeta.\]

% \begin{center}
% 	\begin{tikzpicture}
% 		\filldraw[cstcurve,dcolorb,cstfill] (0,0) circle (1.5);
% 		\filldraw[cstcurve,dcolora,fill=white] (0,0) circle (1);
% 		\fill[cstdot,dcolora] (-1,0) circle;
% 		\fill[cstdot,dcolorb] (-1.48,-0.3) circle;
% 		\fill[cstdot,black] (0,1.25) circle;
% 		\draw[dcolorb,cstarrowto,thick] (0,0)--(1.2,0.9);
% 		\draw[dcolora,cstarrowto,thick] (0,0)--(0.6,-0.8);
% 		\draw
% 			(-1.25,-0.15) node {$\zeta$}
% 			(0.5,0.1) node[dcolorb] {$R$}
% 			(0.1,-0.5) node[dcolora] {$r$}
% 			(-0.3,0) node {$z_0$}
% 			(0.8,-1) node[dcolora] {$K_1$}
% 			(1.4,1.2) node[dcolorb] {$K_2$}
% 			(-0.3,1.25) node {$z$};
% 		\fill[cstdot,black] (0,0) circle;
% 	\end{tikzpicture}
% \end{center}

% 和泰勒级数的推导类似,
% 	\[\frac1{2\pi i}\oint_{K_2}\frac{f(\zeta)}{\zeta-z}\diff\zeta
% 	=\sum_{n=0}^\infty\left[\frac1{2\pi i}\oint_{K_2}\frac{f(\zeta)\diff\zeta}{(\zeta-z_0)^{n+1}}\right](z-z_0)^n\]
% 可以表达为幂级数的形式.
% 对于 $\zeta\in K_1$, 由 $\abs{\dfrac{\zeta-z_0}{z-z_0}}<1$ 可得
% 	\[-\frac1{\zeta-z}=\frac1{z-z_0}\cdot\frac1{1-\dfrac{\zeta-z_0}{z-z_0}}=\sum_{n=1}^\infty\frac{(z-z_0)^{-n}}{(\zeta-z_0)^{-n+1}},\]
% 	\[-\frac1{2\pi i}\oint_{K_1}\frac{f(\zeta)}{\zeta-z}\diff\zeta=\frac1{2\pi i}\oint_{K_1}f(\zeta)\sum_{n=1}^\infty\frac{(z-z_0)^{-n}}{(\zeta-z_0)^{-n+1}}\diff\zeta.\]

% 令
% \begin{align*}
% 	R_N(z)&=\frac1{2\pi i}\oint_{K_1}f(\zeta)\sum_{n=N}^\infty\frac{(z-z_0)^{-n}}{(\zeta-z_0)^{-n+1}}\diff\zeta\\
% 	&=\frac1{2\pi i}\oint_{K_1}\frac{f(\zeta)}{z-\zeta}\cdot\left(\frac{\zeta-z_0}{z-z_0}\right)^{N-1}\diff\zeta.
% \end{align*}
% 由于 $f(\zeta)$ 在 $D\supseteq K_1$ 上解析, 从而在 $K_1$ 上连续且有界.
% 设 $|f(\zeta)|\le M,\zeta\in K_1$,
% 那么
% \begin{align*}
% |R_N(z)|&\le\frac 1{2\pi}\oint_{K_1}\abs{\frac{f(\zeta)}{z-\zeta}\cdot\left(\frac{\zeta-z_0}{z-z_0}\right)^{N-1}}\diff s\\
% &{\le\frac 1{2\pi}\cdot\frac M{|z-z_0|-r}\cdot\abs{\frac{\zeta-z_0}{z-z_0}}^{N-1}\cdot 2\pi r\to 0\quad (N\to\infty).}
% \end{align*}

% 故
% \begin{align*}
% f(z)&=\sum_{n=0}^\infty\left[\frac1{2\pi i}\oint_{K_2}\frac{f(\zeta)\diff\zeta}{(\zeta-z_0)^{n+1}}\right](z-z_0)^n\\
% &\qquad+\sum_{n=1}^\infty \left[\frac1{2\pi i}\oint_{K_1}\frac{f(\zeta)\diff\zeta}{(\zeta-z_0)^{-n+1}}\right](z-z_0)^{-n},
% \end{align*}
% 其中 $r<|z-z_0|<R$.
% 由复合闭路定理, $K_1,K_2$ 可以换成任意一条在圆环域内绕 $z_0$ 的闭路 $C$.
% 从而我们得到 \emph{$f(z)$ 在以 $z_0$ 为圆心的圆环域的洛朗展开}
% 	\[f(z)=\sum_{n=-\infty}^\infty\left[\frac1{2\pi i}\oint_C\frac{f(\zeta)\diff\zeta}{(\zeta-z_0)^{n+1}}\right](z-z_0)^n,\]
% 其中 $R_1<|z-z_0|<R_2$.

% \subsection{洛朗展开的计算方法}

% 我们称 $f(z)$ 洛朗展开的非负幂次部分为它的\emph{解析部分}, 负幂次部分为它的\emph{主要部分}.

% 设在圆环域 $R_1<|z-z_0|<R_2$ 内的解析函数 $f(z)$ 可以表达为双边幂级数
% \[f(z)=\sum_{n=-\infty}^\infty c_n(z-z_0)^n,\]
% 则逐项积分得到
% \[\oint_C\frac{f(\zeta)\diff\zeta}{(\zeta-z_0)^{n+1}}=\sum_{k=-\infty}^\infty c_k\oint_C(\zeta-z_0)^{k-n-1}\diff\zeta=2\pi i c_n.\]
% 因此 $f(z)$ 在圆环域内的\emph{双边幂级数展开是唯一的, 它就是洛朗级数}.

% \begin{example}
% 	将 $f(z)=\dfrac{e^z-1}{z^2}$ 展开为以 $0$ 为中心的洛朗级数.
% \end{example}

% 由洛朗级数的唯一性, 我们可以从 $e^z$ 的泰勒展开通过代数运算来得到洛朗级数.
% 这种做法比直接计算积分更简便.
% 因此我们一般\emph{不用直接法}, 而是\emph{用双边幂级数的代数、求导、求积分运算}来得到洛朗级数.

% \begin{solution}
% 	\[\frac{e^z-1}{z^2}=\frac1{z^2}\left(z+\frac{z^2}{2!}+\frac{z^3}{3!}+\cdots\right)
% 	{=\frac1z+\sum_{n=0}^\infty \frac1{(n+2)!}z^n,}\]
% 	{其中 $0<|z|<+\infty$.}
% \end{solution}

% \begin{example}
% 	在下列圆环域中把 $f(z)=\dfrac1{(z-1)(z-2)}$ 展开为洛朗级数.

% 	{\enumnum1 $0<|z|<1$, \enumnum2 $1<|z|<2$, \enumnum3 $2<|z|<+\infty$.}
% \end{example}

% \begin{solution}
% 	由于 $f(z)$ 的奇点为 $z=1,2$, 因此在这些圆环域内 $f(z)$ 都可以展开为洛朗级数.
% 	{注意到
% 		\[f(z)=\frac1{z-2}-\frac1{z-1},\]
% 		因此我们可以根据 $|z|$ 的范围来将其展开成等比级数.}
% \end{solution}

% \begin{solutionc}
% 	\enumnum1 由于 $|z|<1,\abs{\dfrac z2}<1$,
% 	{因此
% 		\begin{align*}
% 			f(z)&=-\frac1{2-z}+\frac1{1-z}
% 			{=-\half\cdot\frac1{1-\dfrac z2}+\frac1{1-z}}\\
% 			&{=-\half\sum_{n=0}^\infty\left(\frac z2\right)^n+\sum_{n=0}^\infty z^n}
% 			{=\sum_{n=0}^\infty\left(1-\frac1{2^{n+1}}\right)z^n}\\
% 			&{=\half +\frac34z+\frac78z^2+\cdots}
% 		\end{align*}}
% \end{solutionc}

% \begin{solutionc}
% 	\enumnum2 由于 $\abs{\dfrac1z}<1,\abs{\dfrac z2}<1$, 
% 	{因此
% 		\begin{align*}
% 			f(z)&=\frac1{1-z}-\frac1{2-z}
% 			{=-\frac1z\cdot\frac1{1-\dfrac1z}-\half\cdot\frac1{1-\dfrac z2}}\\
% 			&{=-\frac1z\sum_{n=0}^\infty \left(\frac1z\right)^n-\half\sum_{n=0}^\infty\left(\frac z2\right)^n}
% 			{=-\sum_{n=1}^{\infty}\frac1{z^n}-\sum_{n=0}^\infty\frac1{2^{n+1}}z^n}\\
% 			&{=\cdots-\frac1{z^2}-\frac1z-\half -\frac14z-\frac18z^2-\cdots}
% 		\end{align*}}
% \end{solutionc}

% \begin{solutionc}
% 	\enumnum3 由于 $\abs{\dfrac1z}<1,\abs{\dfrac2z}<1$, {因此
% 		\begin{align*}
% 			f(z)&=\frac1{1-z}-\frac1{2-z}
% 				{=-\frac1z\cdot\frac1{1-\dfrac1z}+\frac1z\cdot\frac1{1-\dfrac2z}}\\
% 			&{=-\frac1z\sum_{n=0}^\infty \left(\frac1z\right)^n+\frac1z\sum_{n=0}^\infty\left(\frac2z\right)^n}
% 				{=\sum_{n=0}^\infty\frac{2^n-1}{z^{n+1}}}\\
% 			&{=\frac1{z^2}+\frac3{z^3}+\frac7{z^4}+\cdots}
% 		\end{align*}}
% \end{solutionc}

% 洛朗展开的一些特点可以帮助我们检验计算的正确性.
% \begin{itemize}
% 	\item  若 $f(z)$ 在 $|z-z_0|<R_2$ 内\emph{解析},
% 		则 $f(z)$ 可以展开为泰勒级数.
% 		由唯一性可知泰勒级数等于洛朗级数,
% 		因此\emph{此时洛朗展开一定没有负幂次项}.
% 	\item 若 $f(z)$ 在圆周 $|z-z_0|=R_1,R_2>0$ 上\emph{有奇点}, 则在圆环域 $R_1<|z-z_0|<R_2$ 上的洛朗展开\emph{一定有无穷多负幂次和无穷多正幂次项}.
% 	\item 有理函数在 $0<|z-z_0|<r$ 洛朗展开\emph{最多只有有限多负幂次项}, 在 $R<|z-z_0|<+\infty$ 洛朗展开\emph{最多只有有限多正幂次项}.
% \end{itemize}

% 如果有理函数 $f(z)$ 在圆环域 $r<|z|<R$ 内解析, 那么它的洛朗展开一定形如
% \[f(z)=P(z)+\sum_{n\ge 0}a_n z^n+\sum_{n<0}b_n z^n,\]
% 其中 $P(z)$ 只有有限多项, 
% $a_n$ 是形如 $p(n)\lambda^{-n}$ 的线性组合, $|\lambda|\ge R$ 是奇点, $\deg p+1$ 是 $\lambda$ 在 $f(z)$ 出现的重数; 而 $b_n$ 则是 $|\lambda|\le r$ 的那个奇点对应的组合.

% 不仅如此, 在不同的圆环域不同圆环域上的洛朗展开{\itshape 形式地相减}, 系数会有\emph{共同的通项形式}.

% 例如在 $0<|z|<1$ 内,
% \[f(z)=\frac{120}{(z-1)(z^2-4)(z^2-9)}=\sum_{n\ge 0}\left(-5+\frac2{(-2)^{n+1}}+\frac6{2^{n+1}}-\frac1{(-3)^{n+1}}-\frac2{3^{n+1}}\right)z^n.\]
% 那么在 $2<|z|<3$ 内洛朗展开的系数就是上面的每个系数(不论正负 $n$)减去一个共同形式的项, 使得其非负幂次通项对应那些奇点 $|\lambda|\ge 3$, 而负幂次通项对应那些奇点 $|\lambda|\le2$.
% 故
% \[f(z)=\sum_{n\ge 0}\left(-\frac1{(-3)^{n+1}}-\frac2{3^{n+1}}\right)z^n+\sum_{n\le-1}\left(5-\frac2{(-2)^{n+1}}-\frac6{2^{n+1}}\right)z^n.\]
% 其证明可见\emph{\href{https://zhangshenxing.gitee.io/teaching/publications/袁志杰张神星2023 复变函数在不同圆环域内洛朗展开的联系.pdf}{复变函数在不同圆环域内洛朗展开的联系}}一文.

% \begin{example}
% 	(2022年A卷) 将函数 $f(z)=\dfrac{z+1}{(z-1)^2}$ 在圆环域 $0<|z|<1$ 内展开成洛朗级数.
% \end{example}

% \begin{solution}
% 	\[f(z)=\frac{z-1+2}{(z-1)^2}=\frac1{z-1}+\frac{2}{(z-1)^2}=-\frac1{1-z}+2\left(\frac1{1-z}\right)'\]
% 	{因此当 $0<|z|<1$ 时,
% 		\[f(z)=-\sum_{n=0}^\infty z^n+2\left(\sum_{n=0}^\infty z^n\right)'=-\sum_{n=0}^\infty z^n+2\sum_{n=1}^\infty nz^{n-1}
% 		=\sum_{n=0}^\infty(2n+1)z^n.\]}
% \end{solution}

% \begin{exercise}
% 	(2022年A卷) 将函数 $f(z)=\dfrac{z+1}{(z-1)^2}$ 在圆环域 $1<|z|<+\infty$ 内展开成洛朗级数.
% \end{exercise}

% \begin{answer}
% 	\[f(z)=\sum_{n=1}^\infty \frac{2n-1}{z^n}.\]
% \end{answer}
% 利用幂函数的泰勒展开可以得到
% \[\frac1{(1-\lambda z)^k}=-\sum_{n<0}(n+k-1)\cdots(n+2)(n+1)z^n,\ |z|>\frac1{|\lambda|}.\]
% 实际上求和范围可以改成 $n\le -k$.

% 注意到当 $n=-1$ 时, 洛朗级数的系数
% \[c_{-1}=\frac1{2\pi i}\oint_C f(\zeta)\diff\zeta,\]
% 因此洛朗展开可以用来帮助计算函数的积分,
% 这便引出了\emph{留数}的概念.


% \begin{example}
% 	求 $\displaystyle\oint_{|z|=3}\frac1{z(z+1)^2}\diff z$.
% \end{example}

% \begin{solution}
% 	注意到闭路 $|z|=3$ 落在 $1<|z+1|<+\infty$ 内.
% 	{我们在这个圆环域内求 $f(z)=\dfrac1{z(z+1)^2}$ 的洛朗展开.
% 		\begin{align*}
% 		f(z)&=\frac1{z(z+1)^2}=\frac1{(z+1)^3}\cdot\frac1{1-\dfrac1{z+1}}\\
% 		&{=\frac1{(z+1)^3}\sum_{n=0}^\infty\frac1{(z+1)^n}}
% 		{=\sum_{n=0}^{\infty}\frac1{(z+1)^{n+3}}}
% 		\end{align*}故
% 		$\displaystyle\oint_Cf(z)\diff z=2\pi i c_{-1}=0$.}
% \end{solution}
% % 

% \begin{example}
% 	求 $\displaystyle\oint_{|z|=1}\frac{z}{\sin z^2}\diff z$.
% \end{example}

% \begin{solution}
% 	注意到闭路 $|z|=1$ 落在 $0<|z|<\sqrt \pi$ 内.
% 	{我们在这个圆环域内求 $f(z)=\dfrac{z}{\sin z^2}$ 的洛朗展开.
% 		\[
% 		f(z)=\frac{z}{\sin z^2}=
% 		\frac{z}{z^2-\dfrac{z^6}{3!}+\dfrac{z^{10}}{5!}+\cdots}
% 		{=\frac1z+\frac{z^3}6+\cdots}
% 		\]故
% 		$\displaystyle\oint_Cf(z)\diff z=2\pi i c_{-1}=2\pi i$.}
% \end{solution}

% \chapter{留数}
% \section{孤立奇点}

% \subsection{孤立奇点的类型}

% 我们先根据奇点附近洛朗展开的形式来对其进行分类, 以便于分类计算留数.

% \begin{example}
% 		考虑函数 $f(z)=\dfrac1{\sin(1/z)}$, 显然 $0,z_k=\dfrac1{k\pi}$ 是奇点, $k$ 是非零整数.
% 	{因为 $\lim\limits_{k\to+\infty} z_k=0$, 所以 $0$ 的任何一个去心邻域内都有奇点.此时无法选取一个圆环域 $0<|z|<\delta$ 作 $f(z)$ 的洛朗展开, 因此我们不考虑这类奇点.
% 	}
% 	{
% 	\begin{center}
% 		\begin{tikzpicture}[framed]
% 			\draw[cstcurve,dcolorc] (0,0) circle (1.3);
% 			\fill[cstdot] (0,0) circle;
% 			\fill[cstdot,dcolorb] (2,0) circle;
% 			\fill[cstdot,dcolora] (1,0) circle;
% 			\fill[cstdot,dcolorb] (0.6667,0) circle;
% 			\fill[cstdot,dcolora] (0.5,0) circle;
% 			\fill[cstdot,dcolorb] (0.4,0) circle;
% 			\draw
% 				(-0.3,0) node {$0$}
% 				(2,-0.3) node[dcolorb] {$z_1$}
% 				(1,0.3) node[dcolora] {$z_2$}
% 				(0.6667,-0.3) node[dcolorb] {$z_3$}
% 				(0.5,0.3) node[dcolora] {$z_4$}
% 				(0.4,-0.3) node[dcolorb] {$z_k$};
% 		\end{tikzpicture}
% 	\end{center}}
% \end{example}

% \begin{definition}
% 	如果 $z_0$ 是 $f(z)$ 的一个奇点, 且 $z_0$ 的某个邻域内没有其它奇点, 则称 $z_0$ 是 $f(z)$ 的一个\emph{孤立奇点}.
% \end{definition}

% \begin{example}
% 	\begin{itemize}
% 		\item $z=0$ 是 $e^{\frac1z},\dfrac{\sin z}z$ 的孤立奇点.
% 		\item $z=-1$ 是 $\dfrac1{z(z+1)}$ 的孤立奇点.
% 		\item $z=0$ 不是 $\dfrac1{\sin(1/z)}$ 的孤立奇点.
% 	\end{itemize}
% \end{example}

% 若 $f(z)$ 只有有限多个奇点, 则这些奇点都是孤立奇点.

% 如果 $f(z)$ 在孤立奇点 $z_0$ 的去心邻域 $0<|z-z_0|<\delta$ 内解析, 则可以作 $f(z)$ 的洛朗展开.
% 根据该洛朗级数主要部分的项数, 我们可以将孤立奇点分为三种:
% \begin{center}
% 	\defaultrowcolors
% 	\Newcommand\arraystretch{1.4}
% 	\begin{tabular}{|c|c|c|}\hline
% 		孤立奇点类型&洛朗级数特点&$\lim\limits_{z\to z_0}f(z)$\\\hline
% 		可去奇点&没有主要部分&存在且有限\\\hline
% 		&主要部分只有有限项非零&\\
% 		\multirow{-2}*{$m$ 阶极点}&最低次为 $-m$ 次&\multirow{-2}*{$\infty$}\\\hline
% 		本性奇点&主要部分有无限项非零&不存在且不为 $\infty$\\\hline
% 	\end{tabular}
% \end{center}

% \begin{definition}
% 	若 $f(z)$ 在孤立奇点 $z_0$ 的去心邻域的洛朗级数没有主要部分, 即
% 	\[f(z)=c_0+c_1(z-z_0)+c_2(z-z_0)^2+\cdots,\quad 0<|z-z_0|<\delta,\]
% 	是幂级数, 则称 $z_0$ 是 $f(z)$ 的\emph{可去奇点}.
% \end{definition}

% 设 $g(z)$ 为右侧幂级数的和函数, 则 $g(z)$ 在 $|z-z_0|<\delta$ 上解析,
% 且除 $z_0$ 外 $f(z)=g(z)$.
% 通过补充或修改定义 $f(z_0)=g(z_0)=c_0$, 可使得 $f(z)$ 也在 $z_0$ 解析.
% 这就是``可去''的含义.

% \begin{theorem}
% 	\begin{tabular}{rl}
% 		$z_0$ 是 $f(z)$ 的可去奇点
% 		&$\iff\lim\limits_{z\to z_0}f(z)$ 存在且有限\\
% 		&$\iff\lim\limits_{z\to z_0}(z-z_0)f(z)=0$.
% 	\end{tabular}
% \end{theorem}

% \begin{example*}
% 		\[f(z)=\frac{\sin z}z=1-\dfrac{z^2}{3!}+\dfrac{z^4}{5!}+\cdots\]
% 		没有负幂次项, 因此 $0$ 是可去奇点.

% 	{也可以从 $\lim\limits_{z\to0}zf(z)=\sin 0=0$ 看出.
% 	}
% \end{example*}

% \begin{example*}
% 		\[f(z)=\frac{e^z-1}z=1+\dfrac z{2!}+\dfrac{z^2}{3!}+\cdots\]
% 		没有负幂次项, 因此 $0$ 是可去奇点.

% 	{也可以从 $\lim\limits_{z\to0}zf(z)=e^0-1=0$ 看出.
% 	}
% \end{example*}

% \begin{definition}
% 	若 $f(z)$ 在孤立奇点 $z_0$ 的去心邻域的洛朗级数主要部分有无限多项非零, 则称 $z_0$ 是 $f(z)$ 的\emph{本性奇点}.
% \end{definition}

% \begin{example}
% 	由于 $\displaystyle e^{\frac1z}=1+\frac1z+\frac1{2z^2}+\cdots$, 因此 $0$ 是本性奇点.
% \end{example}

% \begin{theorem}
% 	$z_0$ 是 $f(z)$ 的本性奇点 $\iff\lim\limits_{z\to z_0}f(z)$ 不存在也不是 $\infty$.
% \end{theorem}

% 事实上我们有\emph{皮卡大定理}: 对于本性奇点 $z_0$ 的任何一个去心邻域, $f(z)$ 的像取遍所有复数, 至多有一个取不到.

% 可去奇点的性质比较简单, 而本性奇点的性质又较为复杂, 因此我们主要关心的是极点的情形.

% \begin{definition}
% 	如果 $f(z)$ 在孤立奇点 $z_0$ 的去心邻域的洛朗级数主要部分只有有限多项非零, 即
% 	\[f(z)=\frac{c_{-m}}{(z-z_0)^m}+\cdots+c_0+c_1(z-z_0)+\cdots,\ 0<|z-z_0|<\delta,\]
% 	其中 $c_{-m}\neq 0,m\ge 1$, 则称 $z_0$ 是 $f(z)$ 的 \emph{$m$ 阶极点}或 \emph{$m$ 级极点}.
% \end{definition}

% 令
% \[g(z)=c_{-m}+c_{-m+1}(z-z_0)+c_{-m+2}(z-z_0)^2+\cdots,\]
% 则 $g(z)$ 在 $z_0$ 解析且非零,
% 且
% \[f(z)=\dfrac{g(z)}{(z-z_0)^m},0<|z-z_0|<\delta.\]

% \begin{theorem}
% 	\begin{enumerate}
% 		\item $z_0$ 是 $f(z)$ 的 $m$ 阶极点 $\iff\lim\limits_{z\to z_0}(z-z_0)^mf(z)$ 存在且非零.
% 		\item $z_0$ 是 $f(z)$ 的极点 $\iff\lim\limits_{z\to z_0}f(z)=\infty$.
% 	\end{enumerate}
% \end{theorem}

% \begin{example}
% 		$f(z)=\dfrac{3z+2}{z^2(z+2)}$,
% 	{由于 $\lim\limits_{z\to 0}z^2f(z)=1$, 因此 $0$ 是二阶极点.同理 $-2$ 是一阶极点.
% 	}
% \end{example}

% \begin{exercise}
% 	求 $f(z)=\dfrac1{z^3-z^2-z+1}$ 的奇点, 并指出极点的阶.
% \end{exercise}

% \begin{answer}
% 	$-1$ 是一阶极点, $1$ 是二阶极点.
% \end{answer}

% \subsection{零点与极点}

% 我们来研究极点与零点的联系, 并给出极点的阶的计算方法.
% \begin{definition}
% 	如果 $f(z)$ 在解析点 $z_0$ 处的泰勒级数最低次项幂次是 $m\ge1$, 即
% 	\[f(z)=c_m(z-z_0)^m+c_{m+1}(z-z_0)^{m+1}+\cdots,\ 0<|z-z_0|<\delta,\]
% 	其中 $c_m\neq 0$, 则称 $z_0$ 是 $f(z)$ 的 \emph{$m$ 阶零点}.
% \end{definition}

% 此时 $f(z)=(z-z_0)^mg(z)$, $g(z)$ 在 $z_0$ 解析且 $g(z_0)\neq 0$.

% \begin{theorem}
% 	设 $f(z)$ 在 $z_0$ 解析.
% 	$z_0$ 是 $m$ 阶零点当且仅当
% 	\[f(z_0)=f'(z_0)=\cdots=f^{(m-1)}(z_0)=0,\quad
% 	f^{(m)}(z_0)\neq 0.\]
% \end{theorem}

% \begin{example}
% 		$f(z)=z(z-1)^3$
% 	{有一阶零点 $0$ 和三阶零点 $1$.
% 	}
% \end{example}

% \begin{example}
% 		$f(z)=\sin z-z$.
% 	{由于
% 		\[f(z)=\frac{z^3}{3!}-\frac{z^5}{5!}+\cdots\]
% 		因此 $0$ 是三阶零点.
% 	}
% \end{example}

% \begin{theorem}
% 非零的解析函数的零点总是孤立的.
% \end{theorem}

% \begin{proof}
% 	设 $f(z)$ 是区域 $D$ 上的非零解析函数, $z_0\in D$ 是 $f(z)$ 的一个零点.
% {%
% 	由于 $f(z)$ 不恒为零, 因此存在 $m\ge 1$ 使得在 $z_0$ 的一个邻域内 $f(z)=(z-z_0)^m g(z)$, $g(z)$ 在 $z_0$ 处解析且非零.
% }

% {
% 	对于 $\varepsilon=\dfrac12|g(z_0)|$, 存在 $\delta>0$ 使得当 $z\in \Uc(z_0,\delta)\subseteq D$ 时, $|g(z)-g(z_0)|<\varepsilon$.
% }%
% {%
% 	从而 $g(z)\neq0$, $f(z)\neq 0$.\qedhere
% }
% \end{proof}

% 由此可知, 一旦我们知道了解析函数在一串有极限的数列上的值, 这个解析函数本身就被唯一决定了.

% 为了统一地研究零点和极点, 我们引入下述记号.
% 设 $z_0$ 是 $f(z)$ 的可去奇点、极点或解析点.
% 记 $\ord(f,z_0)$ 为 $f(z)$ 在 $z_0$ 的洛朗展开的最低次项幂次.

% 不难看出,
% \begin{enumerate}
% 	\item 如果 $\ord(f,z_0)\ge0$, 则 $z_0$ 是可去奇点或解析点.
% 	\item 如果 $\ord(f,z_0)=m>0$, 则 $z_0$ 是可去奇点或 $m$ 阶零点.
% 	\item 如果 $\ord(f,z_0)=-m<0$, 则 $z_0$ 是 $m$ 阶极点.
% \end{enumerate}

% \begin{alertblock}{可去奇点和极点判定方法}
% 	如果 $\ord(f,z_0)=m,\ord(g,z_0)=n$, 那么
% 	\[\ord\left(\frac fg,z_0\right)=m-n,\quad\ord(fg,z_0)=m+n.\]
% \end{alertblock}

% \begin{proof}
% 		设 $f_0(z)$ 为幂级数 $(z-z_0)^{-m}f(z)$ 的和函数, $g_0(z)$ 为幂级数 $(z-z_0)^{-n}g(z)$ 的和函数,
% 	{则 $f_0(z),g_0(z)$ 在 $z_0$ 解析且非零.
% 	}%

% 	{因此 $\dfrac{f_0(z)}{g_0(z)},f_0(z)g_0(z)$ 在 $z_0$ 解析且非零.由
% 		\[\frac{f(z)}{g(z)}=(z-z_0)^{m-n}\frac{f_0(z)}{g_0(z)},\quad
% 		f(z)g(z)=(z-z_0)^{m+n}f_0(z)g_0(z)\]
% 		可知命题成立.\qedhere
% 	}
% \end{proof}

% \begin{corollary}
% 	设 $z_0$ 是 $f(z)$ 的 $m$ 阶零点, 是 $g(z)$ 的 $n$ 阶零点.
% 	\begin{enumerate}
% 		\item 若 $m\ge n$, 则 $z_0$ 是 $\dfrac{f(z)}{g(z)}$ 的可去奇点.
% 		\item 若 $m<n$ 时, 则 $z_0$ 是 $\dfrac{f(z)}{g(z)}$ 的 $n-m$ 阶极点.
% 	\end{enumerate}
% \end{corollary}

% \begin{example}
% 	单选题: (2021年B卷) $z=0$ 是函数 $f(z)=\dfrac{e^z-1}{z^2}$ 的\fillbrace{{A}} 阶极点.
% 	\xx{$1$}{$2$}{$3$}{$4$}
% \end{example}

% \begin{solution}
% 		由于 $e^z-1=z+\dfrac{z^2}{2!}+\cdots$, 所以 $0$ 是 $e^z-1$ 的一阶零点.

% 	{因此 $\ord(f,0)=1-2=-1$, $0$ 是一阶极点.
% 	}
% \end{solution}

% \begin{example}
% 	$z=0$ 是 $f(z)=\dfrac{(e^z-1)^3z^2}{\sin z^7}$ 的几阶极点?
% \end{example}

% \begin{solution}
% 		由于 $(\sin z)'(0)=\cos 0=1$, 所以 $0$ 是 $\sin z$ 的一阶零点.

% 	{因此 $\ord(f,0)=3+2-7=-2$, $0$ 是二阶极点.
% 	}
% \end{solution}

% \begin{exercise}
% 	求 $f(z)=\dfrac{(z-5)\sin z}{(z-1)^2z^2(z+1)^3}$ 的奇点.
% \end{exercise}

% \begin{answer}
% 	$1$ 是二阶极点, $0$ 是一阶极点, $-1$ 是三阶极点.
% \end{answer}

% \subsection{函数在 \texorpdfstring{$\infty$}{∞} 的性态}

% 当我们把复平面扩充成闭复平面后, 从几何上看它变成了一个球面.
% 这样的一个球面是一种封闭的曲面, 它具有某些整体性质.

% 当我们需要计算一个闭路上函数的积分的时候,
% 我们需要研究闭路内部每一个奇点处的洛朗展开,
% 从而得到相应的小闭路上的积分.
% 如果在这个闭路内部的奇点比较多, 而外部的奇点比较少时, 这样计算就不太方便.
% 此时如果通过变量替换 $z=\dfrac1t$, 转而研究闭路外部奇点处的洛朗展开,
% 便可减少所需考虑的奇点个数, 从而降低所需的计算量.
% 因此我们需要研究函数在 $\infty$ 的性态.

% \begin{definition}
% 	如果函数 $f(z)$ 在 $\infty$ 的去心邻域 $R<|z|<+\infty$ 内没有奇点, 则称 $\infty$ 是 $f(z)$ 的\emph{孤立奇点}.
% \end{definition}

% 设 $g(t)=f\left(\dfrac1t\right)$, 则研究 $f(z)$ 在 $\infty$ 的性质可以转为研究 $g(t)$ 在 $0$ 的性质.
% $g(t)$ 在圆环域 $0<|t|<\dfrac1R$ 上解析, $0$ 是它的孤立奇点.

% \begin{definition}
% 	如果 $0$ 是 $g(t)$ 的可去奇点 ($m$ 阶极点、本性奇点), 则称 $\infty$ 是 $f(z)$ 的\emph{可去奇点 ($m$ 阶极点、本性奇点).}
% \end{definition}

% 设 $f(z)$ 在圆环域 $R<|z|<+\infty$ 的洛朗展开为
% \[f(z)=\cdots+\frac{c_{-2}}{z^2}+\frac{c_{-1}}{z}+c_0+c_1z+c_2z^2+\cdots\]
% 则 $g(t)$ 在圆环域 $0<|t|<\dfrac1R$ 的洛朗展开为
% \[g(t)=\cdots+\frac{c_2}{t^2}+\frac{c_1}t+c_0+c_{-1}t+c_{-2}t^2+\cdots\]
% \begin{center}
% 	\defaultrowcolors
% 	\Newcommand\arraystretch{1.2}
% 	\begin{tabular}{|c|c|c|}\hline
% 		$\infty$ 类型&洛朗级数特点&$\lim\limits_{z\to\infty}f(z)$\\\hline
% 		可去奇点&没有正幂次部分&存在且有限\\\hline
% 		&正幂次部分只有有限项非零&\\
% 		\multirow{-2}*{$m$ 阶极点}&最高次为 $m$ 次&\multirow{-2}*{$\infty$}\\\hline
% 		本性奇点&正幂次部分有无限项非零&	不存在且不为 $\infty$\\\hline
% 	\end{tabular}
% \end{center}

% \begin{example}
% 		$f(z)=\dfrac z{z+1}$.
% 	{由 $\lim\limits_{z\to\infty}f(z)=1$ 可知 $\infty$ 是可去奇点.事实上此时 $f(z)$ 在 $1<|z|<+\infty$ 内的洛朗展开为
% 		\[f(z)=\frac{1}{1+\dfrac1z}=1-\frac1z+\frac1{z^2}-\frac1{z^3}+\cdots\]
% 	}
% \end{example}

% \begin{example}
% 		函数 $f(z)=z^2+\dfrac1z$
% 	{含有正次幂项且最高次为 $2$, 因此 $\infty$ 是 $2$ 阶极点.
% 	}
% \end{example}

% \begin{example}
% 		设 $p(z)$ 是 $n\ge1$ 次多项式,
% 	{则 $\infty$ 是 $p(z)$ 的 $n$ 阶极点.
% 	}
% \end{example}

% \begin{example*}
% 		函数 
% 		\[\sin z=z-\frac{z^3}{3!}+\frac{z^5}{5!}-\frac{z^7}{7!}+\cdots\]
% 	{含有无限多正次幂项, 因此 $\infty$ 是本性奇点.
% 	}

% 	{事实上, 如果函数 $f(z)$ 在复平面上处处解析, 且 $f(z)$ 不是多项式, 则 $\infty$ 是它的本性奇点.
% 	}
% \end{example*}

% \begin{example}
% 	函数 $f(z)=\dfrac{(z^2-1)(z-2)^3}{(\sin{\pi z})^3}$ 在扩充复平面内有哪些什么类型的奇点, 并指出极点的阶.
% \end{example}

% \begin{solution}
% 	\begin{itemize}
% 		\item 整数 $z=k\neq \pm1,2$ 是 $\sin{\pi z}$ 的一阶零点, 因此是 $f(z)$ 的三阶极点.
% 		\item $z=\pm1$ 是 $z^2-1$ 的一阶零点, 因此是 $f(z)$ 的二阶极点.
% 		\item $z=2$ 是 $(z-2)^3$ 的三阶零点, 因此是 $f(z)$ 的可去奇点.
% 		\item 由于奇点 $1,2,3,\cdots\to \infty$, 因此 $\infty$ 不是孤立奇点.
% 	\end{itemize}
% \end{solution}

% \begin{exercise}
% 	函数 $f(z)=\dfrac{z^2+4\pi^2}{z^3(e^z-1)}$ 在扩充复平面内有哪些什么类型的奇点, 并指出极点的阶.
% \end{exercise}

% \begin{answer}
% 	\begin{itemize}
% 		\item $z=2k\pi i$ 是一阶极点, $k\neq 0,\pm1$.
% 		\item $z=0$ 是四阶极点.
% 		\item $z=\pm 2\pi i$ 是可去奇点.
% 		\item $z=\infty$ 不是孤立奇点.
% 	\end{itemize}
% \end{answer}

% \begin{example}
% 	证明非常数复系数多项式 $p(z)$ 总有复零点.
% \end{example}

% \begin{proof}
% 	假设多项式 $p(z)$ 没有复零点, 那么 $f(z)=\dfrac1{p(z)}$ 在复平面上处处解析, 
% {%
% 	从而 $f(z)$ 在 $0$ 处可以展开为幂级数.
% }

% {%
% 	由于 $\infty$ 是 $p(z)$ 的极点, $\lim\limits_{z\to\infty}p(z)=\infty$.
% }%
% {%
% 	因此 $\lim\limits_{z\to\infty}f(z)=0$, $\infty$ 是 $f(z)$ 的可去奇点.
% }%
% {%
% 	这意味着 $f(z)$ 在 $0$ 处的洛朗展开没有正幂次项.
% }%
% {%
% 	二者结合可知 $f(z)$ 只能是常数, 矛盾!\qedhere
% }
% \end{proof}

% 设 $z_1$ 是 $n$ 次多项式 $p(z)$ 的零点, 则 $\dfrac{p(z)}{z-z_1}$ 是 $n-1$ 次多项式.
% 归纳可知, $p(z)$ 可以分解为 $p(z)=(z-z_1)\cdots(z-z_n)$.

% \section{留数}

% \subsection{留数定理}

% \begin{definition}
% 		设 $z_0$ 为 $f(z)$ 的孤立奇点, $f(z)$ 在它的某个去心邻域内的洛朗展开为
% 		\[f(z)=\cdots+\frac{c_{-1}}{z-z_0}+c_0+c_1(z-z_0)+\cdots.\]
% 	{称
% 		\[\emph{\Res[f(z),z_0]:=c_{-1}=\frac1{2\pi i}\oint_Cf(z)\diff z}\]
% 		为函数 \emph{$f(z)$ 在 $z_0$ 的留数}, 其中 $C$ 为该去心邻域中绕 $z_0$ 的一条闭路.
% 	}
% \end{definition}

% 可以看出, 知道留数之后可以用来计算积分.

% \begin{block}{留数定理}
% 	若 $f(z)$ 在闭路 $C$ 上解析, 在 $C$ 内部的奇点为 $z_1,z_2,\dots,z_n$, 则
% 	\[\oint_Cf(z)\diff z=2\pi i\sum_{k=1}^n\Res[f(z),z_k].\]
% \end{block}

% \begin{proof}
% 	\begin{center}
% 		\begin{tikzpicture}[scale=.8]
% 			\filldraw[cstcurve,rounded corners=0.4cm,dcolora,cstfill] (-3,-1) rectangle (3,1);
% 			\draw[cstcurve,dcolora,cstarrow1to] (3,-0.2)--(3,0.1);
% 			\filldraw[cstcurve,white,draw=dcolorb] (-2,0.2) circle (0.5);
% 			\draw[cstcurve,dcolorb,cstarrow1to] (-2,0.7) arc(90:135:0.5);
% 			\fill[cstdot] (-2,0.2) circle;
% 			\filldraw[cstcurve,white,draw=dcolorb] (0.2,-0.2) circle (0.5);
% 			\draw[cstcurve,dcolorb,cstarrow1to] (0.2,0.3)arc(90:135:0.5);
% 			\fill[cstdot] (0.2,-0.2) circle;
% 			\filldraw[cstcurve,white,draw=dcolorb] (2,0.2) circle (0.5);
% 			\draw[cstcurve,dcolorb,cstarrow1to] (2,0.7)arc(90:135:0.5);
% 			\fill[cstdot] (2,0.2) circle;
% 			\draw
% 				(3.4,0) node[dcolora] {$C$}
% 				(-1.3,-0.2) node[dcolorb] {$C_1$}
% 				(0.2,0.5) node[dcolorb] {$C_2$}
% 				(2.4,-0.5) node[dcolorb] {$C_3$}
% 				(-2,-0.1) node {$z_1$}
% 				(0.2,-0.5) node {$z_2$}
% 				(2,-0.1) node {$z_3$};
% 		\end{tikzpicture}
% 	\end{center}

% 	{由复闭路定理,
% 	\[\oint_Cf(z)\diff z=\sum_{k=1}^n\oint_{C_k}f(z)\diff z
% 	=2\pi i\sum_{k=1}^n\Res[f(z),z_k].\qedhere\]}
% \end{proof}

% \subsection{留数的计算方法}

% 若 $z_0$ 为 $f(z)$ 的可去奇点, 则显然 $\Res[f(z),z_0]=0$.

% \begin{example}
% 		$f(z)=\dfrac{z^3(e^z-1)^2}{\sin z^4}$.
% 	{由于 $\ord(f,0)=3+2-4=1$, $z=0$ 是 $f(z)$ 的可去奇点,因此 \[\Res[f(z),0]=0.\]
% 	}
% \end{example}

% 若 $z_0$ 为 $f(z)$ 的本性奇点, 一般只能从定义计算.

% \begin{example}
% 	$f(z)=z^4\sin\dfrac1z$.
% {%
% 	由于
% 	\[f(z)=z^4\sum_{n=0}^\infty(-1)^n\frac{z^{-2n-1}}{(2n+1)!}
% 	=z^3-\frac z{3!}+\frac1{5!z}+\cdots\]
% }
% {%
% 	因此 \[\Res[f(z),0]=\frac1{120}.\]
% }
% \end{example}

% 设 $z_0$ 为 $f(z)$ 的极点.

% \begin{alertblock}{极点留数计算公式 I}
% 	如果 $z_0$ 是 $\le m$ 阶极点或可去奇点, 那么
% 	\[\Res[f(z),z_0]=\frac1{(m-1)!}\lim_{z\to z_0}\frac{\diff^{m-1}}{\diff z^{m-1}}[(z-z_0)^mf(z)].\]
% \end{alertblock}

% \begin{alertblock}{极点留数计算公式 II}
% 	如果 $z_0$ 是一阶极点或可去奇点, 那么
% 	\[\Res[f(z),z_0]=\lim\limits_{z\to z_0}(z-z_0)f(z).\]
% \end{alertblock}

% \begin{proof}
% 	设
% 	\begin{align*}
% 		f(z)&=c_{-m}(z-z_0)^{-m}+\cdots+c_{-1}(z-z_0)^{-1}+c_0+\cdots,\\
% 		g(z)&=c_{-m}+\cdots+c_{-1}(z-z_0)^{m-1}+c_0(z-z_0)^m+\cdots,
% 	\end{align*}
% {%
% 	则 $g(z)=(z-z_0)^mf(z)$.
% }%
% {%
% 	由泰勒展开系数与函数导数的关系可知
% 	\[\Res[f(z),z_0]=c_{-1}=\dfrac1{(m-1)!}g^{(m-1)}(z_0).\qedhere\]
% }
% \end{proof}

% \begin{example}
% 	求 $\Res\left[\dfrac{e^z}{z^n},0\right]$.
% \end{example}

% \begin{solution}
% 		显然 $0$ 是 $n$ 阶极点,
% 	{\begin{align*}
% 			\Res\left[\frac{e^z}{z^n},0\right]&=\frac1{(n-1)!}\lim_{z\to0}(e^z)^{(n-1)}\\
% 			&{=\frac1{(n-1)!}\lim_{z\to0}e^z=\frac1{(n-1)!}.}
% 		\end{align*}
% 	}
% \end{solution}

% \begin{example}
% 	求 $\Res\left[\dfrac{z-\sin z}{z^6},0\right]$.
% \end{example}

% \begin{solution}
% 		因为 $z=0$ 是 $z-\sin z$ 的三阶零点,
% 	{所以是 $\dfrac{z-\sin z}{z^6}$ 的三阶极点.如果用公式
% 		\[\Res\left[\frac{z-\sin z}{z^6},0\right]
% 		=\frac1{2!}\lim_{z\to0}\left(\frac{z-\sin z}{z^3}\right)''\]
% 		计算会很繁琐.
% 	}

% 	{
% 	\begin{align*}
% 		\Res\left[\frac{z-\sin z}{z^6},0\right]&=\frac1{5!}\lim_{z\to0}(z-\sin z)^{(5)}\\
% 		&{=\frac1{5!}\lim_{z\to0}(-\cos z)=-\frac1{120}.}
% 	\end{align*}}
% \end{solution}

% \begin{exercise}
% 		求 $\Res\left[\dfrac{e^z-1}{z^5},0\right]=$\fillblank[2cm][2mm]{{$\dfrac1{24}$}}.
% \end{exercise}

% \begin{alertblock}{极点留数计算公式 III}
% 	设 $P(z),Q(z)$ 在 $z_0$ 解析且 $z_0$ 是 $Q$ 的一阶零点, 则
% 	\[\Res\left[\frac{P(z)}{Q(z)},z_0\right]=\frac{P(z_0)}{Q'(z_0)}.\]
% \end{alertblock}

% \begin{proof}
% 		不难看出 $z_0$ 是 $f(z)=\dfrac{P(z)}{Q(z)}$ 的一阶极点或可去奇点.
% 	{因此
% 		\begin{align*}
% 			&\peq\Res[f(z),z_0]=\lim_{z\to z_0}(z-z_0)f(z)\\
% 			&{=\lim_{z\to z_0}\frac{P(z)}{\dfrac{Q(z)-Q(z_0)}{z-z_0}}}
% 			{=\frac{P(z_0)}{\lim\limits_{z\to z_0}\dfrac{Q(z)-Q(z_0)}{z-z_0}}=\frac{P(z_0)}{Q'(z_0)}.\qedhere}
% 		\end{align*}
% 	}
% \end{proof}

% \begin{example}
% 	求 $\Res\left[\dfrac{z}{z^8-1},\dfrac{1+i}{\sqrt2}\right]$.
% \end{example}

% \begin{solution}
% 		由于 $z=\dfrac{1+i}{\sqrt2}$ 是分母的 $1$ 阶零点,
% 	{因此
% 		\[\Res\left[\frac z{z^8-1},\frac{1+i}{\sqrt2}\right]
% 		=\frac z{(z^8-1)'}\Big|_{z=\frac{1+i}{\sqrt2}}
% 		=\frac z{8z^7}\Big|_{z=\frac{1+i}{\sqrt2}}
% 		=\frac i8.\]
% 	}
% \end{solution}


% \begin{example}
% 	计算积分 $\displaystyle\oint_{|z|=2}\frac{e^z}{z(z-1)^2}\diff z$.
% \end{example}

% \begin{solution}
% 		$f(z)=\dfrac{e^z}{z(z-1)^2}$ 在 $|z|<2$ 内有奇点 $z=0,1$.
% 	{\begin{align*}
% 		\Res[f(z),0]&=\lim_{z\to0}\frac{e^z}{(z-1)^2}=1,\\
% 		{\Res[f(z),1]}&{=\lim_{z\to1}\left(\frac{e^z}z\right)'=\lim_{z\to1}\frac{e^z(z-1)}{z^2}=0,}
% 	\end{align*}\[\oint_{|z|=2}\frac{e^z}{z(z-1)^2}\diff z
% 		=2\pi i\bigl[\Res[f(z),0]+\Res[f(z),1]\bigr]
% 		=2\pi i.\]
% 	}
% \end{solution}

% \subsection{在 \texorpdfstring{$\infty$}{∞} 的留数*}

% \begin{definition}
% 	设 $\infty$ 为 $f(z)$ 的孤立奇点, $f(z)$ 在某个 $R<|z|<+\infty$ 内的洛朗展开为
% 	\[f(z)=\cdots+c_{-1}z^{-1}+c_0+c_1z+\cdots\]
% 	称
% 	\[\emph{\Res[f(z),\infty]:=-c_{-1}=\frac1{2\pi i}\oint_{C^-}f(z)\diff z}\]
% 	为函数 \emph{$f(z)$ 在 $\infty$ 的留数}, 其中 $C$ 为该圆环域中绕 $0$ 的一条闭路.
% \end{definition}

% 由于
% \[f\left(\frac1z\right)\frac1{z^2}=\cdots+\frac{c_1}{z^3}+\frac{c_0}{z^2}+\frac{c_{-1}}z+c_{-2}+\cdots\]
% 因此 $\displaystyle\qquad\qquad\emph{\Res[f(z),\infty]=-\Res\left[f\left(\frac1z\right)\frac1{z^2},0\right]}$.

% 需要注意的是, 和普通复数不同, \emph{即便 $\infty$ 是可去奇点, 也不意味着 $\Res[f(z),\infty]=0$}.

% \begin{theorem}
% 	如果 $f(z)$ 只有有限个奇点, 那么 $f(z)$ 在\emph{扩充复平面内各奇点处的留数之和为 $0$}.
% \end{theorem}

% \begin{proof}
% 		设闭路 $C$ 内部包含除 $\infty$ 外所有奇点 $z_1,\dots,z_n$.
% 	{由留数定理
% 		\[-2\pi i\Res[f(z),\infty]=\oint_C f(z)\diff z=2\pi i\sum_{k=1}^n\Res[f(z),z_k].\]故 $\suml_{k=1}^n\Res[f(z),z_k]+\Res[f(z),\infty]=0$.\qedhere
% 	}
% \end{proof}

% \begin{example}
% 	求 $\displaystyle\oint_{|z|=2}f(z)\diff z$, 其中 $f(z)=\dfrac{\sin(1/z)}{(z+i)^{10}(z-1)(z-3)}$.
% \end{example}

% \begin{solution}
% 	$f(z)$ 在 $|z|>2$ 内只有奇点 $3,\infty$.
% {
% 	\[\Res[f(z),3]=\lim_{z\to3}(z-3)f(z)=\frac1{2(3+i)^{10}}\sin\frac13.\]
% }
% \end{solution}

% \begin{solutionc}
% 	\begin{align*}
% 		\Res[f(z),\infty]&=-\Res\left[f\left(\frac1z\right)\frac1{z^2},0\right]\\
% 		&=-\Res\left[\frac{z^{10}\sin z}{(1+iz)^{10}(1-z)(1-3z)},0\right]=0.
% 	\end{align*}
% {
% 	\begin{align*}
% 		\oint_{|z|=2}f(z)\diff z
% 		&=2\pi i\bigl[\Res[f(z),-i]+\Res[f(z),1]+\Res[f(z),0]\bigr]\\
% 		&{=-2\pi i\bigl[\Res[f(z),3]+\Res[f(z),\infty]\bigr]=-\frac{\pi i}{(3+i)^{10}}\sin\frac13.}
% 	\end{align*}
% }
% \end{solutionc}

% \begin{center}
% \begin{tikzpicture}[node distance=25pt]
% \node at (4.55,0.3) [cstnodeg]	(end1){求出 $f(z)$ 的原函数 $F(z)$ 得到 $\displaystyle\int_Cf(z)\diff z=F(b)-F(a)$};
% \node at (0,2.2) [cstnode]	(isanalytic){$f(z)$ 解析};
% \node at (4.5,2.2) [cstnodeg,align=center]	(end2){设曲线方程为 $z(t)$, 则\\
% 积分$\displaystyle=\int_a^bf(z)z'(t)\diff t$\\
% 可能需要分段计算};
% \node at (9,2.2) [cstnodeg,align=center]	(end4){用闭路外的孤立\\奇点的留数计算, \\最后取负号*};
% \node at (0,4.5) [cstnode]	(isclosed){是闭路};
% \node at (4.5,4.5) [cstnode]	(issingle){只有孤立奇点};
% \node at (9,4.5) [cstnode,align=center]	(ismany){闭路内部和外部\\孤立奇点数量};
% \node at (1.5,6.5) [cstnodeb]  (integral){定积分 $\displaystyle\int_Cf(z)\diff z$ 的计算};
% \node at (9,6.5) [cstnodeg,align=center]	(end3){用闭路内的孤立\\奇点的留数计算};

% \draw[cstnarrow,dcolorc] (integral.-160) -- (isclosed);
% \draw[cstnarrow,dcolorc] (isanalytic) -- node[left]{是} (end1.173);
% \draw[cstnarrow,dcolorc] (isclosed) -- node[above]{是} (issingle);
% \draw[cstnarrow,dcolorc] (issingle) -- node[above]{是} (ismany);
% \draw[cstnarrow,dcolorc] (isclosed) -- node[left]{否} (isanalytic);
% \draw[cstnarrow,dcolorc] (issingle) -- node[left]{否} (end2);
% \draw[cstnarrow,dcolorc] (isanalytic) -- node[above]{否} (end2);
% \draw[cstnarrow,dcolorc] (ismany) -- node[left]{闭路内的少} (end3);
% \draw[cstnarrow,dcolorc] (ismany) -- node[left]{闭路外的少} (end4);
% \end{tikzpicture}
% \end{center}

% 在求有理函数的洛朗展开, 以及之后在求有理函数的拉普拉斯逆变换时, 我们需要将一个有理函数表达为分母只有一个零点的有理函数之和.
% 例如:
% \[\frac{z-3}{(z+1)(z-1)^2}=\frac1{z-1}-\frac1{(z-1)^2}-\frac1{z+1}.\]
% 我们可以用待定系数法计算, 不过有时候使用留数会更为简便.

% \begin{solution}
% 		设 $\displaystyle f(z)=\frac{z-3}{(z+1)(z-1)^2}=\frac a{z-1}+\frac b{(z-1)^2}+\frac c{z+1}$,
% 	{则
% 		\begin{align*}
% 			a&=\Res[f(z),1]=\left(\frac{z-3}{z+1}\right)'\Big|_{z=1}=\frac 4{(z+1)^2}\Big|_{z=1}=1,\\
% 			b&=\Res[(z-1)f(z),1]=\frac{z-3}{z+1}\Big|_{z=1}=-1,\\
% 			c&=\Res[f(z),-1]=\frac{z-3}{(z-1)^2}\Big|_{z=-1}=-1.
% 		\end{align*}故 $\displaystyle f(z)=\frac1{z-1}-\frac1{(z-1)^2}-\frac1{z+1}$.
% 	}
% \end{solution}

% \section{留数在定积分的应用*}

% \subsection{正弦余弦的有理函数的积分}

% 本节中我们将对若干种在实变中难以计算的定积分和广义积分使用复变函数和留数的技巧进行计算.
% 本节内容不作考试要求.

% 考虑 $\displaystyle\int_0^{2\pi} R(\cos\theta,\sin\theta)\diff\theta$, 其中 $R$ 是一个有理函数.
% 令 $z=e^{i\theta}$, 则 $\diff z=iz\diff\theta$,
% \[\cos\theta=\half\left(z+\frac1z\right)=\frac{z^2+1}{2z},\quad
% \sin\theta=\frac1{2i}\left(z-\frac1z\right)=\frac{z^2-1}{2iz},\]
% \[\emph{\int_0^{2\pi} R(\cos\theta,\sin\theta)\diff\theta=\oint_{|z|=1}R\left(\frac{z^2+1}{2z},\frac{z^2-1}{2iz}\right)\frac1{iz}\diff z.}\]
% 由于被积函数是一个有理函数, 它的积分可以由 $|z|<1$ 内奇点留数得到.

% \begin{example}
% 	求 $\displaystyle\int_0^{2\pi}\frac{\sin^2\theta}{5-3\cos\theta}\diff\theta$.
% \end{example}

% \begin{solution}
% 	令 $z=e^{i\theta}$, 则 $\diff z=iz\diff\theta$,
% 	{
% 		\[\cos\theta=\half\left(z+\frac1z\right)=\frac{z^2+1}{2z},\qquad
% 		\sin\theta=\frac1{2i}\left(z-\frac1z\right)=\frac{z^2-1}{2iz},\]

% 		\begin{align*}
% 			\int_0^{2\pi}\frac{\sin^2\theta}{5-3\cos\theta}\diff\theta
% 			&=\oint_{|z|=1}\frac{(z^2-1)^2}{-4z^2}\cdot\frac1{5-3\frac{z^2+1}{2z}}\cdot\frac{\diff z}{iz}\\
% 			&=-\frac i6\oint_{|z|=1}\frac{(z^2-1)^2}{z^2(z-3)(z-\frac13)}\diff z.
% 		\end{align*}
% 	}
% \end{solution}

% \begin{solutionc}
% 	设 $f(z)=\dfrac{(z^2-1)^2}{z^2(z-3)(z-\frac13)}$,
% 	{则
% 		\[\Res[f(z),0]=\frac{10}3,\quad\Res[f(z),\frac13]=-\frac83,\]
% 	}

% 	{
% 		\[
% 			\int_0^{2\pi}\frac{\sin^2\theta}{5-3\cos\theta}\diff\theta
% 			=-\frac i6\cdot 2\pi i\Bigl[\Res[f(z),0]+\Res[f(z),\frac13]\Bigr]
% 			=\frac{2\pi}9.
% 		\]
% 	}
% \end{solutionc}

% \subsection{有理函数的广义积分}

% 考虑 $\displaystyle\int_{-\infty}^{+\infty}R(x)\diff x$, 其中 $R(x)$ 是一个有理函数, 分母比分子至少高 $2$ 次, 且分母没有实根.
% 我们先考虑 $\displaystyle\int_{-r}^rR(x)\diff x$.
% 设 $f(z)=R(z),C=C_r+[-r,r]$ 如下图所示, 使得上半平面内 $f(z)$ 的奇点均在 $C$ 内,
% 则
% \[2\pi i\sum_{\Im a>0}\Res[f(z),a]=\oint_Cf(z)\diff z=\int_{-r}^rR(x)\diff x+\int_{C_r}f(z)\diff z.\]

% \begin{center}
% 	\begin{tikzpicture}[framed]
% 		\draw[cstaxis] (-2,0)--(2,0);
% 		\draw[cstaxis] (0,-0.2)--(0,2);
% 		\draw[cstcurve,dcolora] (-1.5,0) arc(180:0:1.5);
% 		\draw[cstcurve,dcolora,cstarrowfrom] (-1.2,0.9) arc(135:130:1.5);
% 		\draw[cstcurve,dcolorb] (-1.5,0)--(1.5,0);
% 		\draw[cstcurve,dcolorb,cstarrowto] (-1.5,0)--(-0.5,0);
% 		\draw
% 			(-1.5,-0.3) node[dcolorb] {$-r$}
% 			(1.5,-0.3) node[dcolorb] {$r$}
% 			(1.3,1.2) node[dcolora] {$C_r$};
% 	\end{tikzpicture}
% \end{center}

% 由于 $P(x)$ 分母次数比分子至少高 $2$ 次,
% 当 $r\to+\infty$ 时,
% \[\abs{\int_{C_r}f(z)\diff z}\le \pi r\max_{|z|=r}|f(z)|
% =\pi \max_{|z|=r}|zf(z)|\to 0.\]
% 故
% \[\emph{\int_{-\infty}^{+\infty}R(x)\diff x=2\pi i\sum_{\Im a>0}\Res[R(z),a].}\]

% \begin{example}
% 	求 $\displaystyle\int_{-\infty}^{+\infty}\frac{\diff x}{(x^2+a^2)^3},a>0$.
% \end{example}

% \begin{solution}
% 	$f(z)=\dfrac1{(z^2+a^2)^3}$ 在上半平面内的奇点为 $ai$.

% 	{
% 		\begin{align*}
% 		\Res[f(z),ai]&=\frac1{2!}\lim_{z\to ai}\left[\frac1{(z+ai)^3}\right]''\\
% 		&=\half\lim_{z\to ai}\frac{12}{(z+ai)^5}=\frac{3}{16a^5i},
% 		\end{align*}故
% 		\[\int_{-\infty}^{+\infty}\frac{\diff x}{(x^2+a^2)^3}
% 	=2\pi i\Res[f(z),ai]=\frac{3\pi}{8a^5}.\]
% 	}
% \end{solution}

% \subsection{有理函数与三角函数之积的广义积分}

% \raisebox{2pt}{\resizet{0.85}{$\displaystyle\int_{-\infty}^{+\infty}$}}$R(x)\sin{\lambda x}\diff x$ 的积分\noexer}
% 考虑 $\displaystyle\int_{-\infty}^{+\infty}R(x)\cos{\lambda x}\diff x$,
% $\displaystyle\int_{-\infty}^{+\infty}R(x)\sin{\lambda x}\diff x$, 其中 $R(x)$ 是一个有理函数, 分母比分子至少高 $2$ 次, 且分母没有实根.
% 和前一种情形类似, 我们有
% \[\emph{\int_{-\infty}^{+\infty}R(x)e^{i\lambda x}\diff x
% =2\pi i\sum_{\Im a>0}\Res[R(z)e^{i\lambda z},a],}\]
% 因此所求积分分别为它的实部和虚部.


% \begin{example}
% 	求 $\displaystyle\int_{-\infty}^{+\infty}\frac{\cos x\diff x}{(x^2+a^2)^2}, a>0$.
% \end{example}

% \begin{solution}
% 	$f(z)=\dfrac{e^{iz}}{(z^2+a^2)^2}$ 在上半平面内的奇点为 $ai$,
% 	{
% 		\[\Res[f(z),ai]=\lim_{z\to ai}\left[\frac{e^{iz}}{(z+ai)^2}\right]'=-\frac{e^{-a}(a+1)i}{4a^3}.\]故
% 		$\displaystyle\qquad \int_{-\infty}^{+\infty}\frac{e^{ix}\diff x}{(x^2+a^2)^2}=2\pi i \Res[f(z),ai]=\frac{\pi e^{-a}(a+1)}{2a^3}$,
% 		\[\int_{-\infty}^{+\infty}\frac{\cos x\diff x}{(x^2+a^2)^2}=\frac{\pi e^{-a}(a+1)}{2a^3}.\]
% 	}
% \end{solution}

% \subsection{其它例子}

% 最后我们再来看一个例子.

% \begin{example}
% 	求积分 $I=\displaystyle\int_0^{+\infty}\frac{x^p}{x(x+1)}\diff x,0<p<1$.
% \end{example}

% \begin{solution}
% 	\[I=\int_0^{+\infty}\frac{x^p}{x(x+1)}\diff x\xto{\text{令}\ x=e^t}\int_{-\infty}^{+\infty}\frac{e^{pt}}{e^t+1}\diff t.\]
% 	{考虑 $f(z)=\dfrac{e^{pz}}{e^z+1}$ 在如下闭路 $C$ 上的积分.
% 	\begin{center}
% 		\begin{tikzpicture}[framed,scale=.8]
% 			\draw[cstaxis] (-3,0)--(3,0);
% 			\draw[cstaxis] (0,0)--(0,1.7);
% 			\draw[cstcurve,dcolorb] (-1.5,0) rectangle (1.5,1.2);
% 			\draw[cstcurve,dcolora] (-1.5,0)--(-1.5,1.2);
% 			\draw[cstcurve,dcolora] (1.5,0)--(1.5,1.2);
% 			\draw[cstcurve,dcolorb,cstarrowto] (-1.5,0)--(-0.5,0);
% 			\draw[cstcurve,dcolorb,cstarrowto] (0,1.2)--(-0.5,1.2);
% 			\draw[cstcurve,dcolora,cstarrowto] (1.5,0)--(1.5,0.9);
% 			\draw[cstcurve,dcolora,cstarrowto] (-1.5,1.2)--(-1.5,0.3);
% 			\draw
% 				(1.8,0.3) node {$R$}
% 				(-2,0.3) node {$-R$}
% 				(0.4,0.8) node {$2\pi i$}
% 				(1.2,0.4) node[dcolora] {$C_1$}
% 				(-1.1,0.5) node[dcolora] {$C_2$}
% 				(-0.4,0.8) node[dcolorb] {$l$};
% 		\end{tikzpicture}
% 	\end{center}}
% \end{solution}

% \begin{solutionc}
% 		由于 $l:z=t+2\pi i,-R\le t\le R$,
% 	{因此
% 		\[\int_l f(z)\diff z
% 		=\int_R^{-R}\frac{e^{2p\pi i}\cdot e^{pt}}{e^t+1}\diff t
% 		=-e^{2p\pi i}\int_{-R}^Rf(t)\diff t.\]由于 $C_1:z=R+it,0\le t\le 2\pi$,因此
% 		\[\abs{\int_{C_1}f(z)\diff z}\le \frac{e^{(p+1)R}}{e^R-1}\cdot 2\pi\to 0\quad(R\to+\infty).\]同理
% 		\[\abs{\int_{C_2}f(z)\diff z}\le \frac{e^{-(p+1)R}}{1-e^{-R}}\cdot 2\pi\to 0\quad(R\to+\infty).\]
% 	}
% \end{solutionc}

% \begin{solutionc}
% 	由于
% 	\[\Res[f(z),\pi i]
% 	=\frac{e^{pz}}{(e^z+1)'}\bigg|_{z=\pi i}=-e^{p\pi i},\]
% 	{因此
% 		\begin{align*}
% 		&\left(\int_{-R}^R+\int_l+\int_{C_1}+\int_{C_2}\right)f(z)\diff z\\
% 		=&\oint_Cf(z)\diff z=2\pi i\Res[f(z),\pi i]=-2\pi ie^{p\pi i},
% 		\end{align*}令 $R\to+\infty$,则
% 		\begin{align*}
% 		&(1-e^{2p\pi i})I=-2\pi ie^{p\pi i},\quad
% 		{I=\frac{2\pi i}{e^{p\pi i}-e^{-p\pi i}}=\frac{\pi}{\sin p\pi}.}
% 		\end{align*}
% 	}
% \end{solutionc}

% \chapter{积分变换}

% \subsection{积分变换的引入}

% 在学习指数和对数的时候, 我们了解到利用对数可以将乘除、幂次转化为加减、乘除.
% \begin{example}
% 	计算 $12345\times 67890$.
% \end{example}
% \begin{solution}
% 		通过查对数表得到
% 		\[\ln 12345\approx 9.4210,\qquad\ln 67890\approx 11.1256.\]%
% 	{将二者相加并通过反查对数表得到原值
% 		\[12345\times 67890\approx \exp(20.5466)\approx 8.3806\times 10^8.\]
% 	}
% \end{solution}

% 而对于函数而言, 我们常常要解函数的微积分方程.
% \begin{example}
% 	解微分方程
% 	\[\begin{cases}
% 		y''+y=t,&\\
% 		y(0)=y'(0)=0.&
% 	\end{cases}\]
% \end{example}
% \begin{solution*}
% 		我们希望能找到一种函数\emph{变换 $\msl$}, 使得它可以把函数的微分和积分变成代数运算, 计算之后通过\emph{反变换 $\msl^{-1}$} 求得原来的解.

% 	{这个变换最常见的就是我们将要介绍的\emph{傅里叶变换}和\emph{拉普拉斯变换}.
% 	}
% \end{solution*}

% \section{傅里叶变换}

% \subsection{傅里叶级数}

% 为了引入傅里叶变换, 我们回顾下傅里叶级数展开.

% 设 $f(t)$ 是定义在 $(-\infty,+\infty)$ 上周期为 $T$ 的可积实变函数.
% 我们知道 $\cos n\omega t$ 和 $\sin n\omega t$ 周期也是 $T$, 其中 $\omega=\dfrac{2\pi}T$.
% 如果 $f(t)$ 在 $\left[-\dfrac T2,\dfrac T2\right]$ 上满足\emph{狄利克雷条件}:
% \begin{itemize}
% 	\item 间断点只有有限多个, 且均为第一类间断点;
% 	\item 只有有限个极值点,
% \end{itemize}
% 则我们有\emph{傅里叶级数}展开:
% \[f(t)=\frac{a_0}2+\sum_{n=1}^\infty \left(a_n\cos n\omega t+b_n \sin n\omega t\right).\]
% 当 $t$ 是间断点时, 傅里叶级数的左侧需改为 $\dfrac{f(t+)+f(t-)}2$.

% 我们来将其改写为复指数形式.
% 物理中为了与电流 $i$ 区分, 通常用 $j$ 来表示虚数单位.
% 由
% \[\cos x=\frac{e^{jx}+e^{-jx}}2,\quad \sin x=\frac{e^{jx}-e^{-jx}}{2j}\]
% 可知 $f(t)$ 的傅里叶级数可以表示为函数 $e^{jn\omega t}$ 的线性组合.
% 设 $f(t)=\suml_{n=-\infty}^{+\infty} c_n e^{jn\omega t}$, 则
% \[c_n=\frac 1T \int_{-\frac T2}^{\frac T2} f(t)e^{-jn\omega t} \diff t.\]
% 于是我们得到周期函数\emph{傅里叶级数的复指数形式}:
% \[f(t)=\frac 1T\sum_{n=-\infty}^{+\infty}\left[\int_{-\frac T2}^{\frac T2}f(\tau)e^{-jn\omega\tau} \diff\tau\right] e^{jn\omega t}.\]

% 对于一般的函数 $f(t)$, 它未必是周期的.
% 我们考虑它在 $\left[-\dfrac T2,\dfrac T2\right]$ 上的限制, 并向两边扩展成一个周期函数 $f_T(t)$.
% 设
% \[\omega_n=n\omega,\quad \Delta\omega_n=\omega_n-\omega_{n-1}=\omega,\]
% 则
% \begin{align*}
% 	f(t)&=\lim_{T\to +\infty}f_T(t)\\
% 	&{=\lim_{T\to+\infty} \frac 1T \sum_{n=-\infty}^{+\infty} \left[\int_{-\frac T2}^{\frac T2}f(\tau)e^{-j\omega_n\tau}\diff\tau\right] e^{j\omega_n t}}\\
% 	&{=\frac1{2\pi}\lim_{\Delta\omega_n\to 0}\sum_{n=-\infty}^{+\infty}\emph{\left[\int_{-\frac T2}^{\frac T2}f(\tau)e^{-j\omega_n\tau} \diff \tau\right] e^{j\omega_n t}}\Delta\omega_n}\\
% 	&{=\frac1{2\pi}\int_{-\infty}^{+\infty}\emph{\left[\int_{-\infty}^{+\infty}f(\tau) e^{-j\omega\tau} \diff \tau\right]e^{j\omega t}}\diff\omega.}
% \end{align*}

% \subsection{傅里叶积分与傅里叶变换}

% \begin{block}{傅里叶积分定理}
% 		设函数 $f(t)$ 满足
% 		\begin{itemize}
% 			\item 在 $(-\infty,+\infty)$ 上\emph{绝对可积};
% 			\item 在任一有限区间上满足狄利克雷条件.
% 		\end{itemize}
% 	{那么
% 		\[\emph{f(t)=\frac1{2\pi} \int_{-\infty}^{+\infty}F(\omega) e^{j\omega t} \diff\omega,\qquad
% 		F(\omega)=\int_{-\infty}^{+\infty}f(t) e^{-j\omega t} \diff t.}\]对于 $f(t)$ 的间断点左边需要改成 $\frac{f(t+)+f(t-)}2$.
% 	}
% \end{block}
% \begin{center}
% 	\begin{tikzpicture}[node distance=100pt]
% 		\node[cstnodeg](a){原象函数 $f(t)$};
% 		\node[cstnodeg,right=of a](b){象函数 $F(\omega)$};
% 		\draw[cstnarrow, dcolora] (a.9) -- node[above]{傅里叶变换 $\msf$} (b.170);
% 		\draw[cstnarrow, dcolorc] (b.190) -- node[below]{傅里叶逆变换 $\msf^{-1}$} (a.-9);
% 	\end{tikzpicture}
% \end{center}

% 傅里叶积分公式有一些变化形式.
% 例如:
% \begin{align*}
% 	&\peq f(t)=\frac1{2\pi} \int_{-\infty}^{+\infty}\left[\int_{-\infty}^{+\infty}f(\tau) e^{-j\omega\tau} \diff\tau\right] e^{j\omega t} \diff\omega\\
% 	&{=\frac1{2\pi} \int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}f(\tau) e^{j\omega(t-\tau)}\diff\tau \diff\omega}\\
% 	&{=\frac1{2\pi} \int_{-\infty}^{+\infty}\Bigl[
% 		\resizebox{!}{5mm}{
% 			$\displaystyle\underbrace{\int_{-\infty}^{+\infty}f(\tau)\cos \omega(t-\tau) \diff\tau}_{\text{\small$\omega$ 的偶函数}}
% 			+j\underbrace{\int_{-\infty}^{+\infty}f(\tau)\sin \omega(t-\tau) \diff\tau}_{\text{\small$\omega$ 的奇函数}}$
% 		}\Bigr] \diff\omega}\\
% 	&{\emph{=\frac1\pi\int_0^{+\infty}\left[\int_{-\infty}^{+\infty}f(\tau) \cos \omega(t-\tau)\diff\tau\right]\diff\omega.}}
% \end{align*}
% 此即\emph{傅里叶积分公式的三角形式}.

% 对上式再次展开得到:
% \[f(t)=\frac1\pi\int_0^{+\infty}\left[\int_{-\infty}^{+\infty}f(\tau)(\cos\omega t\cos\omega\tau+\sin\omega t\sin \omega\tau)\diff\tau\right]\diff\omega.\]

% 若 $f(t)$ 是奇函数, $f(\tau)\cos\omega\tau$ 是 $\tau$ 的奇函数, $f(\tau)\sin \omega\tau$ 是 $\tau$ 的偶函数.
% 从而得到\emph{傅里叶正弦积分公式}:
% \[\emph{f(t)=\frac2\pi\int_0^{+\infty}\left[\int_0^{+\infty}f(\tau)\sin \omega\tau\diff\tau\right]\sin\omega t\diff\omega.}\]

% 类似地, 若 $f(t)$ 是偶函数, 有\emph{傅里叶余弦积分公式}:
% \[\emph{f(t)=\frac2\pi\int_0^{+\infty}\left[\int_0^{+\infty}f(\tau)\cos\omega\tau\diff\tau\right]\cos\omega t\diff\omega.}\]

% \begin{example}
% 	求函数 $f(t)=
% 		\begin{cases}
% 			1, & |t|\le 1,\\
% 			0, & |t|>1
% 		\end{cases}$
% 	的傅里叶变换.
% \end{example}

% \begin{solution}

% 	\begin{align*}
% 		F(\omega)&=\msf[f(t)]=\int_{-\infty}^{+\infty}f(t)e^{-j\omega t}\diff t\\
% 		&{=\int_{-1}^1(\cos\omega t-j\sin\omega t)\diff t}{=\frac{2\sin \omega}{\omega}.}
% 	\end{align*}
% \end{solution}

% 由傅里叶积分公式
% \begin{align*}
% 	f(t)&=\msf^{-1}[F(\omega)]=\frac1{2\pi}\int_{-\infty}^{+\infty}F(\omega)e^{j\omega t}\diff\omega\\
% 	&{=\frac1{2\pi}\int_{-\infty}^{+\infty}\frac{2\sin\omega}{\omega}(\cos\omega t+j\sin\omega t)\diff \omega}\\
% 	&{=\frac2\pi\int_0^{+\infty}\frac{\sin\omega\cos\omega t}{\omega}\diff \omega.}
% \end{align*}
% 当 $t=\pm1$ 时, 左侧应替换为 $\frac{f(t+)+f(t-)}2=\half $.
% 由此可得
% \[\int_0^{+\infty}\frac{\sin \omega\cos\omega t}\omega\diff\omega=\begin{cases}
% 	\pi/2,&|t|<1,\\
% 	\pi/4,&|t|=1,\\
% 	0,&|t|>1.
% \end{cases}\]
% 特别地, 可以得到狄利克雷积分
% $\displaystyle\int_0^{+\infty}\frac{\sin\omega}\omega\diff\omega=\frac\pi2$.

% \begin{example}
% 	求函数 $f(t)=\dfrac{\sin t}{t}$ 的傅里叶变换.
% \end{example}

% \begin{solution}
% 	根据前面的例子可知

% 	\begin{align*}
% 		F(\omega)&=\msf[f(t)]=\int_{-\infty}^{+\infty}f(t)e^{-j\omega t}\diff t\\
% 		&{=2\int_0^{+\infty}\frac{\sin t\cos\omega t}{t}\diff t}
% 		{=\begin{cases}
% 			\pi,&|\omega|<1,\\
% 			\pi/2,&|\omega|=1,\\
% 			0,&|\omega|>1.
% 			\end{cases}}
% 	\end{align*}
% \end{solution}

% \begin{example}
% 	求函数 $f(t)=
% 		\begin{cases}
% 			1,&t\in(0,1),\\
% 			-1,&t\in(-1,0),\\
% 			0,&\text{其它情形}
% 		\end{cases}$
% 	的傅里叶变换.
% \end{example}

% \begin{solution}

% 	\begin{align*}
% 		F(\omega)&=\msf[f(t)]=\int_{-\infty}^{+\infty}f(t)e^{-j\omega t}\diff t\\
% 		&{=\left(\int_0^1-\int_{-1}^0\right)(\cos\omega t-j\sin\omega t)\diff t}
% 		{=-\frac{2j(1-\cos\omega)}\omega.}&{}
% 	\end{align*}
% \end{solution}

% 类似可得
% $\displaystyle\int_0^{+\infty}\frac{(1-\cos\omega)\sin\omega t}\omega\diff\omega=
% 	\begin{cases}
% 		\pi/2,&0<t<1,\\
% 		\pi/4,&t=1,\\
% 		0,&t>1.
% 	\end{cases}$

% \begin{example}
% 	求\emph{指数衰减函数} $f(t)=
% 		\begin{cases}
% 			0,&t<0,\\
% 			e^{-\beta t},&t\ge 0
% 		\end{cases}$ 的傅里叶变换, $\beta>0$.
% \end{example}

% \begin{solution}

% 	\begin{align*}
% 		F(\omega)&=\msf[f(t)]=\int_{-\infty}^{+\infty}f(t)e^{-j\omega t}\diff t\\
% 		&{=\int_0^{+\infty}e^{-\beta t}e^{-j\omega t}\diff t}
% 		{=\int_0^{+\infty}e^{-(\beta+j\omega)t}\diff t}
% 		{\emph{=\frac1{\beta+j\omega}}.}&{}
% 	\end{align*}
% \end{solution}

% 类似可得
% $\displaystyle\int_0^{+\infty}\frac{\beta\cos\omega t+\omega\sin\omega t}{\beta^2+\omega^2}\diff\omega=
% 	\begin{cases}
% 		0,&t<0,\\
% 		\pi/2,&t=0,\\
% 		\pi e^{-\beta t},&t>0.
% 	\end{cases}$

% \begin{example}
% 	求\emph{钟形脉冲函数} $f(t)=e^{-\beta t^2}$ 的傅里叶变换和积分表达式, $\beta>0$.
% \end{example}

% \begin{solution}

% 	\begin{align*}
% 		F(\omega)&=\msf[f(t)]=\int_{-\infty}^{+\infty}f(t)e^{-j\omega t}\diff t\\
% 		&{=\int_{-\infty}^{+\infty}e^{-\beta t^2}e^{-j\omega t}\diff t}\\
% 		&{=e^{-\frac{\omega^2}{4\beta}}\int_{-\infty}^{+\infty}\exp\left[-\beta\left(t+\frac{j\omega}{2\beta}\right)^2\right]\diff t}
% 		{\emph{=\sqrt{\frac\pi\beta}e^{-\frac{\omega^2}{4\beta}}.}}&{}
% 	\end{align*}
% \end{solution}

% 类似可得
% $\displaystyle\int_0^{+\infty}e^{-\frac{\omega^2}{4\beta}}\cos\omega t\diff\omega=\sqrt{\pi\beta}e^{-\beta t^2}$.

% \subsection{狄拉克 \texorpdfstring{$\delta$}{δ} 函数}

% 傅里叶变换存在的条件是比较苛刻的.
% 例如常值函数 $f(t)=1$ 在 $(-\infty,+\infty)$ 上不是可积的, 所以它没有傅里叶变换, 这很影响我们使用傅里叶变换.
% 为此我们引入广义函数的概念.

% 设 $\msc$ 是一些函数形成的线性空间, 例如全体绝对可积函数, 或者全体光滑函数之类的. 
% 从一个函数 $\lambda(t)$ 出发, 可以定义一个线性映射 $\msc\to \BR$:
% \[\pair{\lambda,f}:=\int_{-\infty}^{+\infty}\lambda(t)f(t)\diff t.\]
% 这个线性映射基本上确定了 $\lambda(t)$ 本身(至多可数个点处不同).

% \emph{广义函数}就是指一个线性映射 $\msc\to \BR$.
% 为了和普通函数类比, 通常也将广义函数表为上述积分形式(并不是真的积分):
% \[\int_{-\infty}^{+\infty}\lambda(t)f(t)\diff t.\]
% 这里的 $\lambda(t)$ 并不表示一个真正的函数.

% \begin{definition}
% 	\emph{$\delta$ 函数}是指广义函数
% 	\[\pair{\delta,f}=\int_{-\infty}^{+\infty}\delta(t)f(t)\diff t=f(0).\]
% \end{definition}


% \begin{tikzpicture}[overlay]\begin{tikzpicture}[framed,xshift=-190mm,yshift=10mm]
% 	\draw[cstaxis](8.2,0)--(9.8,0);
% 	\draw[cstaxis](9,-0.6)--(9,2);
% 	\draw
% 		(9.8,-0.25) node {$t$}
% 		(8.7,1.6) node {$1$}
% 		(9.5,1.6) node[dcolora] {$\delta(t)$}
% 		(8.8,-0.2) node {$O$};
% 	\draw[dcolora,cstcurve,cstarrowto](9,0)--(9,1.5);
% \end{tikzpicture}\end{tikzpicture}


% 设 $\delta_\varepsilon(t)=\begin{cases}
% 1/\varepsilon,&0\le t\le \varepsilon,\\
% 0,&\text{其它情形,}
% \end{cases}$
% 则对于连续函数 $f(t)$,
% \[\pair{\delta_\varepsilon,f}=\frac1\varepsilon\int_0^\varepsilon f(t)\diff t=f(\xi),\quad \xi\in(0,\varepsilon).\]
% 当 $\varepsilon\to0$ 时, 右侧就趋于 $f(0)$.
% 因此 $\delta$ 可以看成 $\delta_\varepsilon$ 的某种极限.
% 基于此, 我们通常用长度为 $1$ 的有向线段来表示它.

% 对于广义函数 $\lambda$, 我们可以形式地定义 $\lambda(at),\lambda'$:
% \[\int_{-\infty}^{+\infty}\lambda(at)f(t)\diff t
% =\int_{-\infty}^{+\infty}\lambda(t)\cdot\frac1{|a|}f\bigl(\frac ta\bigr)\diff t,\]
% \[\int_{-\infty}^{+\infty}\lambda'(t)f(t)\diff t
% =-\int_{-\infty}^{+\infty}\lambda(t)f'(t)\diff t.\]
% 由此可知
% \begin{itemize}
% 	\item $\pair{\delta^{(n)},f}=(-1)^nf^{(n)}(0)$, 其中 $f(t)$ 是光滑函数.
% 	\item $\delta(at)=\dfrac1{|a|}\delta(t)$. 特别地 $\delta(t)=\delta(-t)$.
% 	\item $u'(t)=\delta(t)$, 其中 $u(t)=\begin{cases}1,&t\ge0,\\0,&t<0\end{cases}$ 是\emph{单位阶跃函数}.
% \end{itemize}

% 根据 $\delta$ 函数的定义可知
% \[\msf[\delta(t)]=\int_{-\infty}^{+\infty}\delta(t)e^{-j\omega t}\diff t=1.\]
% 同理可得其傅里叶逆变换.
% 因此我们得到:
% \begin{alertblock@}
% 	\[\msf[\delta(t)]=1,\qquad
% 	\msf^{-1}[\delta(\omega)]=\dfrac1{2\pi}.\]
% \end{alertblock@}

% \begin{example}
% 	证明 \emph{$\msf[u(t)]=\dfrac1{j\omega}+\pi\delta(\omega)$}.
% \end{example}

% \begin{proof}
% 		\[\msf^{-1}\left[\frac1{j\omega}\right]
% 		=\frac1{2\pi}\int_{-\infty}^{+\infty}\frac{e^{j\omega t}}{j\omega} \diff\omega
% 		=\frac1\pi\int_0^{+\infty}\frac{\sin\omega t}{\omega} \diff\omega.\]
% 	{由
% 		$\displaystyle\int_0^{+\infty}\frac{\sin\omega}\omega \diff\omega=\dfrac\pi2$
% 		可知
% 		$\displaystyle\int_0^{+\infty}\frac{\sin\omega t}\omega \diff\omega=\frac\pi2\sgn(t)$.故
% 		\[\msf^{-1} \left[\frac1{j\omega}+\pi\delta(\omega)\right]
% 		=\half\sgn(t)+\half =u(t)\quad (t\neq 0).\qedhere\]
% 	}
% \end{proof}

% \subsection{傅里叶变换的性质}

% 我们不可能也没必要每次都对需要变换的函数从定义出发计算傅里叶变换.
% 通过研究傅里叶变换的性质, 结合常见函数的傅里叶变换, 我们可以得到很多情形的傅里叶变换.

% \begin{block}{线性性质}
% 	\[\msf[\alpha f+\beta g]=\alpha F+\beta G,\quad
% 	\msf^{-1}[\alpha F+\beta G]=\alpha f+\beta g.\]
% \end{block}

% \begin{block}{位移性质}
% 	\[\msf[f(t-t_0)]=e^{-j\omega t_0}F(\omega),\quad
% 	\msf^{-1}[F(\omega-\omega_0)]=e^{j\omega_0 t}f(t).\]
% \end{block}

% \begin{proof}
% 	\begin{align*}
% 		\msf[f(t-t_0)]&=\int_{-\infty}^{+\infty}f(t-t_0)e^{-j\omega t}\diff t\\
% 		&=\int_{-\infty}^{+\infty}f(t)e^{-j\omega (t+t_0)}\diff t=e^{-j\omega t_0}F(\omega).
% 	\end{align*}
% 	{逆变换情形类似可得.\qedhere}
% \end{proof}

% 由此可得
% \[\msf[\delta(t-t_0)]=e^{-j\omega t_0},\quad
% \msf^{-1}[\delta(\omega-\omega_0)]=\dfrac1{2\pi}e^{j\omega_0 t}.\]

% \begin{block}{微分性质}
% 	\[\msf[f'(t)]=j\omega F(\omega),\quad
% 	\msf^{-1}[F'(\omega)]=-jtf(t),\]

% 	\[\msf[f^{(k)}(t)]=(j\omega)^k F(\omega),\quad
% 	\msf^{-1}[F^{(k)}(\omega)]=(-jt)^kf(t).\]
% 	这里, 被变换的函数要求在 $\infty$ 处趋于 $0$.
% \end{block}

% \begin{proof}
% 	\begin{align*}
% 		\msf[f']&=\int_{-\infty}^{+\infty}f'(t)e^{-j\omega t}\diff t\\
% 		&=-\int_{-\infty}^{+\infty}f(t)(e^{-j\omega t})'\diff t=j\omega F(\omega)
% 	\end{align*}
% 	{逆变换情形类似可得. 一般的 $k$ 归纳可得.\qedhere}
% \end{proof}

% 由微分性质可得
% \begin{block}{乘多项式性质}
% 	\[\msf[tf(t)]=jF'(\omega),\quad
% 	\msf^{-1}[\omega F(\omega)]=-jf'(t),\]
% 	\[\msf[t^kf(t)]=j^kF^{(k)}(\omega),\quad
% 	\msf^{-1}[\omega^kF(\omega)]=(-j)^kf^{(k)}(t).\]
% \end{block}

% \begin{block}{积分性质}
% 	\[\msf\left[\int_{-\infty}^t f(\tau)\diff\tau\right]=\frac1{j\omega}F(\omega).\]
% \end{block}

% 由变量替换易得
% \begin{block}{相似性质}
% 	\[\msf[f(at)]=\frac1{|a|}F\left(\frac\omega a\right),\quad
% 	\msf^{-1}[F(a\omega)]=\frac1{|a|}f\left(\frac t a\right).\]
% \end{block}

% \begin{example}
% 	求 $\msf[t^k e^{-\beta t}u(t)],\beta>0$.
% \end{example}

% \begin{solution}
% 		由于
% 		\[\msf[e^{-\beta t}u(t)]=\frac{1}{\beta+j\omega},\]
% 	{因此
% 		\begin{align*}
% 			\msf[t^ke^{-\beta t}u(t)]&=j^k\left(\frac1{\beta+j\omega}\right)^{(k)}
% 			=\frac{k!}{(\beta+j\omega)^{k+1}}.
% 		\end{align*}
% 	}
% \end{solution}

% \begin{example}
% 	求 $\sin{\omega_0 t}$ 的傅里叶变换.
% \end{example}

% \begin{solution}
% 		由于 $\msf[1]=2\pi\delta(\omega)$,
% 	{因此 $\msf[e^{j\omega_0t}]=2\pi\delta(\omega-\omega_0)$,
% 	}
% 	{\begin{align*}
% 			\msf[\sin{\omega_0 t}]&=\frac1{2j}\left[\msf[e^{j\omega_0t}]-\msf[e^{-j\omega_0t}]\right]&\\
% 			&{=\frac1{2j}[2\pi\delta(\omega-\omega_0)-2\pi\delta(\omega+\omega_0)]}&\\
% 			&{=j\pi[\delta(\omega+\omega_0)-\delta(\omega-\omega_0)].}
% 		\end{align*}
% 	}
% \end{solution}

% \begin{exercise}
% 	$\msf[\cos{\omega_0 t}]=$\fillblank[5cm][1mm]{{$\pi[\delta(\omega+\omega_0)+\delta(\omega-\omega_0)]$}}.
% \end{exercise}

% \begin{alertblock}{常见傅里叶变换汇总 I}
% 	\[\msf[\delta(t)]=1,\quad \msf[\delta(t-t_0)]=e^{-j\omega t_0},\]
% 	\[\msf[1]=2\pi\delta(\omega),\quad \msf[e^{j\omega_0 t}]=2\pi\delta(\omega-\omega_0).\]
% 	\begin{align*}
% 	\msf[\sin \omega_0t]&=j\pi[\delta(\omega+\omega_0)-\delta(\omega-\omega_0)],\\
% 	\msf[\cos{\omega_0 t}]&=\pi[\delta(\omega+\omega_0)+\delta(\omega-\omega_0)].
% 	\end{align*}
% \end{alertblock}

% \begin{block}{常见傅里叶变换汇总 II}
% 	\[\msf[u(t)e^{-\beta t}]=\dfrac1{\beta+j\omega},\quad
% 	\msf[e^{-\beta t^2}]=\sqrt{\dfrac\pi\beta}e^{-\omega^2/(4\beta)},\]
% 	\[\msf[u(t)]=\dfrac1{j\omega}+\pi\delta(\omega).\]
% \end{block}

% \subsection{卷积*}

% \begin{definition}
% 	$f_1(t),f_2(t)$ 的\emph{卷积}是指
% 	\[\emph{(f_1\ast f_2)(t)=\int_{-\infty}^{+\infty} f_1(\tau)f_2(t-\tau)\diff \tau.}\]
% \end{definition}

% 容易验证卷积满足如下性质:
% \begin{itemize}
% 	\item $f_1\ast f_2=f_2\ast f_1,\ (f_1\ast f_2)\ast f_3=f_1\ast(f_2\ast f_3)$;
% 	\item $f_1\ast(f_2+f_3)=f_1\ast f_2+f_1\ast f_3$;
% 	\item $f\ast\delta=f$;
% 	\item $(f_1\ast f_2)'=f_1'\ast f_2=f_1\ast f_2'$.
% \end{itemize}

% \begin{example}
% 	设 $f_1(t)=u(t),f_2(t)=e^{-t}u(t)$. 求 $f_1\ast f_2$.
% \end{example}

% \begin{solution}
% 		\[(f_1\ast f_2)(t)=\int_{-\infty}^{+\infty} f_2(\tau)f_1(t-\tau)\diff \tau=\int_0^{+\infty} e^{-\tau}u(t-\tau)\diff \tau.\]
% 	{当 $t<0$ 时, $(f_1\ast f_2)(t)=0$.当 $t\ge0$ 时, 
% 		\[(f_1\ast f_2)(t)=\int_0^t e^{-\tau}\diff \tau=1-e^{-t}.\]故 $(f_1\ast f_2)(t)=(1-e^{-t})u(t)$.
% 	}
% \end{solution}

% \begin{block}{卷积定理}
% \[\msf[f_1\ast f_2]=F_1\cdot F_2,\quad
% \msf^{-1}[F_1\ast F_2]=\frac1{2\pi}f_1\cdot f_2.\]
% \end{block}

% \begin{proof}

% 	\begin{align*}
% 		\msf[f_1\ast f_2]&=\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}f_1(\tau)f_2(t-\tau)\diff \tau \cdot e^{-j\omega t}\diff t\\
% 		&{=\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}f_1(\tau)e^{-j\omega \tau}\cdot f_2(t-\tau)e^{-j\omega (t-\tau)}\diff t\diff \tau}\\
% 		&{=\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}f_1(\tau)e^{-j\omega \tau}\cdot f_2(t)e^{-j\omega t}\diff t\diff \tau}\\
% 		&{=\int_{-\infty}^{+\infty}f_1(\tau)e^{-j\omega \tau}\diff\tau\int_{-\infty}^{+\infty}f_2(t)e^{-j\omega t}\diff t}\\
% 		&{=\msf[f_1]\msf[f_2].\qedhere}
% 	\end{align*}
% \end{proof}

% \begin{example}
% 	求 $\displaystyle	I=\int_{-\infty}^{+\infty}\frac{\sin \omega}{\omega}\cdot \frac{\sin (\omega/3)}{\omega/3}\diff\omega$.
% \end{example}

% \begin{solution}
% 		设 $F(\omega)=\dfrac{\sin\omega}{\omega},G(\omega)=\dfrac{\sin(\omega/3)}{\omega/3}$,%
% 	{则
% 		\[\msf^{-1}[FG]=\frac1{2\pi}\int_{-\infty}^{+\infty}F(\omega)G(\omega)e^{j\omega t}\diff\omega,\]
% 		\[\msf^{-1}[FG](0)=\frac1{2\pi}\int_{-\infty}^{+\infty}F(\omega)G(\omega)\diff\omega=\frac1{2\pi}I.\]
% 	}
% \end{solution}

% \begin{solutionc}
% 		我们之前计算过
% 		\[\msf^{-1}[F(\omega)]=f(t)=\begin{cases}
% 			1/2, & |t|<1,\\
% 			1/4, & |t|=1,\\
% 			0, & |t|>1.
% 		\end{cases}\]
% 	{所以 $\msf^{-1}[G(\omega)]=g(t)=3f(3t)$,
% 		\begin{align*}
% 			\msf^{-1}[FG](0)&=(f\ast g)(0)\\
% 			&=\int_{-\infty}^{+\infty}f(-t)g(t)\diff t=\half\int_{-1}^1 g(t)\diff t=\half ,
% 		\end{align*}故 $I=2\pi\msf^{-1}[FG](0)=\pi$.}
% \end{solutionc}

% \subsection{傅里叶变换的应用*}

% \begin{center}
% 	\begin{tikzpicture}[node distance=40pt]
% 		\node[cstnodeg] (a){微分方程或积分方程};
% 		\node[cstnodeb,right=110pt of a] (b){象函数的代数方程};
% 		\node[cstnodeg,below=of a] (c){原象函数(方程的解)};
% 		\node[cstnodeb,below=of b] (d){象函数};
% 		\draw[cstnarrow,dcolorb] (a)--node[above]{傅里叶变换 $\msf$}(b);
% 		\draw[cstnarrow,dcolorb] (d)--node[below]{傅里叶逆变换 $\msf^{-1}$}(c);
% 		\draw[cstnarrow,dcolorb] (b)--(d);
% 		\draw[cstnarrow,dcolorc] (a)--(c);
% 	\end{tikzpicture}
% \end{center}


% \begin{example}
% 	解方程 $y'(t)-\displaystyle\int_{-\infty}^t y(\tau)\diff \tau=2\delta(t)$.
% \end{example}

% \begin{solution}
% 		设 $\msf[y]=Y$.
% 	{两边同时作傅里叶变换得到
% 		\[j\omega Y(\omega)-\frac1{j\omega}Y(\omega)=2,\]
% 		\[Y(\omega)=-\frac{2j\omega}{1+\omega^2}=\frac1{1+j\omega}-\frac1{1-j\omega},\]
% 		\begin{align*}
% 			y(t)=\msf^{-1}\left[\frac1{1+j\omega}-\frac1{1-j\omega}\right]
% 			&{=\begin{cases}
% 			0-e^t=-e^t,&t<0,\\
% 			0,&t=0,\\
% 			e^{-t}-0=e^{-t},&t>0.
% 			\end{cases}}
% 		\end{align*}
% 	}
% \end{solution}

% \begin{example}
% 	解方程 $y''(t)-y(t)=0$.
% \end{example}

% \begin{solution}
% 		设 $\msf[y]=Y$,
% 	{则
% 		\[\msf[y''(t)-y(t)]=[(j\omega)^2-1]Y(\omega)=0,\]
% 	}

% 	{\[Y(\omega)=0,\quad y(t)=\msf^{-1}[Y(\omega)]=0.\]}
% \end{solution}

% 显然这是不对的, 该方程的解应该是 $y(t)=C_1e^t+C_2e^{-t}$.

% 原因在于使用傅里叶变换要求函数是绝对可积的, 而 $e^t,e^{-t}$ 并不满足该条件.
% 我们需要一个对函数限制更少的积分变换来解决此类方程, 例如拉普拉斯变换.

% \section{拉普拉斯变换}

% \subsection{拉普拉斯变换}

% 傅里叶变换对函数要求过高, 这使得在很多时候无法应用它, 或者要引入复杂的广义函数.
% 对于一般的 $\varphi(t)$, 为了让它绝对可积, 我们考虑
% \[\varphi(t)u(t)e^{-\beta t},\quad\beta>0.\]
% 它的傅里叶变换为
% \[\msf[\varphi(t)u(t)e^{-\beta t}]=\int_0^{+\infty}\varphi(t)e^{-(\beta+j\omega)t}\diff t=\int_0^{+\infty}\varphi(t)e^{-st}\diff t,\]
% 其中 $s=\beta+j\omega$.
% 这样的积分在我们遇到的多数情形都是存在的, 只要选择充分大的 $\beta=\Re s$.
% 我们称之为 $\varphi(t)$ 的\emph{拉普拉斯变换 $\msl[\varphi]$}.

% \begin{block}{拉普拉斯变换存在定理}
% 		若定义在 $[0,+\infty)$ 上的函数 $f(t)$ 满足
% 		\begin{itemize}
% 			\item $f(t)$ 在任一有限区间上至多只有有限多间断点;
% 			\item 存在 $M,c$ 使得 $|f(t)|\le Me^{ct}$,
% 		\end{itemize}{则 $F(s)=\msl[f(t)]$ 在 $\Re s>c$ 上存在且为解析函数.
% 	}
% \end{block}

% \begin{center}
% 	\begin{tikzpicture}[node distance=118pt]
% 		\node[cstnodeg,align=center] (a){原象函数\\$f(t)\vphantom{\displaystyle\int}$};
% 		\node[cstnodeg,align=center, right=of a](b){象函数\\\emph{$F(s)=\displaystyle\int_0^{+\infty}f(t)e^{-st}\diff t$}};
% 		\draw[cstnarrow, dcolora] (a.17) -- node[above]{拉普拉斯变换 $\msl$} (b.172);
% 		\draw[cstnarrow, dcolorc] (b.188) -- node[below]{拉普拉斯逆变换 $\msl^{-1}$} (a.-17);
% 	\end{tikzpicture}
% \end{center}

% 虽然我们限定了函数只定义在 $t\ge 0$ 处, 但很多时候这不影响我们使用.
% 这是因为在物理学中, 很多时候我们只考虑系统自某个时间点开始之后的行为.

% \begin{example}
% 	求 $\msl[e^{kt}]$.
% \end{example}

% \begin{solution}
% 		\begin{align*}
% 			\msl[e^{kt}]&=\int_0^{+\infty}e^{kt}e^{-st}\diff t\\
% 			&{=\int_0^{+\infty}e^{-(s-k)t}\diff t
% 			=-\frac1{s-k}e^{-(s-k)t}\big|_0^{+\infty}}\\
% 			&{=\frac1{s-k}, \quad\Re s>\Re k.}
% 		\end{align*}
% 		{即 \emph{$\msl[e^{kt}]=\dfrac1{s-k}$}.}
% 		{特别地 \emph{$\msl[1]=\dfrac1s$}.}
% \end{solution}

% \begin{example}
% 	求 $\msl[t^m]$, 其中 $m$ 是正整数.
% \end{example}

% \begin{solution}
% 	由分部积分可知
% 	\begin{align*}
% 		\msl[t^m]&=\int_0^{+\infty}t^me^{-st}\diff t\\
% 		&=-\frac{t^me^{-st}}s\Big|_0^{+\infty}+\int_0^{+\infty}\frac{e^{-st}}s\cdot mt^{m-1}\diff t\\
% 		&=\frac ms\msl[t^{m-1}].
% 	\end{align*}
% 	{归纳可知
% 		$\displaystyle\msl[t^m]=\frac{m!}{s^m}\msl[1]=\emph{\frac{m!}{s^{m+1}}}$.
% 	}
% \end{solution}

% \subsection{拉普拉斯变换的性质}

% 和傅里叶变换类似, 拉普拉斯变换也有着各种性质. 我们不加证明地列出它们.

% \begin{block}{拉普拉斯变换的性质}
% 	\begin{itemize}
% 		\item (线性性质) $\msl[\alpha f+\beta g]=\alpha F+\beta G, \msl^{-1}[\alpha F+\beta G]=\alpha f+\beta g$.
% 		\item (积分性质) $\displaystyle\msl\left[\int_0^t f(\tau)\diff\tau\right]=\frac 1s F(s)$.
% 		\item (乘多项式性质) $\msl[tf(t)]=-F'(s),\quad\msl[t^kf(t)]=(-1)^kF^{(k)}(s)$.
% 		\item (延迟性质) $\msl[f(t-t_0)]=e^{-st_0}F(s), t_0\ge 0$.
% 		\item (位移性质) $\msl[e^{s_0t}f(t)]=F(s-s_0)$.
% 	\end{itemize}
% \end{block}

% \begin{alertblock}{微分性质}
% 	\[\msl[f'(t)]=sF(s)-f(0),\]
% 	\[\msl[f''(t)]=s^2F(s)-sf(0)-f'(0).\]
% \end{alertblock}

% 从拉普拉斯变换的微分性质可以看出, 拉普拉斯变换可以将微分方程转化为代数方程, 从而可用于解微分方程.

% \begin{example}
% 	求 $\msl[\sin{kt}]$.
% \end{example}

% \begin{solution}
% 	\begin{align*}
% 		\msl[\sin{kt}]&=\frac{\msl[e^{jkt}]-\msl[e^{-jkt}]}{2j}\\
% 		&{=\frac1{2j}\left(\frac1{s-jk}-\frac1{s+jk}\right)}
% 		{=\emph{\frac k{s^2+k^2}}.}
% 	\end{align*}
% \end{solution}

% \begin{exercise}
% 	$\msl[\cos{kt}]=$\fillblank[3cm][3mm]{{$\dfrac s{s^2+k^2}$}}.
% \end{exercise}

% \begin{example}
% 	求 $\msl[t^me^{kt}]$, 其中 $m$ 是正整数.
% \end{example}

% \begin{solution}
% 	由 $\msl[t^m]=\dfrac{m!}{s^{m+1}}$ 可知
% 	\[\msl[t^me^{kt}]=\frac{m!}{(s-k)^{m+1}}.\]
% \end{solution}

% \begin{alertblock}{常见拉普拉斯变换汇总}
% 	\[\msl[1]=\frac1s,\quad \msl[e^{kt}]=\frac1{s-k},\]
% 	\[\msl[t^m]=\frac{m!}{s^{m+1}},\quad \msl[t^me^{kt}]=\frac{m!}{(s-k)^{m+1}},\]
% 	\[\msl[\sin kt]=\frac{k}{s^2+k^2},\quad
% 	\msl[\cos kt]=\frac{s}{s^2+k^2}.\]
% \end{alertblock}

% \subsection{拉普拉斯逆变换}

% 拉普拉斯逆变换可以由如下定理给出
% \begin{block}{拉普拉斯逆变换定理}
% 	设 $F(s)$ 的所有奇点为 $s_1,\dots,s_k$, 且 $\lim\limits_{z\to\infty}F(z)=0$, 则
% 	\[\msl^{-1}[F(s)]=\sum_{k=1}^n \Res\left[F(s)e^{st},s_k\right].\]
% \end{block}

% 不过我们只要求掌握如何利用常见函数的拉普拉斯变换来计算逆变换.

% \begin{example}
% 	求 $F(s)=\dfrac1{s(s-1)^2}$ 的拉普拉斯逆变换.
% \end{example}

% \begin{solution}
% 		\begin{align*}
% 			\Res[F(s)e^{st},0]&=\frac{e^{st}}{(s-1)^2}\Big|_{s=0}=1,\\
% 			\Res[F(s)e^{st},1]&=\left(\frac{e^{st}}s\right)'\Big|_{s=1}=\frac{te^{st}s-e^{st}}{s^2}\Big|_{s=1}=(t-1)e^t,
% 		\end{align*}{故 $\msl^{-1}[F(s)]=1+(t-1)e^t$.
% 	}
% \end{solution}

% \begin{proofblock}{另解}
% 		设
% 		$\displaystyle F(s)=\frac as+\frac b{s-1}+\frac c{(s-1)^2}$,
% 	{则
% 		\begin{align*}
% 			a&=\Res[F(s),0]=\frac1{(s-1)^2}\Big|_{s=0}=1,\\
% 			b&=\Res[F(s),1]=\left(\frac1s\right)'\Big|_{s=1}=-\frac1{s^2}\Big|_{s=1}=-1,\\
% 			c&=\Res[(s-1)F(s),1]=\frac1s\Big|_{s=1}=1.
% 		\end{align*}故
% 		$\displaystyle\msl^{-1}[F(s)]=\msl^{-1}\left[\frac1s-\frac1{s-1}+\frac1{(s-1)^2}\right]=1+(t-1)e^t$.
% 	}
% \end{proofblock}

% \subsection{卷积定理*}

% 由于在拉普拉斯变换中, 我们考虑的函数在 $t<0$ 时都是零.
% 此时函数的卷积变成了
% \[f_1(t)\ast f_2(t)=\int_0^t f_1(\tau)f_2(t-\tau)\diff \tau,\quad t\ge 0,\]
% 且我们有如下的卷积定理.

% \begin{block}{卷积定理}
% 	\[\msl[f_1(t)\ast f_2(t)]=F_1(s)\cdot F_2(s).\]
% \end{block}

% \subsection{拉普拉斯变换的应用}

% \begin{center}
% 	\begin{tikzpicture}[node distance=40pt]
% 		\node[cstnodeg] (a){微分方程或积分方程};
% 		\node[cstnodeb,right=110pt of a] (b){象函数的代数方程};
% 		\node[cstnodeg,below=of a] (c){原象函数(方程的解)};
% 		\node[cstnodeb,below=of b] (d){象函数};
% 		\draw[cstnarrow,dcolorb] (a)--node[above]{拉普拉斯变换 $\msl$}(b);
% 		\draw[cstnarrow,dcolorb] (d)--node[below]{拉普拉斯逆变换 $\msl^{-1}$}(c);
% 		\draw[cstnarrow,dcolorb] (b)--(d);
% 		\draw[cstnarrow,dcolorc] (a)--(c);
% 	\end{tikzpicture}
% \end{center}

% \begin{example}
% 	(2022年A卷) 解微分方程
% 	\begin{align*}
% 		y''+2y=\sin t,\\
% 		y(0)=0,\quad y'(0)=2.
% 	\end{align*}
% \end{example}
% \begin{solution}
% 	设 $\msl[y]=Y$, 则 $\msl[y'']=s^2Y-sy(0)-y'(0)=s^2Y-2$, 因此
% 		\[s^2Y-2+2Y=\msl[\sin t]=\frac{1}{s^2+1},\]
% 		\[Y(s)=\frac{2}{s^2+2}+\frac{1}{(s^2+1)(s^2+2)}=\frac{1}{s^2+1}+\frac{1}{s^2+2},\]
% 		\[y(t)=\msl^{-1}\left[\frac{1}{s^2+1}\right]+\msl^{-1}\left[\frac{1}{s^2+2}\right]
% 		=\sin t+\frac{\sqrt 2}2\sin(\sqrt 2 t). \]
% \end{solution}

% \begin{example}
% 	解微分方程 $y''(t)-y(t)=0$.
% \end{example}
% \begin{solution}
% 	设 $a=y(0),b=y'(0),\msl[y]=Y$, 则
% 		\[\msl[y'']=s^2Y-as-b,\]
% 		\[s^2Y-as-b-Y=0,\]
% 		\[Y(s)=\frac{as-b}{s^2-1}=\frac{a+b}2\cdot\frac1{s-1}+\frac{a-b}2\cdot\frac1{s+1},\]
% 		\[y(t)=\msl^{-1}[Y(s)]=\frac{a+b}2e^t+\frac{a-b}2e^{-t}.\]
% \end{solution}

\end{document}
